var aColorEvento=["#0d6efd","#198754","#dc3545","#6c757d","#212529"],aRol=["Cliente","Proveedor","Vendedor","Empleado","Acreedor","Deudor","Delegaci√≥n","Almac√©n","Agencia env√≠os","Banco","Adm√≥n. P√∫blica","Otro"],aTipoInteraccion=["Llamada Telef√≥nica","Correo Electr√≥nico","Reuni√≥n Presencial","Videollamada","Mensaje de Texto","Mensajer√≠a Instant√°nea","Presentaci√≥n de Producto / Servicio","Demo o Prueba de Producto","Capacitaci√≥n o Formaci√≥n","Propuesta Enviada","Confirmaci√≥n de Pedido","Entrega de Producto / Servicio","Reuni√≥n de Seguimiento","Revisi√≥n de Progreso","Encuesta de Satisfacci√≥n","Asistencia T√©cnica","Resoluci√≥n de Incidencias","Renovaci√≥n de Contrato o Servicio","Actualizaci√≥n de Condiciones","Ajuste de Propuesta","Cierre de Venta","Cancelaci√≥n / Terminaci√≥n de Servicio","Env√≠o de Documentaci√≥n","Invitaci√≥n a Evento/Webinar","Invitaci√≥n a Evento/Webinar","Notificaci√≥n de Cobro / Facturaci√≥n","Reuni√≥n Interna de Estrategia (Equipo)","Otro"],aEtapaInteraccion=["Prospecto Inicial","Calificaci√≥n de Lead","Contacto Realizado","Reuni√≥n Inicial","Identificaci√≥n de Necesidades","Presentaci√≥n de Producto / Servicio","Envio de Propuesta","Negociaci√≥n","T√©rminos Acordados","Cierre Pendiente de Aprobaci√≥n","Cierre de Venta","Implementaci√≥n","Seguimiento Postventa","Renovaci√≥n / Recompra","Oportunidad Perdida","Prospecto Inactivo","Otro"],aResultadoInteraccion=["Exitosa","Sin Respuesta","Interesado","No Interesado","Seguimiento Programado","Propuesta Enviada","Aprobaci√≥n Pendiente","Condiciones Negociadas","Cierre Exitoso","Oportunidad Perdida","Pendiente de Acci√≥n del Cliente","Feedback Recibido","Otro"],aAccionInteraccion=["Enviar Correo de Seguimiento","Llamar para Recordatorio","Enviar Propuesta","Programar Reuni√≥n","Confirmar Asistencia","Enviar Documentaci√≥n Adicional","Actualizar Propuesta","Revisar Necesidades del Cliente","Negociar Nuevas Condiciones","Solicitar Feedback","Cerrar Venta","Otro"],tabContactosCampos=["cod","per","alt","dom","cpo","pob","pro","pai","te1","te2","cor","www","nif","car","dep","rol","ani","nom","sec","dun","eg1","eg2","eg3","eti","lin","tel","ins","mes","xxx","rf1","rf2","rf3","rf4","fin","ffi","pr1","pr2","pr3","pr4","pr5","pr6","noa"],tabContactosTitCol_es_ES=["C√≥digo","Nombre","Alta","Direcci√≥n","C. P.","Poblaci√≥n","Provincia","Pa√≠s","Tel√©fono 1","Tel√©fono 2","E-mail","Web","NIF","Cargo","Departamento","Rol","Aniversario","Empresa","Sector","DUNS","Grupo 1","Grupo 2","Grupo 3","Etiquetas","LinkedIn","Telegram","Instagram","Messenger","X","Referencia 1","Referencia 2","Referencia 3","Referencia 4","Inicio","Fin","Preferencias 1","Preferencias 2","Preferencias 3","Preferencias 4","Preferencias 5","Preferencias 6","Notas"],tabDocumentosCampos=["fec","nom","com"],tabDocumentosTitCol_es_ES=["Fecha","Nombre fichero","Descripci√≥n"],tabParticipantesCampos=["cod","per","nom","nif","dom","cpo","pob","pro","pai","te1","te2","cor","www","car","dep","rol"],tabParticipantesTitCol_es_ES=["C√≥digo","Nombre","Empresa","NIF","Direcci√≥n","C. P.","Poblaci√≥n","Provincia","Pa√≠s","Tel√©fono 1","Tel√©fono 2","E-mail","Web","Cargo","Departamento","Rol"],tabInteraccionesCampos=["fhii","tipi","asui","desi","ncli","etai","resi","peni","reci"],tabInteraccionesTitCol_es_ES=["Fecha/hora","Tipo","Asunto","Descripci√≥n","Notas cliente","Etapa","Resultado","Pendiente","Recordatorio"],tabRecordatoriosCampos=["recr","penr","codr","perr","nomr","fhir","tipr","asur","desr","nclr","etar","resr"],tabRecordatoriosTitCol_es_ES=["Recordatorio","Pendiente","C√≥digo","Nombre","Empresa","Fecha/hora","Tipo","Asunto","Descripci√≥n","Notas cliente","Etapa","Resultado"],exp_es_ES=["Imprimir tabla","Exportar tabla","Exportar a:","Mostrar columnas","Gesti√≥n documental","Importar","Tabla","Tarjeta/Tabla","Imprimir","Exportar a","Tarjeta","Buscar en la tabla","Vista de tarjeta","Cerrar","Direcci√≥n","C√≥digo postal","Poblaci√≥n","Provincia","Pa√≠s","Tel√©fono 1","Tel√©fono 2","Correo electr√≥nico","Direcci√≥n web","Nombre empresa","NIF","Cargo","Departamento","Notas","Guardar","Cancelar","Enviar","Contrase√±a","He olvidado mi contrase√±a","Aceptar","Abrir","Cancelar","¬øEres nuevo?","Es GRATIS y sencillo","Quiero registrarme","Escribe tu consulta","Recomendar a un amigo","Pol√≠tica de Privacidad","Condiciones de Uso","Correo electr√≥nico no v√°lido","Correo electr√≥nico desconocido","Contrase√±a no v√°lida","¬øQuieres registrarte?","Registro","Versi√≥n","Recibir√°s la contrase√±a en tu correo para acceder a My Contacts Cloud","He le√≠do y acepto la","Registrarme","La direcci√≥n de correo no coincide","Debes aceptar la Pol√≠tica de Privacidad","Tu nombre","Escribe de nuevo el correo","Men√∫","Eventos","Utilidades","Cambiar contrase√±a","Planes PRO","Suscripci√≥n","Enviar consulta","Cancelar cambios","Cerrar ventana","Asunto","Contenido","Consulta","Consulta enviada","contactos","eventos","documentos","GRATIS","Gratis","gratis","mes","Mensual","comprar","IVA incluido","Buscar","Columnas a mostrar","Guardar cambios","Contrase√±a actual","Nueva contrase√±a","Repita contrase√±a","Ocho caracteres como m√≠nimo","Un n√∫mero al menos","Una letra min√∫scula al menos","Una letra may√∫scula al menos","La contrase√±a no coincide","La longitud de la contrase√±a debe ser de ocho caracteres como m√≠nimo","La contrase√±a debe contener al menos un n√∫mero","La contrase√±a debe contener al menos una letra min√∫scula","La contrase√±a debe contener al menos una letra may√∫scula","Contrase√±a cambiada","La contrase√±a anterior no es correcta","Muchas gracias por tu compra","Recibir√°s un correo para acceder a la factura y recibo","Continuar","S√≠","No","Error al conectar con la base de datos","Fallo al preparar la declaraci√≥n SQL","Fallo al ejecutar la consulta SQL","Uno de estos caracteres especiales al menos !@#$%_-+=?","La contrase√±a debe contener al menos uno de estos caracteres especiales !@#$%_-+=?","Esta direcci√≥n de correo electr√≥nico ya estaba dada de alta anteriormente","Nuevo contacto","Editar contacto","Eliminar contacto","Ver contacto","Contactos","Rol del contacto","C√≥digo","Nombre","Empresa","NIF","Direcci√≥n","C. P.","Poblaci√≥n","Provincia","Pa√≠s","Telef√≥no 1","Telef√≥no 2","E-mail","Web","Cargo","Departamento","Rol","Alta","Cliente","Proveedor","Vendedor","Empleado","Acreedor","Deudor","Delegaci√≥n","Almac√©n","Agencia env√≠os","Banco","Adm√≥n. P√∫blica","Otro","C√≥digo del contacto. M√°ximo 15 caracteres. Si lo deja en blanco, My Contacts lo rellenar√° autom√°ticamente","Nombre persona","Nombre de la persona de contacto. M√°ximo 60 caracteres","Fecha de alta del contacto","Abrir Google Maps","Llamar","Enviar un mensaje","Visitar web","NIF del contacto","Nombre de empresa","Contacto","Nuevo documento","Editar documento","Eliminar documento","Ver documento","Gesti√≥n documental","Fecha","Fecha del documento","Examinar...","Nombre del fichero","Descripci√≥n","Descripci√≥n del documento","El tama√±o del fichero no debe superar los","Te recomendamos adquirir un plan PRO para poder a√±adir m√°s documentos","Te recomendamos cambiar a un plan PRO superior para poder a√±adir m√°s documentos","Documento","Importar","Nombre del fichero Excel","Primera fila contiene encabezados","letra de la columna del campo 'C√≥digo'","letra de la columna del campo 'Nombre'","letra de la columna del campo 'Direcci√≥n'","letra de la columna del campo 'C. P.'","letra de la columna del campo 'Poblaci√≥n'","letra de la columna del campo 'Provincia'","letra de la columna del campo 'Pa√≠s'","letra de la columna del campo 'Tel√©fono 1'","letra de la columna del campo 'Tel√©fono 2'","letra de la columna del campo 'Correo electr√≥nico'","letra de la columna del campo 'Direcci√≥n web'","letra de la columna del campo 'Empresa'","letra de la columna del campo 'NIF'","letra de la columna del campo 'Cargo'","letra de la columna del campo 'Departamento'","letra de la columna del campo 'Notas'","Te recomendamos adquirir un plan PRO para poder a√±adir m√°s contactos","Te recomendamos cambiar a un plan PRO superior para poder a√±adir m√°s contactos","No se import√≥ nada","Se import√≥ un registro","registros importados","Evento","Todo el d√≠a","Inicio","Fin","Color","T√≠tulo","Descripci√≥n (opcional)","Lugar","Lugar (opcional)","Direcci√≥n web","Direcci√≥n web (opcional)","Visitar web","App reuni√≥n online","Ninguna app","Id. reuni√≥n","Id. de reuni√≥n (opcional)","Unirme a la reuni√≥n","C√≥digo de acceso","C√≥digo de acceso a la reuni√≥n (opcional)","Adjuntar ficheros","Eliminar evento","C√≥digo o enlace de la reuni√≥n","C√≥digo de acceso a la reuni√≥n","ID de reuni√≥n o nombre de enlace personal","Nuevo participante","Eliminar participante","Participantes","Fecha/hora de inicio del evento","Fecha/hora del fin del evento","Nuevo evento","Te recomendamos adquirir un plan PRO para poder a√±adir m√°s eventos","Te recomendamos cambiar a un plan PRO superior para poder a√±adir m√°s eventos","¬øEliminar evento?","Muchas gracias por registrarte","Recibir√°s un correo de bienvenida con la contrase√±a para abrir la App","Si tu cuenta es gmail, es posible que lo recibas en","Promociones","Si no encuentras el correo, revisa la","carpeta Spam","Recomendar","Tu amigo recibir√° un correo con un enlace para visitar la web de My Contacts Cloud y suscribirse en caso de interesarle","Muchas gracias<br><br>Si la cuenta de tu amigo es gmail, es posible que lo reciba en Promociones","Eliminar","Zona horaria","Fines de semana","Cambiar idioma","9,95 ‚Ç¨","19,95 ‚Ç¨","29,95 ‚Ç¨","49,95 ‚Ç¨","99,95 ‚Ç¨","C√≥digo duplicado","Selecciona una fila","A√±ade primero una fila","Contacto recientemente eliminado","Contacto asignado a uno o varios eventos","¬øEliminar contacto?","¬øEliminar documento?","Pulsa sobre el bot√≥n de Examinar para seleccionar el fichero","Selecciona un s√≥lo fichero","La primera columna de datos debe ser la columna A","El campo 'Nombre' es obligatorio","¬øRecibir nueva contrase√±a por correo electr√≥nico?","Nueva contrase√±a enviada. Si se trata de una cuenta Gmail, posiblemente est√© en Promociones. Revisa la carpeta Spam si no encuentra el mensaje.","Doble clic para seleccionar el contacto","Introduce la contrase√±a del correo que acabas de recibir. Podr√°s cambiarla despu√©s en el men√∫ Utilidades, Cambiar contrase√±a.","Desuscribirme","Recibir√°s un correo con un enlace para que confirmes la desuscripci√≥n","Al desuscribirte...","Se eliminar√° la base de datos que contiene los datos introducidos en la app","No recibir√°s m√°s mensajes de nuestra newsletter","Te daremos de baja en el registro de usuarios de la app","Pantalla completa","¬øSalir de My Contacts Cloud?","Gira la pantalla","Inicio de sesi√≥n","--- o ---","Iniciar sesi√≥n en Microsoft","Nuevo correo electr√≥nico","Recibir√°s un mensaje para verificar que esta direcci√≥n de correo electr√≥nico es tuya","Mensaje enviado","Abre el mensaje y haz un clic sobre el enlace 'S√≠, soy yo'","¬°Vota por nuestra app!","Cerrar sesi√≥n","Soy nuevo","Introduce arriba tu direcci√≥n de correo electr√≥nico o, si lo prefieres, inicia sesi√≥n con tu cuenta de Google, Microsoft o Apple","Planificador","Eventos Reuniones Tareas","D√≠a","Semana","Mes","Agenda","No se ha podido previsualizar el fichero","Configurar contactos","Configurar eventos","Aniversario","Sector","Sector de la empresa","N√∫mero DUNS","Iniciar conversaci√≥n","Nombre de usuario","ID usuario","Hallar ID n√∫merico del usuario","Referencias","En 'Utilidades', 'Configurar contactos' podr√°s definir los nombres de las referencias","Fecha de inicio","Fecha final","Preferencias","En 'Utilidades', 'Configurar contactos' podr√°s definir los t√≠tulos de las preferencias","Define los nombres de las referencias para la ficha del contacto. Ejemplos: Referencia, contrato, p√≥liza, proyecto, obra, veh√≠culo, matr√≠cula,...","Nombre referencia","Define los t√≠tulos de las preferencias del contacto. Ejemplos: Productos y servicios, necesidades especiales, env√≠os, tipo de comunicaciones, marketing, atenci√≥n al cliente, formas de pago,...","T√≠tulo preferencia","Hora de inicio","Hora final","Int√©rvalo de tiempo","cada 10 minutos","cada 15 minutos","cada 20 minutos","cada media hora","cada hora","cada 2 horas","Confirmar","La fecha final debe ser posterior a la inicial","El d√≠a debe ser distinto","A√±ade un evento, reuni√≥n o tarea con el bot√≥n del signo + que est√° arriba. Tambi√©n puedes a√±adirlo haciendo un clic o manteniendo presionado el dedo durante un segundo.","En la vista del mes, si haces clic o presionas el n√∫mero del d√≠a, acceder√°s a la vista diaria.","Arrastra y suelta un evento con el rat√≥n o presionando previamente el dedo durante un segundo. Adem√°s de moverlo, podr√°s cambiar su tama√±o.","Ver planes","Mi suscripci√≥n","No te conformes con lo b√°sico, salta al siguiente nivel con los planes PRO","Podr√°s cambiar de plan a uno superior o inferior en cualquier momento de acuerdo a tus necesidades","Podr√°s cancelar tu plan en cualquier momento","Recibir√°s un correo electr√≥nico con la factura de compra y el recibo del pago","Haz una prueba r√°pida tecleando nombre, poblaci√≥n, tel√©fono y correo electr√≥nico. Despu√©s de guardarlo, haz clic sobre el bot√≥n ","Documentos con ","Eventos con ","Recomendamos el inicio de sesi√≥n con una cuenta de Google, Microsoft o Apple por su rapidez y comodidad. Tambi√©n garantiza una recepci√≥n m√°s segura de los mensajes de correo.","Precios con impuestos excluidos","valor al mes con la suscripci√≥n anual","(dos meses gratis)","Anual","m√°s popular","Contactos de Google","Contactos de Microsoft","Desde fichero Excel","Grupos de contactos","Editar grupo","Autorizar","Nuevo elemento","El n√∫mero m√°ximo de elementos por grupo es 100","Elemento asignado a uno o m√°s contactos","No se puede eliminar el elemento predeterminado","¬øEliminar elemento?","Grupos","En 'Utilidades', 'Grupos de contactos' podr√°s definir los nombres de los grupos y las opciones de cada grupo para la segmentaci√≥n de contactos","Nombre del grupo","Nombre del elemento","¬øImportar los contactos seleccionados?","Importar desde Excel","Filtrar por grupos y etiquetas","Filtrar","Quitar filtro","Etiquetas de contactos","Escribe una etiqueta","Selecciona el color","A√±adir etiqueta","Etiqueta asignada a uno o m√°s contactos","En 'Utilidades', 'Etiquetas de contactos' podr√°s definir las etiquetas para la segmentaci√≥n de contactos","Grupos y Etiquetas","Etiquetas","Seleccionar Etiquetas","M√°ximo de 3 etiquetas seleccionadas","Interacciones","interacciones","Interacciones con","Nueva interacci√≥n","Editar interacci√≥n","Eliminar interacci√≥n","Ver interacci√≥n","Fecha/hora","Fecha/hora de la interacci√≥n","Tipo","Tipo de interacci√≥n","Notas cliente","Etapa","Etapa del proceso de venta","Resultado","Resultado de la interacci√≥n","Acci√≥n Pendiente","Recordatorio","Recordatorio de la Acci√≥n Pendiente","Llamada Telef√≥nica","Correo Electr√≥nico","Reuni√≥n Presencial","Videollamada","Mensaje de Texto","Mensajer√≠a Instant√°nea","Presentaci√≥n de Producto / Servicio","Demo o Prueba de Producto","Capacitaci√≥n o Formaci√≥n","Propuesta Enviada","Confirmaci√≥n de Pedido","Entrega de Producto / Servicio","Reuni√≥n de Seguimiento","Revisi√≥n de Progreso","Encuesta de Satisfacci√≥n","Asistencia T√©cnica","Resoluci√≥n de Incidencias","Renovaci√≥n de Contrato o Servicio","Actualizaci√≥n de Condiciones","Ajuste de Propuesta","Cierre de Venta","Cancelaci√≥n / Terminaci√≥n de Servicio","Env√≠o de Documentaci√≥n","Invitaci√≥n a Evento/Webinar","Notificaci√≥n de Cobro / Facturaci√≥n","Reuni√≥n Interna de Estrategia (Equipo)","Prospecto Inicial","Calificaci√≥n de Lead","Contacto Realizado","Reuni√≥n Inicial","Identificaci√≥n de Necesidades","Envio de Propuesta","Negociaci√≥n","T√©rminos Acordados","Cierre Pendiente de Aprobaci√≥n","Implementaci√≥n","Seguimiento Postventa","Renovaci√≥n / Recompra","Oportunidad Perdida","Prospecto Inactivo","Exitosa","Sin Respuesta","Interesado","No Interesado","Seguimiento Programado","Aprobaci√≥n Pendiente","Condiciones Negociadas","Cierre Exitoso","Pendiente de Acci√≥n del Cliente","Feedback Recibido","Enviar Correo de Seguimiento","Llamar para Recordatorio","Enviar Propuesta","Programar Reuni√≥n","Confirmar Asistencia","Enviar Documentaci√≥n Adicional","Actualizar Propuesta","Revisar Necesidades del Cliente","Negociar Nuevas Condiciones","Solicitar Feedback","Cerrar Venta","Interacci√≥n","¬øEliminar Interacci√≥n?","Recordatorios","A√±ade una interacci√≥n en Contactos","Pantalla normal","Contactos de Apple","Leer contactos desde iCloud","Sigue estos pasos para importar tus contactos:","Ir a "," e iniciar sesi√≥n.","En la secci√≥n ","Inicio de sesi√≥n y seguridad",", selecciona ","Contrase√±as de aplicaciones","Haz clic en ","Generar una contrase√±a de aplicaci√≥n"," e introduce ","Importar contactos"," como nombre.","Apple generar√° una contrase√±a con el formato ","Copia la contrase√±a y p√©gala abajo para continuar:","Correo electr√≥nico del ID de Apple:","Contrase√±a de aplicaci√≥n:"," Leer contactos","ID de Apple o contrase√±a incorrecta","Teclea el nombre del documento","Error al crear el documento en OneDrive","Error al crear el documento en Collabora","Error al abrir el documento en Collabora","Ya existe un documento con ese nombre","Hubo un problema al comunicarse con el servidor","Selecciona un documento","O crea un nuevo documento...","¬°V√≥tanos!","App de correo","Dispositivo","Selecciona tipo","ID cuenta: ","Dise√±o","Marketing","No se pudo iniciar sesi√≥n con Microsoft","No se pudo autenticar con Microsoft","No se pudo obtener el token de acceso","üìã Direcci√≥n copiada al portapapeles: ","Extensi√≥n no soportada","No se pudo obtener acceso a los contactos de Microsoft"],sMask1ant=null,textoEnVezDeIcono=!1,volverAtras=!1,modalColTabla=null,myModalMenu=null,myModalConfContactos=null,myModalConfEventos=null,myModalIdioma=null,myModalContrasena=null,myModalImportarExcel=null,myModalPoliticaPrivacidad=null,mymodalCondicionesUso=null,mymodalConsulta=null,mymodalDesuscripcion=null,indiceFilaTab=-1,refrescoTabContactos=-1,iPosTabContactos=0,nombrePersonaContacto="",vistaAntTabContactos="",indiceFilaTabDocumentos=-1,refrescoTabDocumentos=-1,iPosTabDocumentos=0,vistaAntTabDocumentos="",indiceFilaTabParticipantes=-1,refrescoTabParticipantes=-1,iPosTabParticipantes=0,vistaAntTabParticipantes="",indiceFilaTabInteracciones=-1,refrescoTabInteracciones=-1,iPosTabInteracciones=0,vistaAntTabInteracciones="",indiceFilaTabRecordatorios=-1,refrescoTabRecordatorios=-1,iPosTabRecordatorios=0,vistaAntTabRecordatorios="",salidaModalEvento=0,salirModalContacto=!1,salirModalDocumento=!1,salirModalEvento=!1,salirModalInteraccion=!1,salirFormEventoSubmit=!1,comunicacionesContacto=null,calendar=null,ventanaSobre=null,ventanaComContactos=null,aColorFondoEvento=["#0d6efd","#198754","#dc3545","#ffc107","#212529"],sEvents="",dataGruposContactos=null,primeraVezModalGruposContactos=!1,sumEleGrupo1=0,sumEleGrupo2=0,sumEleGrupo3=0,dataEtiquetas=null,etiSeleccionadasContacto=[],etiSeleccionadasFiltro=[],etiSeleccionadasTmp=[],maxTags=3,abrirModalTagsDesde="",salidaTagModal=!1,et1Cancelar=0,et2Cancelar=0,et3Cancelar=0,selectedColorTag="#0d6efd",editingTagIndex=null,editingTagId=null,MAX_TAGS_CREACION=100,docEditado=0,nomDocEditadoCompleto="",OneDriveFileId="",OneDriveEditUrl="",windowObjectReference1=null;const colorMapTag={1:"#0d6efd",2:"#198754",3:"#dc3545",4:"#ffc107",5:"#212529"};var libIdioCargado="",salidaTelefonos=!1,cambioPantalla=!1,libsCargadas=!1,libCss=[{url:"https://cdn.jsdelivr.net/npm/bootstrap-table@1.24.0/dist/bootstrap-table.min.css",integrity:"sha256-3V00yGRv9dbwr5nN+Vc8LrakTM3FTTU+qwp+Q8zglSw=",crossorigin:"anonymous"},{url:"https://cdn.jsdelivr.net/npm/summernote@0.9.1/dist/summernote-lite.min.css",integrity:"sha256-3iZSiBLGKwzUj9d2oikFrL596M8C6ZPahULF5F4xABA=",crossorigin:"anonymous"},{url:"https://cdn.jsdelivr.net/npm/slim-select@2.11.0/dist/slimselect.min.css",integrity:"",crossorigin:"anonymous"}],libJs=[{url:"https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js",integrity:"sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=",crossorigin:"anonymous"},{url:"https://cdn.jsdelivr.net/npm/bootstrap-table@1.24.0/dist/bootstrap-table.min.js",integrity:"sha256-8FO9YknRRlszlyJKmNdv3/bIYXQZOjADPv5LVUpdhwI=",crossorigin:"anonymous"},{url:"https://cdn.jsdelivr.net/npm/summernote@0.9.1/dist/summernote-lite.min.js",integrity:"sha256-WE15Fp77erC5GsqgCzToOqov7byvkSpItz2kqUfJekc=",crossorigin:"anonymous"},{url:"https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js",integrity:"sha256-ZztCtsADLKbUFK/X6nOYnJr0eelmV2X3dhLDB/JK6fM=",crossorigin:"anonymous"},{url:"https://cdn.jsdelivr.net/npm/jspdf@2.5.2/dist/jspdf.umd.min.js",integrity:"sha256-hbosw/+FiiD6Sf5uRXvshj6kC1Wp83JeWKlA5i9vYaQ=",crossorigin:"anonymous"}],libResto=[{url:"https://cdn.jsdelivr.net/npm/bootstrap-table@1.24.0/dist/bootstrap-table-locale-all.min.js",integrity:"sha256-vdLrfdxDnGXDZE+GcmfTr4bxMeWHv8sqXclhMTO3fio=",crossorigin:"anonymous"},{url:"https://cdn.jsdelivr.net/npm/summernote@0.9.1/dist/lang/summernote-en-US.min.js",integrity:"sha256-T92iLmPhDObDSHLwM/Y6sGzEbdHFB3mK4PekV1eQg8w=",crossorigin:"anonymous"},{url:"https://cdn.jsdelivr.net/npm/@fullcalendar/core@6.1.15/locales-all.global.min.js",integrity:"sha256-lzem0W8FCaLegnCNhEQnF4bMnpq9Du4IiUDonSOXCA8=",crossorigin:"anonymous"},{url:"https://cdn.jsdelivr.net/npm/@fullcalendar/bootstrap5@6.1.15/index.global.min.js",integrity:"sha256-TslkUnYKZuqQj4Ueu1WQesikFvl2DADWslCx3EfBHZM=",crossorigin:"anonymous"},{url:"https://cdn.jsdelivr.net/npm/jspdf-autotable@3.8.4/dist/jspdf.plugin.autotable.min.js",integrity:"sha256-IiODDPmh7IWvAUzHGzfBsetWbz0YsquAcelq+CLFi9s=",crossorigin:"anonymous"},{url:"https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js",integrity:"sha256-yVBhl8r4CaB1tt7h2g02+xnacVj/6KiOewyWxdhiPJk=",crossorigin:"anonymous"},{url:"https://cdn.jsdelivr.net/npm/slim-select@2.11.0/dist/slimselect.umd.min.js",integrity:"sha256-pqs2C+hu+mL0hLImVMl7ldfMfLO0naLn3NPc8lNEPHM=",crossorigin:"anonymous"}];async function opPrincipal(e){switch(e){case 0:break;case 1:cambioDiv("menu","contactos",0,0);break;case 2:cambioDiv("menu","importargoogle",0,0);break;case 3:cambioDiv("menu","importarms",0,0);break;case 4:localStorage.setItem("tipoFicheroImportacion",85),cambioDiv("menu","importarexcel",0,0);break;case 5:cambioDiv("menu","gruposcontactos",0,0);break;case 6:cambioDiv("menu","confcontactos",0,0);break;case 7:cambioDiv("menu","confeventos",0,0);break;case 8:cambioDiv("menu","cambiaridioma",0,0);break;case 9:cambioDiv("menu","cambiarcontrasena",0,0);break;case 10:abrirVentanaUnica("planes.html");break;case 11:abrirPortalStripe();break;case 12:redirigirAvotacion();break;case 13:iniFullalendar("timeGridDay");break;case 14:iniFullalendar("timeGridWeek");break;case 15:iniFullalendar("dayGridMonth");break;case 16:iniFullalendar("listWeek");break;case 17:cambioDiv("menu","etiquetascontactos",0,0);break;case 18:cambioDiv("menu","recordatorios",0,0);break;case 19:cambioDiv("menu","politicaprivacidad",0,0);break;case 20:cambioDiv("menu","condicionesuso",0,0);break;case 21:cambioDiv("menu","consulta",0,0);break;case 22:cambioDiv("menu","desuscribirse",0,0);break;case 23:cambioDiv("menu","importarapple",0,0);break;default:console.log("Opci√≥n no v√°lida")}}function abrirSuscripcion(e){if("admin"==localStorage.getItem("nomUs")||localStorage.getItem("esAdministrador")){let t=new FormData;t.append("tipoOperacion",e),async function(){const e=await fetch("https://"+window.location.host+"/stripePortal",{method:"POST",body:t});return await e.json()}().then((t=>{if("N/D"==t){if(1==e)var a="En cualquier momento podr√° efectuar la cancelaci√≥n de su plan, seleccionar otro tipo de plan o cambiar la periodicidad de pago de su plan actual";else a="Cuando adquiera el primer plan, se renueve el plan actual o cambie a otro plan, recibir√° un correo electr√≥nico con la factura y el recibo de pago. En esta ventana podr√° modificar los datos de facturaci√≥n de su empresa as√≠ como los datos de contacto";modal1("My Contacts Cloud","Opci√≥n s√≥lo disponible despu√©s de adquirir un plan<br><br>"+a,myTextDataList)}else window.open(t,"_blank")})).catch((e=>{alert(e.message)}))}return!1}function regTabla(e,t,a){if(2==a||4==a){if("modalContacto"==e&&filaNoSeleccionada("tabContactos","success",msjModContacto))return!1;if("modalDocumento"==e&&filaNoSeleccionada("tabDocumentos","success1",msjModDocumento))return!1;if("modalInteraccion"==e&&filaNoSeleccionada("tabInteracciones","success3",msjModInteraccion))return!1}window[t]=a,new bootstrap.Modal(document.getElementById(e)).show()}function buscarAhora(e,t){return $("#"+e).bootstrapTable("resetSearch",document.getElementById(t).value),!1}function valorTarjeta(e){return $("#"+e).bootstrapTable("toggleView"),!1}function seleccionarCombo(e,t){var a=document.getElementsByName(e)[0];if(a)for(var o=0;o<a.length;o++)a[o].value==t?a[o].defaultSelected=!0:a[o].defaultSelected=!1;return!1}function seleccionarRadio(e,t){var a=document.getElementsByName(e);if(a)for(var o=0;o<a.length;o++)a[o].value==t?a[o].defaultChecked=!0:a[o].defaultChecked=!1;return!1}function dValorRadio(e){var t=document.getElementsByName(e);if(t)for(var a=0;a<t.length;a++)if(t[a].checked)return t[a].value}function desactivarRadio(e,t){var a=document.getElementsByName(e);if(a)for(var o=0;o<a.length;o++)a[o].disabled=t}function valorEnlace(e,t){let a=e.length,o="";if(1==t||2==t)var n="1234567890+";else n="1234567890";for(x=0;x<=a;x++){var s=e.substr(x,1);-1!=n.indexOf(s)&&(o+=s)}switch(0==o.length&&(o="0"),t){case 1:case 2:return o;case 3:return parseFloat(o)}}function mostrarColumnas(e,t){window.numTablaMostrarColumnas=t,new bootstrap.Modal(document.getElementById(e)).show()}function valorCasilla(e,t){return 1==e.checked?$(t).bootstrapTable("showColumn",e.value):$(t).bootstrapTable("hideColumn",e.value),!1}function cambiarAltoTabla(e,t){var a=document.documentElement.clientHeight,o=0;"tabContactos"===e&&(o=$("#filaContactos").height()),"tabImportGoogle"===e&&(o=$("#filaGoogle").height()),"tabImportMs"===e&&(o=$("#filaMs").height()),"tabImportApple"===e&&(o=$("#filaApple").height()),"tabDocumentos"===e&&(o=$("#filaDocumentos").height()),"tabInteracciones"===e&&(o=$("#filaInteracciones").height()),"tabRecordatorios"===e&&(o=$("#filaRecordatorios").height());var n=a-o-t;return $("#"+e).bootstrapTable("resetView",{height:n}),!1}function formatoFechaHora(e){return e.substring(8,10)+"-"+e.substring(5,7)+"-"+e.substring(0,4)+" "+e.substring(11,13)+":"+e.substring(14,16)}function sustituirT(e){for(var t=e.length,a="",o=0;o<=t;o++){var n=e.substr(o,1);"T"==n&&(n=" "),a+=n}return a}function selPrimeraFila(e,t){if(Object.keys($("#"+e).bootstrapTable("getData")).length>0){var a=document.getElementById(e),o=a.querySelector(`.${t}`);o&&o.classList.remove(t);var n=a.querySelector("tbody tr:first-child");n&&n.classList.add(t)}}function seleccionarFila(e,t,a,o){var n=Object.keys($("#"+e).bootstrapTable("getData")).length,s=0;if(0!=n){if(Array.from(document.querySelectorAll("tr."+o)).forEach((e=>{e.classList.remove(o)})),""==window[t])document.getElementById(e).rows[1].classList.add(o),window[t]=$("#"+e).bootstrapTable("getData")[0][a],s=1;else for(i=0;i<n;i++)if($("#"+e).bootstrapTable("getData")[i][a]==window[t]){s=i,document.getElementById(e).rows[i+1].classList.add(o);break}}else s=-1,window[t]="",$("."+o).removeClass(o);return s}function filaNoSeleccionada(e,t,a){let o=Object.keys($("#"+e).bootstrapTable("getData")).length,n=!0;if(0!=o){for(i=0;i<o;i++){if(null!=document.getElementById(e).rows[i+1]&&document.getElementById(e).rows[i+1].classList.contains(t)){n=!1;break}}n&&(volverAtras=!0,toastSelFila(tExp("Selecciona una fila",""),a))}else volverAtras=!0,toastSelFila(tExp("A√±ade primero una fila",""),a);return n}function acReg(e,t,a,o){var n=Object.keys($("#"+e).bootstrapTable("getData")).length,s=null,c=null,r=Array.from(document.querySelectorAll("tr."+t));return 0==r.length?toastSelFila(tExp(0!=n?"Selecciona una fila":"A√±ade primero una fila",""),o):r.forEach((t=>{s=Array.from(t.parentElement.querySelectorAll("tr")).indexOf(t),c=$("#"+e).bootstrapTable("getData")[s][a]})),[n,s,c]}function eliReg(e,t,a,o){const[n,s,c]=acReg(e,t,a,o);null!=s&&($("#"+e).bootstrapTable("removeByUniqueId",c),n-1==s?n>1&&document.getElementById(e).rows[s].classList.add(t):document.getElementById(e).rows[s+1].classList.add(t))}function eliminarReg(e,t,a,o){var n=Object.keys($("#"+e).bootstrapTable("getData")).length,s=obtenerIndicePorId(e,a,window[t]),c=-1;if(-1!=(c=s+1==n?1==n?-1:s-1:s+1))var r=$("#"+e).bootstrapTable("getData")[c][a];return $("#"+e).bootstrapTable("removeByUniqueId",window[t]),setTimeout((function(){if(-1==c)return window[t]="",!1;var n=obtenerIndicePorId(e,a,r);window[t]=r,irAPaginaConRegistro(e,n,o,t,r)}),500),!1}function indice(e,t,a){var o=-1;return $("#"+a).bootstrapTable("getData").filter((function(a,n){a[t]===e&&(o=n)})),o}function formatoSepMilesSinDec(e){return parseInt(e).toLocaleString()}function formatoFecha(e){if(!e)return"";const t={"DD-MM-YYYY":["CL","ES","AR","UY","BO","PY","VE","PE","EC","CO","MX","CR","GT","HN","NI","PA","SV","BR","PT","IT","FR","DE","GR","TR","CZ","SK","PL"],"MM/DD/YYYY":["US","CA","PH","IL","SA","EG","QA","KW","AE","JO","LB"],"YYYY/MM/DD":["CN","JP","KR","TW"],"DD.MM.YYYY":["RU","DE","AT","CH"]},a=(localStorage.getItem("idiomaPais")||"default").split("-").pop().toUpperCase();switch(Object.keys(t).find((e=>t[e].includes(a)))||"DD/MM/YYYY"){case"DD-MM-YYYY":return e.substring(8,10)+"-"+e.substring(5,7)+"-"+e.substring(0,4);case"MM/DD/YYYY":return e.substring(5,7)+"/"+e.substring(8,10)+"/"+e.substring(0,4);case"YYYY/MM/DD":return e.substring(0,4)+"/"+e.substring(5,7)+"/"+e.substring(8,10);case"DD.MM.YYYY":return e.substring(8,10)+"."+e.substring(5,7)+"."+e.substring(0,4);default:return e.substring(8,10)+"/"+e.substring(5,7)+"/"+e.substring(0,4)}}function formatoFechaHoraInternacional(e){if(""==e)return"";var t=(localStorage.getItem("idiomaPais")||"default").split("-").pop().toUpperCase(),a=e.substring(0,4),o=e.substring(5,7),n=e.substring(8,10),s=parseInt(e.substring(11,13),10),c=e.substring(14,16),r=["US","CA","PH","IL","SA","EG","QA","KW","AE","JO","LB"].includes(t),i="";r&&(i=s>=12?"PM":"AM",s=s%12||12);var l=s.toString().padStart(2,"0")+":"+c+(r?" "+i:"");switch(t){case"CL":case"ES":case"AR":case"UY":case"BO":case"PY":case"VE":case"PE":case"EC":case"CO":case"MX":case"CR":case"GT":case"HN":case"NI":case"PA":case"SV":case"BR":case"PT":case"IT":case"FR":case"DE":case"GR":case"TR":case"CZ":case"SK":case"PL":return n+"-"+o+"-"+a+" "+l;case"US":case"CA":case"PH":case"IL":case"SA":case"EG":case"QA":case"KW":case"AE":case"JO":case"LB":return o+"/"+n+"/"+a+" "+l;case"CN":case"JP":case"KR":case"TW":return a+"/"+o+"/"+n+" "+l;case"RU":case"DE":case"AT":case"CH":return n+"."+o+"."+a+" "+l;default:return n+"/"+o+"/"+a+" "+l}}function primerDiaSemana(){switch((localStorage.getItem("idiomaPais")||"default").split("-").pop().toUpperCase()){case"US":case"CA":case"MX":case"AR":case"CO":case"PE":case"VE":case"EC":case"BO":case"CL":case"CR":case"DO":case"PA":case"PR":case"SV":case"GT":case"HN":case"NI":case"PY":case"UY":case"PH":case"SA":case"EG":case"QA":case"KW":case"AE":case"JO":case"LB":case"IL":return 0;default:return 1}}function formatoBool(e,t){return textoEnVezDeIcono&&(t=!1),0==e?"":t?'<i class="bi bi-check-circle-fill text-success fw-bold"></i><title>S√≠</title>':"S√≠"}function formatoPeriodicidad(e){return""==e?"":"y"==e?"Diaria":"ww"==e?"Semanal":"m"==e?"Mensual":"q"==e?"Trimestral":void 0}function formatBanco(e,t){return"0".repeat(t-e.length)+e}function cadenaCeros(e,t){var a=(e=e.trim()).length,o="",n="";for(let t=0;t<=a;t++)n=e.substr(t,1),-1!="1234567890".indexOf(n)&&(o+=n);return formatBanco(o,t)}function devBool(e){return 0!=e&&0!=e}function porcentajeFocus(e){sMask1ant=e}function porcentajeBlur(e){let t=document.getElementById(e),a=t.value;if(a!=sMask1ant){let e=quitarMascara(a,",");e>100&&(e=100),t.value=e.toFixed(2).toString().replace(".",",")+" %"}}function mascara(e,t,a,o){var n="";return e>0&&(n=t+"0".repeat(e)),$.trim("#"+a+"##0"+n+" "+o)}function formatoNum(e,t,a,o,n){var s=e.toFixed(t).toString();x=(s+="").split("."),x1=x[0],x2=x.length>1?a+x[1]:"";for(var c=/(\d+)(\d{3})/;c.test(x1);)x1=x1.replace(c,"$1"+o+"$2");return $.trim(x1+x2+" "+n)}function quitarMascara(e,t){for(var a=e.length,o="",n="1234567890"+t,s=0;s<=a;s++){var c=e.substr(s,1);-1!=n.indexOf(c)&&(","==c&&(c="."),o+=c)}return 0==o.length&&(o="0"),parseFloat(o)}function abrirGoogleMaps(e,t,a,o,n){var s=rutaGoogleMaps(e,t,a,o,n);return s&&hiperenlace(s,4),!1}function rutaGoogleMaps(e,t,a,o,n){let s="";return""!=(e=e||"")&&(s+=e),""!=(t=t||"")&&(s=s+","+t),""!=(a=a||"")&&(s=s+","+a),""!=(o=o||"")&&(s=s+","+o),""!=(n=n||"")&&(s=s+","+n),""!=s?"https://www.google.com/maps/search/?api=1&query="+s:""}function clienteCorreo(e){localStorage.setItem("clienteCorreo",e),document.getElementById("btnClienteCorreo").textContent=tExp(e,"")}function hiperenlace(e,t){if(!dEstSuscrip())return!1;if(4==t)abrirVentanaUnica(e);else if(6==t)abrirVentanaUnica("https://www.linkedin.com/in/"+e);else if(7==t)abrirVentanaUnica("https://t.me/"+e);else if(8==t)abrirVentanaUnica("https://m.me/"+e);else if(9==t)abrirVentanaUnica("https://twitter.com/messages/compose?recipient_id="+e);else if(10==t)abrirVentanaUnica("https://ig.me/m/"+e);else if(5==t){var a="",o=encodeURIComponent(e);switch(localStorage.getItem("clienteCorreo")){case"1":a=/Android/i.test(navigator.userAgent)?`intent://compose?to=${o}#Intent;scheme=mailto;package=com.google.android.gm;end;`:`https://mail.google.com/mail/?view=cm&fs=1&to=${o}`;break;case"2":return void openOutlookCompose(e).then((e=>{e&&abrirVentanaUnica(encodeURIComponent(e))}));case"3":return void navigator.clipboard.writeText(e).then((()=>{alert(tExp("üìã Direcci√≥n copiada al portapapeles: ","")+e),abrirVentanaUnica("https://www.icloud.com/mail/")}));case"4":a=`https://compose.mail.yahoo.com/?to=${o}`;break;default:a=`mailto:${e}`}""!=a&&abrirVentanaUnica(a)}else{var n=e.length,s="";if(1==t||2==t)var c="1234567890+";else c="1234567890";for(var r=0;r<=n;r++){var i=e.substr(r,1);-1!=c.indexOf(i)&&(s+=i)}if(0!=s.length){i="";1==t&&(i="tel:"+s),2==t&&(i="sms:"+s),3==t&&(i="https://wa.me/"+parseFloat(s)),abrirVentanaUnica(i)}}return!1}function devDato(e,t,a){let o=new FormData;o.append("queries",e),o.append("esBDempresas",0),async function(){const e=await fetch("https://"+window.location.host+"/multiselect",{method:"POST",body:o});return await e.json()}().then((e=>{let o=e[0].datoDevuelto||"";1==a?t.defaultValue=o:t.value=o})).catch((e=>{1==a?t.defaultValue="":t.value=""}))}function modal1(e,t,a){let o='<div class="modal" id="dialogo1" tabindex="-1">';o+='   <div class="modal-dialog">',o+='       <div class="modal-content">',o+='           <div class="modal-header bg-light">',o+='               <h5 class="modal-title">'+e+"</h5>",o+='               <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>',o+="          </div>",o+='          <div class="modal-body">',o+='              <div align="center">',o+="                  <p>"+t+"</p>",o+="              </div>",o+="          </div>",o+="      </div>",o+="  </div>",o+="</div>",a.innerHTML=o,new bootstrap.Modal(dialogo1).show()}function sleep(e){return new Promise((t=>setTimeout(t,e)))}function tooltips(){[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')).map((function(e){return this.addEventListener("hide.bs.tooltip",(function(){new bootstrap.Tooltip(e)})),new bootstrap.Tooltip(e)}))}function barraPaginacion(e){window.innerWidth<=992?$(e).bootstrapTable("refreshOptions",{paginationParts:["pageList"]}):$(e).bootstrapTable("refreshOptions",{paginationParts:["pageInfo","pageList"]})}function noIncluidoEnContrasena(e,t){for(var a=(e=e.trim()).length,o=!1,n=0;n<a;n++){var s=e.substr(n,1);if(1==t)var c="1234567890".indexOf(s);if(2==t)c="abcdefghijklmn√±opqrstuvwxyz".indexOf(s);if(3==t)c="ABCDEFGHIJKLMN√ëOPQRSTUVWXYZ".indexOf(s);if(4==t)c="!@#$%_-+=?".indexOf(s);if(c>=0){o=!0;break}}return!o}function permisosVentana(e){let t=dPermiso(e,0,10),a=t.substring(0,4),o=document.getElementById(a+"2"),n=document.getElementById(a+"2b");"0"==t[5]?(o.disabled=!0,n.style.display="none"):(o.disabled=!1,n.style.display="");let s=document.getElementById(a+"3"),c=document.getElementById(a+"3b");"0"==t[6]?(s.disabled=!0,c.style.display="none"):(s.disabled=!1,c.style.display="");let r=document.getElementById(a+"4"),i=document.getElementById(a+"4b");"0"==t[7]?(r.disabled=!0,i.style.display="none"):(r.disabled=!1,i.style.display="");let l=document.getElementById(a+"5"),d=document.getElementById(a+"5b");"0"==t[8]?(l.disabled=!0,d.style.display="none"):(l.disabled=!1,d.style.display="");let u=document.getElementById(a+"6"),p=document.getElementById(a+"6b");"0"==t[9]?(u.disabled=!0,p.style.display="none"):(u.disabled=!1,p.style.display="")}function dPermiso(e,t,a){if("admin"==localStorage.getItem("nomUs"))return 10==a?"111111":"1";{let e=localStorage.getItem("permisosGrupo"),o=e.indexOf("");return e.substring(o+t,o+a)}}function abrirToast(e){var t=document.getElementById(e);new bootstrap.Toast(t).show()}function gesDoc(e){let t=0,a="",o="";switch(e){case 84:t=window.idEvento,a="formEvento",o="eventos";break;case 85:t=window.idTabContactos,a="formContacto",o="contactos"}if(!isNumeric(t))return!1;localStorage.setItem("tfGesDoc",e),localStorage.setItem("numGesDoc",t),cambioDiv(o,"documentos",1,0)}function isNumeric(e){return!isNaN(parseFloat(e))&&isFinite(e)}function eliminarReg1(e,t,a,o){let n=Object.keys($("#"+e).bootstrapTable("getData")).length;if(0==n)return!1;let s=window[t],c=indice1(window[t],a,e);window[t]=n-1==c?1==n?"":$("#"+e).bootstrapTable("getData")[c-1][a]:$("#"+e).bootstrapTable("getData")[c+1][a],$("#"+e).bootstrapTable("remove",{field:a,values:[s]}),""!=o&&window[o].push(s)}function indice1(e,t,a){let o=Object.keys($("#"+a).bootstrapTable("getData")).length;if(0!=o)for(i=0;i<o;i++)if($("#"+a).bootstrapTable("getData")[i][t]==e)return i}function toggleFullScreen(e){var t=window.document,a=t.documentElement,o=(document.getElementById(e),document.getElementById("fullscreen-icon")),n=document.getElementById("fullscreen-txt"),s=a.requestFullscreen||a.mozRequestFullScreen||a.webkitRequestFullScreen||a.msRequestFullscreen,c=t.exitFullscreen||t.mozCancelFullScreen||t.webkitExitFullscreen||t.msExitFullscreen;document.fullscreenElement?(c.call(t),o.classList.remove("bi-arrows-collapse"),o.classList.add("bi-arrows-fullscreen"),n.innerText=tExp("Pantalla completa",""),localStorage.setItem("isFullscreen","false")):(s.call(a),o.classList.remove("bi-arrows-fullscreen"),o.classList.add("bi-arrows-collapse"),n.innerText=tExp("Pantalla normal",""),localStorage.setItem("isFullscreen","true"))}function mapFormat(e,t,a,o,n){let s=rutaGoogleMaps(e,t,a,o,n);return""!=s?`<a onClick="hiperenlace('${s}', 4)" class="text-primary d-print-none">\n                    <i class="bi bi-geo-alt-fill" style="font-size: 1rem;" title="${tExp("Abrir Google Maps","")}"></i>\n                </a>`:""}function etiFormat(e,t,a){const o=document.createDocumentFragment();if(0!=e){const t=createTagElement(e);t.style.margin="5px",o.appendChild(t)}if(0!=t){const e=createTagElement(t);e.style.margin="5px",o.appendChild(e)}if(0!=a){const e=createTagElement(a);e.style.margin="5px",o.appendChild(e)}const n=document.createElement("div");return n.appendChild(o),n.innerHTML}function etiFormatPrint(e,t,a){function o(e){const t=dataEtiquetas.find((t=>t.num==e));return t?t.des:""}let n=[];return 0!=e&&n.push(o(e)),0!=t&&n.push(o(t)),0!=a&&n.push(o(a)),n.join(" ")}function comFormat(e,t,a,o,n,s,c,r,i,l,d,u,p,m,b,f,g){if(t||a||o||n||s||c||r||i||l||d||u||p||m||b){const C=document.createElement("a");return C.href="#",C.innerHTML='<i class="bi bi-wifi" class="d-print-none"></i>',C.addEventListener("click",(C=>{C.preventDefault(),comFormatDialogo(e,t,a,o,n,s,c,r,i,l,d,u,p,m,b,f,g)})),C}return""}function comFormatDialogo(e,t,a,o,n,s,c,r,i,l,d,u,p,m,b,f,g){let C="";t&&(C='<div class="row mb-1"><div class="btn-group" role="group"><button class="btn btn-lg btn-outline-success" title="'+tExp("Llamar","")+'" data-bs-toggle="tooltip" onClick="hiperenlace(\''+t+'\', 1)"><i class="bi bi-telephone-fill"></i></button><button class="btn btn-lg btn-outline-success" title="'+tExp("WhatsApp","")+'" data-bs-toggle="tooltip" onClick="hiperenlace(\''+t+'\', 3)"><i class="bi bi-whatsapp"></i></button><button class="btn btn-lg btn-outline-success" title="'+tExp("SMS","")+'" data-bs-toggle="tooltip" onClick="hiperenlace(\''+t+'\', 2)"><i class="bi bi-chat-left-text"></i></button></div></div>'),a&&(C+='<div class="row mb-1"><div class="btn-group" role="group"><button class="btn btn-lg btn-outline-success" title="'+tExp("Llamar","")+'" data-bs-toggle="tooltip" onClick="hiperenlace(\''+a+'\', 1)"><i class="bi bi-telephone-fill"></i></button><button class="btn btn-lg btn-outline-success" title="'+tExp("WhatsApp","")+'" data-bs-toggle="tooltip" onClick="hiperenlace(\''+a+'\', 3)"><i class="bi bi-whatsapp"></i></button><button class="btn btn-lg btn-outline-success" title="'+tExp("SMS","")+'" data-bs-toggle="tooltip" onClick="hiperenlace(\''+a+'\', 2)"><i class="bi bi-chat-left-text"></i></button></div></div>'),(o||n||d||u||p||m||b)&&(C+='<div class="row mb-1"><div class="btn-group" role="group">',o&&(C+='<button class="btn btn-lg btn-outline-primary" title="'+tExp("Correo electr√≥nico","")+'" data-bs-toggle="tooltip" onClick="hiperenlace(\''+o+'\', 5)"><i class="bi bi-at"></i></button>'),n&&(C+='<button class="btn btn-lg btn-outline-primary" title="'+tExp("Direcci√≥n web","")+'" data-bs-toggle="tooltip" onClick="hiperenlace(\''+n+'\', 4)"><i class="bi bi-globe2"></i></button>'),(d||u||p||m||b)&&(C+='<button class="btn btn-lg btn-outline-primary" title="'+tExp("Abrir Google Maps","")+'" data-bs-toggle="tooltip" onClick="abrirGoogleMaps(\''+d+"', '"+u+"', '"+p+"', '"+m+"', '"+b+'\')"><i class="bi bi-geo-alt-fill"></i></button>'),C+="</div></div>"),(s||c||r||i||l)&&(C+='<div class="row mb-1"><div class="btn-group" role="group">',s&&(C+='<button class="btn btn-lg btn-outline-primary" title="LinkedIn" \tdata-bs-toggle="tooltip" onClick="hiperenlace(\''+s+'\', 6)"><i class="bi bi-linkedin"></i></button>'),c&&(C+='<button class="btn btn-lg btn-outline-primary" title="Telegram" \tdata-bs-toggle="tooltip" onClick="hiperenlace(\''+c+'\', 7)"><i class="bi bi-telegram"></i></button>'),i&&(C+='<button class="btn btn-lg btn-outline-primary" title="Messenger" \tdata-bs-toggle="tooltip" onClick="hiperenlace(\''+i+'\', 8)"><i class="bi bi-messenger"></i></button>'),l&&(C+='<button class="btn btn-lg btn-outline-primary" title="X" \t\t\tdata-bs-toggle="tooltip" onClick="hiperenlace(\''+l+'\', 9)"><i class="bi bi-twitter-x"></i></button>'),C+="</div></div>"),1==g?(""==document.getElementById("gesdGrupo_contactos").style.display&&(C+='<div class="row"><div class="btn-group" role="group">',C+='<button class="btn btn-lg btn-outline-dark align-items-center" title="'+tExp("Interacciones","")+'" \tdata-bs-toggle="tooltip" onClick="nombrePersonaContacto = \''+e+"'; comunicacionesContacto.hide(); cambioDiv('contactos', 'interacciones', 1, 0);\"><i class=\"bi bi-journals\"></i><span style=\"font-size: 0.875rem;\"></span></button>",C+='<button class="btn btn-lg btn-outline-dark align-items-center" title="'+tExp("Gesti√≥n documental","")+'" \t  \tdata-bs-toggle="tooltip" onClick="nombrePersonaContacto = \''+e+"'; comunicacionesContacto.hide(); localStorage.setItem('tfGesDoc', 85); localStorage.setItem('numGesDoc', "+f+'); cambioDiv(\'contactos\', \'documentos\', 1, 0);"><i class="bi bi-folder-symlink"></i><span style="font-size: 0.875rem;"></span></button>',C+='<button class="btn btn-lg btn-outline-dark align-items-center" title="'+tExp("Eventos","")+'" \t \tdata-bs-toggle="tooltip" onClick="nombrePersonaContacto = \''+e+"'; comunicacionesContacto.hide(); localStorage.setItem('vistaIni', 'listYear'); localStorage.setItem('codContactoNlistadoEventos', "+f+'); setTimeout(function() { cambioDiv(\'contactos\', \'eventos\', 1, 0);  }, 500);"><i class="bi bi-calendar2-check"></i><span style="font-size: 0.875rem;"></span></button>',C+="</div></div>"),C&&modMsjCom("contactos005",e,C,msjContactos)):C&&modMsjCom("recordatorios005",e,C,msjRecordatorios)}function corFormatNew(e){return e?'<a href="#" onclick="hiperenlace(\''+e+'\', 5); return false;" class="text-decoration-none">'+e+"</a>":""}function webFormatNew(e){return e?'<a href="#" onclick="hiperenlace(\''+e+'\', 4); return false;" class="text-decoration-none">'+e+"</a>":""}function telFormaNew(e){if(!e)return"";return`\n        <div style="white-space: nowrap;">\n            <button \n        class="btn btn-outline-primary dropdown-toggle btn-mini hide-on-pdf"\n        type="button" \n        data-bs-toggle="dropdown" \n        aria-expanded="false"\n        style="border-radius: 10px; border-color: #007bff; background-color: #f8f9fa; color: #007bff;"\n    ></button>\n            <ul \n        class="dropdown-menu p-2 shadow-sm" \n        style="border-radius: 8px; background-color: #f8f9fa; border: 1px solid #007bff;"\n    >\n                ${`\n\t\t<li>\n\t\t    <a class="dropdown-item d-flex align-items-center" onClick="hiperenlace('${e}', 1)" style="gap: 8px;">\n\t\t        <i class="bi bi-telephone" style="font-size: 1.2rem; color: #007bff;"></i>\n\t\t        <span style="color: #333; font-weight: 500;">${" "+tExp("Llamar","")}</span>\n\t\t    </a>\n\t\t</li>\n\t\t<li><hr class="dropdown-divider"></li>\n\t\t<li>\n\t\t    <a class="dropdown-item d-flex align-items-center" onClick="hiperenlace('${e}', 3)" style="gap: 8px;">\n\t\t        <i class="bi bi-whatsapp" style="font-size: 1.2rem; color: #25d366;"></i>\n\t\t        <span style="color: #333; font-weight: 500;"> Whatsapp</span>\n\t\t    </a>\n\t\t</li>\n\t\t<li><hr class="dropdown-divider"></li>\n\t\t<li>\n\t\t    <a class="dropdown-item d-flex align-items-center" onClick="hiperenlace('${e}', 2)" style="gap: 8px;">\n\t\t        <i class="bi bi-chat-left-text" style="font-size: 1.2rem; color: #007bff;"></i>\n\t\t        <span style="color: #333; font-weight: 500;"> SMS</span>\n\t\t    </a>\n\t\t</li>\n    `}\n            </ul>\n            <span style="margin-left: 8px;">${e}</span>\n        </div>\n    `}function telFormaNew1(e){if(!e)return"";return`\n        <div style="display: inline-flex; align-items: center; gap: 8px; white-space: nowrap;">\n            <button \n        class="btn btn-outline-primary dropdown-toggle btn-mini hide-on-pdf"\n        type="button"\n        data-bs-toggle="dropdown"\n        aria-expanded="false"\n        style="border-radius: 10px; border-color: #007bff; background-color: #f8f9fa; color: #007bff; display: inline-block;"\n    ></button>\n            <ul \n        class="dropdown-menu p-2 shadow-sm"\n        style="border-radius: 8px; background-color: #f8f9fa; border: 1px solid #007bff;"\n    >\n                ${`\n\t\t<li>\n\t\t    <a class="dropdown-item d-flex align-items-center" onClick="hiperenlace('${e}', 1)" style="gap: 8px;">\n\t\t        <i class="bi bi-telephone" style="font-size: 1.2rem; color: #007bff;"></i>\n\t\t        <span style="color: #333; font-weight: 500;">${" "+tExp("Llamar","")}</span>\n\t\t    </a>\n\t\t</li>\n\t\t<li><hr class="dropdown-divider"></li>\n\t\t<li>\n\t\t    <a class="dropdown-item d-flex align-items-center" onClick="hiperenlace('${e}', 3)" style="gap: 8px;">\n\t\t        <i class="bi bi-whatsapp" style="font-size: 1.2rem; color: #25d366;"></i>\n\t\t        <span style="color: #333; font-weight: 500;"> Whatsapp</span>\n\t\t    </a>\n\t\t</li>\n\t\t<li><hr class="dropdown-divider"></li>\n\t\t<li>\n\t\t    <a class="dropdown-item d-flex align-items-center" onClick="hiperenlace('${e}', 2)" style="gap: 8px;">\n\t\t        <i class="bi bi-chat-left-text" style="font-size: 1.2rem; color: #007bff;"></i>\n\t\t        <span style="color: #333; font-weight: 500;"> SMS</span>\n\t\t    </a>\n\t\t</li>\n    `}\n            </ul>\n            <span>${e}</span>\n        </div>\n    `}function linkedinFormat(e){return e?'<a href="#" onclick="hiperenlace(\''+e+'\', 6); return false;" class="text-decoration-none">'+e+"</a>":""}function telegramFormat(e){return e?'<a href="#" onclick="hiperenlace(\''+e+'\', 7); return false;" class="text-decoration-none">'+e+"</a>":""}function messengerFormat(e){return e?'<a href="#" onclick="hiperenlace(\''+e+'\', 8); return false;" class="text-decoration-none">'+e+"</a>":""}function xFormat(e){return e?'<a href="#" onclick="hiperenlace(\''+e+'\', 9); return false;" class="text-decoration-none">'+e+"</a>":""}function instagramFormat(e){return e?'<a href="#" onclick="hiperenlace(\''+e+'\', 10); return false;" class="text-decoration-none">'+e+"</a>":""}function abrirModal1DesdeFicha(e){1==e?abrirVentanaUnica("planes.html"):abrirSuscripcion(1)}function gesDocContenido(e){return abrirVentanaUnica("https://"+window.location.host+"/descargarFichero?prefijo="+localStorage.getItem("prefijo")+"&id="+e),!1}function visorContenido(e,t,a){return e.preventDefault(),cargarDocumentoReal(t,a),!1}async function cargarDocumentoReal(e,t){var a=obtenerExtensionArchivo(t);if("docx"==a||"xlsx"==a||"pptx"==a||"doc"==a||"xls"==a||"ppt"==a)abrirDocumentoEnOneDrive(e,0);else{if("odt"!=a&&"ods"!=a&&"odp"!=a){const t=localStorage.getItem("prefijo"),a=await fetch(`https://${window.location.host}/visor`,{method:"POST",body:new URLSearchParams({prefijo:t,id:e,soloInfo:"true",precache:"true"})}),o=await a.json();if(!o||!o.data||!o.data.value1)throw new Error("Documento no disponible.");o.data.value1;const n=o.data.value2,s=`https://${window.location.host}/visor?prefijo=${encodeURIComponent(t)}&id=${encodeURIComponent(e)}`;let c;c=[".gdoc",".gsheet",".gslides",".rtf",".csv"].includes(n)?`https://docs.google.com/viewer?url=${encodeURIComponent(s)}&embedded=true`:s;return abrirVentanaUnica(`${encodeURIComponent(c)}`),!1}visorDocEnCollabora(e,t)}}function abrirVentanaUnica(e){!windowObjectReference1||windowObjectReference1.closed?(e="window1.html?url="+e,(windowObjectReference1=window.open(e,"ventanaUnicaVisor",`height=${screen.height},width=${screen.width},menubar=no,titlebar=yes,toolbar=no`,"noreferrer")).moveTo(0,0)):(windowObjectReference1.location.href=e,windowObjectReference1.focus())}function activarTooltips(){[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')).map((function(e){return new bootstrap.Tooltip(e,{trigger:"hover",delay:{show:500,hide:200},boundary:"viewport",container:"body"})}))}function activarTooltipsDiv(e){var t=document.getElementById(e);[].slice.call(t.querySelectorAll('[data-bs-toggle="tooltip"]')).map((function(e){return new bootstrap.Tooltip(e,{trigger:"hover",delay:{show:500,hide:200},boundary:"viewport",container:"body"})}))}function desactivarTooltipsDiv(e){var t=document.getElementById(e);[].slice.call(t.querySelectorAll('[data-bs-toggle="tooltip"]')).forEach((function(e){var t=bootstrap.Tooltip.getInstance(e);t&&t.dispose()}))}function crearToastDocumento(e,t,a){let o='<div class="toast-container position-fixed bottom-0 start-50 translate-middle-x p-0">';o+='   <div id="liveToastDocumento" class="toast d-inline bg-transparent" role="alert" aria-live="assertive" aria-atomic="true" data-bs-autohide="false">',o+='       <div class="toast-body">',o+='           <div class="d-flex">',o+='               <button class="btn btn-success btn-lg rounded-circle" id="btnAgregarDocumento" title="'+e+'" onClick="const tooltip1 = bootstrap.Tooltip.getInstance(this); tooltip1.hide(); regTabla('+t+", "+a+', 1)" data-bs-toggle="tooltip"><i class="bi bi-file-earmark-plus" style="font-size: 1.4rem; color: currentColor;"></i></button>',o+='               <button type="button" class="btn-close btn-sm" data-bs-dismiss="toast" aria-label="Close" title="Cerrar" data-bs-toggle="tooltip"></button>',o+="              </div>",o+="          </div>",o+="      </div>",o+="</div>",toaDocumento.innerHTML=o;const n=document.getElementById("liveToastDocumento");n.addEventListener("shown.bs.toast",(function(){activarTooltipsDiv("liveToastDocumento")})),n.addEventListener("hidden.bs.toast",(function(){desactivarTooltipsDiv("liveToastDocumento"),setTimeout((function(){n.remove()}),500)}))}function crearToastInteraccion(e,t,a){let o='<div class="toast-container position-fixed bottom-0 start-50 translate-middle-x p-0">';o+='   <div id="liveToastInteraccion" class="toast d-inline bg-transparent" role="alert" aria-live="assertive" aria-atomic="true" data-bs-autohide="false">',o+='       <div class="toast-body">',o+='           <div class="d-flex">',o+='               <button class="btn btn-success btn-lg rounded-circle" id="btnAgregarInteraccion" title="'+e+'" onClick="const tooltip1 = bootstrap.Tooltip.getInstance(this); tooltip1.hide(); regTabla('+t+", "+a+', 1)" data-bs-toggle="tooltip"><i class="bi bi-journal-plus" style="font-size: 1.4rem; color: currentColor;"></i></button>',o+='               <button type="button" class="btn-close btn-sm" data-bs-dismiss="toast" aria-label="Close" title="Cerrar" data-bs-toggle="tooltip"></button>',o+="              </div>",o+="          </div>",o+="      </div>",o+="</div>",toaInteraccion.innerHTML=o;const n=document.getElementById("liveToastInteraccion");n.addEventListener("shown.bs.toast",(function(){activarTooltipsDiv("liveToastInteraccion")})),n.addEventListener("hidden.bs.toast",(function(){desactivarTooltipsDiv("liveToastInteraccion"),setTimeout((function(){n.remove()}),500)}))}function compPagCambiada(e,t,a){let o=!1,n=0;do{o=pagCambiada(e,t,a[n][0],a[n][1]),n++}while(0==o);return!1}function pagCambiada(e,t,a,o){var n=!1;let s=a.id;if(""==o?e.substring(e.length-s.length)==s&&(n=!0):e.substring(e.length-s.length)==s&&t.substring(t.length-o.length)==o&&(n=!0),n){let e=bootstrap.Modal.getInstance(a);e._isShown&&e.hide()}return n}function modalColTab(e,t,a){["modalColTabContactos","modalColTabInteracciones","modalColTabParticipantes"].forEach((e=>{const t=document.getElementById(e);if(t){const e=bootstrap.Modal.getInstance(t);e&&(e.hide(),e.dispose())}}));var o="listFieldsContactos";"tabInteracciones"==a?o="listFieldsInteracciones":"tabParticipantes"==a&&(o="listFieldsParticipantes");const n=`\n        <div class="modal fade modal-dialog-scrollable" id="${e}" tabindex="-1" data-bs-backdrop="false">\n            <div class="modal-dialog modal-md">\n                <div class="modal-content rounded-4 shadow">\n                    <div class="modal-header bg-light sticky-top">\n                        <h6 class="modal-title">`+tExp("Columnas a mostrar",localStorage.getItem("idiomaPais"))+`</h6>\n                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" onclick="saveColumnConfig('${a}')"></button>\n                    </div>\n                    <div class="modal-body" style="max-height: 300px; overflow-y: auto; width: auto;">\n                        <form>\n                            <div class="form-group" id="${o}">\n                                ${listColNom(a)}\n                            </div>\n                        </form>\n                    </div>\n                    <div class="modal-footer bg-light sticky-bottom d-flex justify-content-center align-items-center"> \n                        <div class="row justify-content-between align-content-center gx-5 gy-0">\n                            <div class="col-auto">\n                                <button class="btn btn-outline-success" style="width: 50px;" onclick="moveSelectedColumn('${a}', 'up')">\n                                    <i class="bi bi-caret-up-fill"></i>\n                                </button>\n                            </div>\n                            <div class="col-auto">\n                                <button class="btn btn-outline-success" style="width: 50px;" onclick="moveSelectedColumn('${a}', 'down')">\n                                    <i class="bi bi-caret-down-fill"></i>\n                                </button>                         \n                            </div> \n                        </div>                       \n                    </div>\n                </div>\n            </div>\n        </div>`,s=document.getElementById(t);if(!s)return void console.error(`No se encontr√≥ el contenedor con ID: ${t}`);s.innerHTML=n;const c=document.getElementById(e);if(!c)return void console.error(`No se pudo crear el modal con ID: ${e}`);new bootstrap.Modal(c).show();const r=getSelectableRowClass(a),i=document.querySelector(`.${r}`);i?selectRow(i,a):console.warn("No se encontr√≥ la primera fila seleccionable.")}function getSelectableRowClass(e){return"tabInteracciones"==e?"selectable-row2":"tabParticipantes"==e?"selectable-row3":"selectable-row1"}function listColNom(e){const t=$("#"+e).bootstrapTable("getOptions").columns[0];let a='<ul class="list-group">';const o=getSelectableRowClass(e);return t.forEach(((t,n)=>{const s=!1!==t.visible,c=t.title||"",r=!1!==t.switchable;!(!0===t.forceHide)&&r&&""!==c.trim()&&(a+=`\n                <li class="list-group-item d-flex justify-content-between align-items-center ${o}" \n                    data-index="${n}" \n                    style="cursor: pointer;" \n                    onclick="selectRow(this, '${e}')">\n                    <div>\n                        <input type="checkbox" class="form-check-input me-2" data-field="${t.field}" \n                            ${s?"checked":""} \n                            onchange="toggleColumnVisibility('${e}', '${t.field}', this.checked)">\n                        <span>${c}</span>\n                    </div>\n                </li>`)})),a+="</ul>",a}function toggleColumnVisibility(e,t,a){a?$("#"+e).bootstrapTable("showColumn",t):$("#"+e).bootstrapTable("hideColumn",t)}function selectRow(e,t){document.querySelectorAll(`.${getSelectableRowClass(t)}`).forEach((e=>{e.style.background="",e.style.color="",e.style.border=""})),e.style.background="linear-gradient(to right, #d4edda, #c3e6cb)",e.style.color="#155724",e.style.border="1px solid #c3e6cb"}function moveSelectedColumn(e,t){const a=getSelectableRowClass(e);let o=document.querySelector(`.${a}[style*="background"]`);if(!o)return void alert("Seleccione una fila para mover");let n=parseInt(o.getAttribute("data-index"),10),s=$("#"+e),c=s.bootstrapTable("getOptions").columns[0];if("up"===t&&n<=("tabContactos"===e?7:2)||"down"===t&&n>=c.length-1)return;"up"===t?[c[n-1],c[n]]=[c[n],c[n-1]]:"down"===t&&([c[n],c[n+1]]=[c[n+1],c[n]]),s.bootstrapTable("refreshOptions",{columns:c}),"tabParticipantes"==e&&(salirModalEvento=!0);let r=n+("up"===t?-1:1);var i=document.getElementById("listFieldsContactos");"tabInteracciones"==e?i=document.getElementById("listFieldsInteracciones"):"tabParticipantes"==e&&(i=document.getElementById("listFieldsParticipantes")),i.innerHTML=listColNom(e);const l=document.querySelector(`.${a}[data-index="${r}"]`);l&&selectRow(l,e)}function formatearColumna(e){"alt"===e.field||"ani"===e.field||"fin"===e.field||"ffi"===e.field?e.formatter=fecFormato:"te1"===e.field||"te2"===e.field?e.formatter=telFormato:"cor"===e.field?e.formatter=corFormato:"www"===e.field?e.formatter=webFormato:"rol"===e.field?e.formatter=rolFormato:"eg1"===e.field||"eg2"===e.field||"eg3"===e.field?e.formatter=elementoGrupoFormato:"et1"===e.field||"et2"===e.field||"et3"===e.field?e.formatter=etiFormatoUno:"eti"===e.field?e.formatter=etiFormato:"lin"===e.field?e.formatter=linkedinFormato:"tel"===e.field?e.formatter=telegramFormato:"ins"===e.field?e.formatter=instagramFormato:"mes"===e.field?e.formatter=messengerFormato:"xxx"===e.field?e.formatter=xFormato:"fhii"===e.field||"reci"===e.field?e.formatter=fecHorFormato:"tipi"===e.field?e.formatter=tipoInteraccionFormato:"etai"===e.field?e.formatter=etapaInteraccionFormato:"resi"===e.field?e.formatter=resultadoInteraccionFormato:"peni"===e.field&&(e.formatter=pendienteInteraccionFormato)}function cerrarModalCol(){return modalColTabla._isShown&&modalColTabla.hide(),!1}function cambiarHashAlCerrarModal(){return history.go(-1),!1}function modMsjCom(e,t,a,o){let n='<div class="modal fade modal-sm" id="dialogo'+e+'" tabindex="-1" data-bs-backdrop="false">';n+='   <div class="modal-dialog modal-dialog-centered">',n+='       <div class="modal-content">',n+='           <div class="modal-header bg-info">',n+='               <i class="bi bi-person-fill"></i>',n+=' \t\t\t\t<h6 class="modal-title">&nbsp;'+t+"</h6>",n+='               <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>',n+="          </div>",n+='          <div class="modal-body bg-light">',n+=a,n+="          </div>",n+="      </div>",n+="  </div>",n+="</div>",o.innerHTML=n;let s="dialogo"+e;return(comunicacionesContacto=new bootstrap.Modal(document.getElementById(s))).show(),!1}function modMsj(e,t,a,o,n){let s='<div class="modal" id="dialogo'+e+'" tabindex="-1" data-bs-backdrop="false">';s+='   <div class="modal-dialog">',s+='       <div class="modal-content">',s+='           <div class="modal-header bg-light">',s+='               <h5 class="modal-title">'+t+"</h5>",s+='               <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>',s+="          </div>",s+='          <div class="modal-body">',s+='              <div align="center">',s+="                  <p>"+a+"</p>",s+="              </div>",s+="          </div>",s+="      </div>",s+="  </div>",s+="</div>",o.innerHTML=s;let c="dialogo"+e;return n?history.replaceState(void 0,void 0,"#"+c):window.location.hash="#"+c,new bootstrap.Modal(document.getElementById(c)).show(),!1}function modMsjFinPruebaToast(e,t,a,o){document.body.insertAdjacentHTML("beforeend",'<div id="toast-overlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 1100;"></div>');let n='<div class="toast align-items-center position-fixed" id="toast'+e+'" role="alert" aria-live="assertive" aria-atomic="true" data-bs-autohide="false" style="z-index: 1101; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: white; border: 1px solid rgba(0,0,0,0.2);">';n+='   <div class="toast-header bg-light">',n+='       <strong class="me-auto">'+t+"</strong>",n+='       <button type="button" class="btn-close" id="close-toast" aria-label="Close"></button>',n+="   </div>",n+='   <div class="toast-body">',n+='       <div style="margin: 0; padding: 0;"><img src="./im/im4.jpg" alt="Test" style="width: 100%; height: auto;"></div>',n+='       <div style="text-align: center;" class="mt-3 mb-4">',n+='           <h4 class="fw-bold" style="color: orange;">'+a+"</h4>",n+='           <h6 class="fw-bold text-success">'+o+"</h6>",n+="       </div>",n+='       <div style="text-align: right;">',n+='           <button type="button" class="btn btn-outline-success btn-lg" onClick="opPrincipal(10);">',n+='               <i class="bi bi-palette2" style="font-size: 1.6rem; color: orange;"></i>&nbsp;<span>'+tExp("Planes PRO","")+"</span>",n+="           </button>",n+="       </div>",n+="   </div>",n+="</div>",document.body.insertAdjacentHTML("beforeend",n);let s=document.getElementById("toast"+e),c=new bootstrap.Toast(s);return c.show(),document.getElementById("close-toast").addEventListener("click",(function(){c.hide(),document.getElementById("toast-overlay").remove(),s.remove()})),!1}function crearToastContacto(e,t,a,o){let n='<div class="toast-container position-fixed bottom-0 start-50 translate-middle-x p-0">';n+='   <div id="liveToastContacto" class="toast d-inline bg-transparent" role="alert" aria-live="assertive" aria-atomic="true" data-bs-autohide="false">',n+='       <div class="toast-body">',n+='           <div class="d-flex">',n+='               <a href="#'+o+'" class="btn btn-success btn-lg rounded-circle" role="button" id="btnAgregarContacto" title="'+e+'" data-bs-toggle="tooltip" onClick="const tooltip1 = bootstrap.Tooltip.getInstance(this); tooltip1.hide(); regTabla('+t+", "+a+', 1)"><i class="bi bi-person-plus-fill" style="font-size: 1.4rem; color: currentColor;"></i></a>',n+='               <button type="button" class="btn-close btn-sm" data-bs-dismiss="toast" aria-label="Close" title="Cerrar" data-bs-toggle="tooltip"></button>',n+="            </div>",n+="          </div>",n+="      </div>",n+="</div>",toaContacto.innerHTML=n;const s=document.getElementById("liveToastContacto");s.addEventListener("shown.bs.toast",(function(){activarTooltipsDiv("liveToastContacto")})),s.addEventListener("hidden.bs.toast",(function(){desactivarTooltipsDiv("liveToastContacto"),setTimeout((function(){s.remove()}),500)}))}function toastSelFila(e,t){if("http: no such file"==e)return!1;let a='<div class="toast-container position-fixed top-50 start-50 translate-middle p-0">';a+='<div class="toast align-items-center bg-success text-white p-1" role="alert" aria-live="assertive" aria-atomic="true" data-bs-autohide="true" data-bs-delay="2000" id="selFila">',a+='<div class="d-flex justify-content-center">',a+='<div class="toast-body fw-bold fs-2">'+e+"</div>",a+="</div>",a+="</div>",a+="</div>",t.innerHTML=a,new bootstrap.Toast(document.getElementById("selFila")).show()}function toastMsj(e,t,a,o,n){var s=document.getElementById("toast"+n);s&&s.remove();let c='<div class="toast-container position-fixed top-50 start-50 translate-middle p-0">';c+='<div class="toast align-items-center bg-success text-white p-1" role="alert" aria-live="assertive" aria-atomic="true" data-bs-autohide="true" data-bs-delay="'+a+'" id="toast'+n+'">',c+='<div class="d-flex justify-content-center">',c+='<div class="toast-body fw-bold fs-'+o+'">'+e+"</div>",c+="</div>",c+="</div>",c+="</div>",t.innerHTML=c,new bootstrap.Toast(document.getElementById("toast"+n)).show()}function tExp(e,t){""==t&&(t=localStorage.getItem("idiomaPais"));var a=exp_es_ES.indexOf(e);if(-1==a)return e;switch(t){case"es-es":case"es-ES":return e;case"ca-es":case"ca-ES":return exp_ca_ES[a];case"eu-es":case"eu-ES":return exp_eu_ES[a];case"gl-es":case"gl-ES":return exp_gl_ES[a];case"en-gb":case"en-GB":return exp_en_GB[a];case"es-mx":case"es-MX":return exp_es_MX[a];case"es-cl":case"es-CL":return exp_es_CL[a];case"es-us":case"es-US":return exp_es_US[a];case"en-us":case"en-US":return exp_en_US[a];case"en-ca":case"en-CA":return exp_en_CA[a];case"en-au":case"en-AU":return exp_en_AU[a];case"it-it":case"it-IT":return exp_it_IT[a];case"pt-pt":case"pt-PT":return exp_pt_PT[a];case"pt-br":case"pt-BR":return exp_pt_BR[a];case"fr-fr":case"fr-FR":return exp_fr_FR[a];case"fr-ca":case"fr-CA":return exp_fr_CA[a];case"de-de":case"de-DE":return exp_de_DE[a];case"es-ar":case"es-AR":return exp_es_AR[a];case"es-co":case"es-CO":return exp_es_CO[a];case"es-pe":case"es-PE":return exp_es_PE[a];case"es-uy":case"es-UY":return exp_es_UY[a];case"en-nz":case"en-NZ":return exp_en_NZ[a];case"en-ie":case"en-IE":return exp_en_IE[a];case"en-in":case"en-IN":return exp_en_IN[a];case"en-sg":case"en-SG":return exp_en_SG[a];case"en-hk":case"en-HK":return exp_en_HK[a];case"en-my":case"en-MY":return exp_en_MY[a];case"fr-be":case"fr-BE":return exp_fr_BE[a];case"fr-ch":case"fr-CH":return exp_fr_CH[a];case"it-ch":case"it-CH":return exp_it_CH[a];case"de-at":case"de-AT":return exp_de_AT[a];case"de-be":case"de-BE":return exp_de_BE[a];case"de-ch":case"de-CH":return exp_de_CH[a];case"en-pk":case"en-PK":return exp_en_PK[a];case"en-ng":case"en-NG":return exp_en_NG[a];case"en-bd":case"en-BD":return exp_en_BD[a];case"en-ph":case"en-PH":return exp_en_PH[a];case"en-tz":case"en-TZ":return exp_en_TZ[a];case"en-za":case"en-ZA":return exp_en_ZA[a];case"en-ke":case"en-KE":return exp_en_KE[a];case"en-ug":case"en-UG":return exp_en_UG[a];case"en-gh":case"en-GH":return exp_en_GH[a];case"en-mw":case"en-MW":return exp_en_MW[a];case"en-zm":case"en-ZM":return exp_en_ZM[a];case"en-zw":case"en-ZW":return exp_en_ZW[a];case"en-cm":case"en-CM":return exp_en_CM[a];case"en-lk":case"en-LK":return exp_en_LK[a];case"es-ve":case"es-VE":return exp_es_VE[a];case"es-gt":case"es-GT":return exp_es_GT[a];case"es-ec":case"es-EC":return exp_es_EC[a];case"es-bo":case"es-BO":return exp_es_BO[a];case"es-cu":case"es-CU":return exp_es_CU[a];case"es-do":case"es-DO":return exp_es_DO[a];case"es-hn":case"es-HN":return exp_es_HN[a];case"es-py":case"es-PY":return exp_es_PY[a];case"es-sv":case"es-SV":return exp_es_SV[a];case"es-ni":case"es-NI":return exp_es_NI[a];case"es-pa":case"es-PA":return exp_es_PA[a];case"fr-cd":case"fr-CD":return exp_fr_CD[a];case"fr-cm":case"fr-CM":return exp_fr_CM[a];case"fr-mg":case"fr-MG":return exp_fr_MG[a];case"fr-ci":case"fr-CI":return exp_fr_CI[a];case"fr-bf":case"fr-BF":return exp_fr_BF[a];case"fr-ne":case"fr-NE":return exp_fr_NE[a];case"fr-sn":case"fr-SN":return exp_fr_SN[a];case"fr-ml":case"fr-ML":return exp_fr_ML[a];case"fr-bj":case"fr-BJ":return exp_fr_BJ[a];case"fr-rw":case"fr-RW":return exp_fr_RW[a];case"fr-td":case"fr-TD":return exp_fr_TD[a];case"fr-gn":case"fr-GN":return exp_fr_GN[a];case"pt-ao":case"pt-AO":return exp_pt_AO[a];case"pt-mz":case"pt-MZ":return exp_pt_MZ[a];default:return"es"==navigator.language.substring(0,2)?exp_es_ES[a]:exp_en_US[a]}}function cambiarTextoIdioma(e){document.querySelectorAll("span","option[span]").forEach((t=>{t.innerHTML=tExp(t.innerHTML,e)}));document.querySelectorAll("input[placeholder], textarea[placeholder]").forEach((t=>{t.placeholder=tExp(t.placeholder,e)}));document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach((t=>{t.title=tExp(t.title,e);new bootstrap.Tooltip(t)}));document.querySelectorAll("label").forEach((t=>{"etPolPriv"!=t.id&&"etContEncab"!=t.id&&"etTodoElDia"!=t.id&&(t.innerText=tExp(t.innerText,e))}));document.querySelectorAll("option").forEach((t=>{t.innerHTML=tExp(t.innerHTML,e)})),cambiarEnlacesIdioma(e)}function cambiarTextoIdiomaDiv(e,t){const a=document.getElementById(t);a.querySelectorAll("span","option[span]").forEach((t=>{t.innerHTML=tExp(t.innerHTML,e)}));a.querySelectorAll("input[placeholder], textarea[placeholder]").forEach((t=>{t.placeholder=tExp(t.placeholder,e)}));a.querySelectorAll('[data-bs-toggle="tooltip"]').forEach((t=>{t.title=tExp(t.title,e);new bootstrap.Tooltip(t)}));a.querySelectorAll("label").forEach((t=>{"etPolPriv"!=t.id&&"etContEncab"!=t.id&&"etTodoElDia"!=t.id&&(t.innerText=tExp(t.innerText,e))}));a.querySelectorAll("option").forEach((t=>{t.innerHTML=tExp(t.innerHTML,e)})),"modalMenu"==t&&cambiarEnlacesIdioma(e)}function cambiarEnlacesIdioma(e){""==e&&(e=localStorage.getItem("idiomaPais"));document.querySelectorAll("a[href]").forEach((t=>{if("recomendarAmigo"==t.id)switch(e){case"es-es":case"es-ES":t.href="mailto:?subject=Recomendaci√≥n%20App%20My%20Contacts%20Cloud&body=Hola%2C%0D%0A%0D%0ATe%20recomiendo%20que%20pruebes%20la%20App%20My%20Contacts%20Cloud.%20Es%20gratis%20y%20para%20siempre.%0D%0A%0D%0AAl%20hacer%20clic%20en%20https://mycontacts.cloud%20acceder%C3%A1s%20a%20la%20web%20de%20My%20Contacts%20y%20podr%C3%A1s%20suscribirte%20si%20te%20interesa.%0D%0A%0D%0ASaludos%20";break;case"ca-es":case"ca-ES":t.href="mailto:?subject=Recomanaci√≥%20de%20l'aplicaci√≥%20My%20Contacts%20Cloud&body=Hola%2C%0D%0A%0D%0ATe%20recomano%20que%20prove√Øs%20l'aplicaci√≥%20My%20Contacts%20Cloud.%20√âs%20gratu√Øta%20i%20per%20sempre.%0D%0A%0D%0AEn%20fer%20clic%20a%20https://mycontacts.cloud%20accedir√†s%20a%20la%20web%20de%20My%20Contacts%20i%20podr√†s%20subscriure't%20si%20t'interessa.%0D%0A%0D%0ASalutacions%20";break;case"eu-es":case"eu-ES":t.href="mailto:?subject=My%20Contacts%20Cloud%20Aplikazioaren%20Aholkua&body=Kaixo%2C%0D%0A%0D%0A%20My%20Contacts%20Cloud%20Aplikazioa%20probatzeko%20uste%20duzula%20aholkua.%20Doan%20eta%20betirako%20dago%20eskuragarri.%0D%0A%0D%0A%20Hemen%20sartuz%20https://mycontacts.cloud%20My%20Contacts%20webgunean%20ezazu%20zure%20izena%20ematea%20interesatzen%20bazait.%0D%0A%0D%0A%20Agurra%20";break;case"gl-es":case"gl-ES":t.href="mailto:?subject=Recomendaci√≥n%20de%20App%20My%20Contacts%20Cloud&body=Ola%2C%0D%0A%0D%0ARecom√©ndoche%20que%20probe%20a%20App%20My%20Contacts%20Cloud.%20√â%20de%20balde%20e%20para%20sempre.%0D%0A%0D%0AAo%20facer%20clic%20en%20https://mycontacts.cloud%20acceder√°s%20√°%20web%20de%20My%20Contacts%20e%20poder√°s%20subscribirte%20se%20che%20interesa.%0D%0A%0D%0ASa√∫dos%20";break;case"en-gb":case"en-GB":t.href="mailto:?subject=Recommendation%20My%20Contacts%20Cloud%20App&body=Hello%2C%0D%0A%0D%0AI%20recommend%20you%20to%20try%20the%20App%20My%20Contacts%20Cloud.%20It's%20free%20and%20forever.%0D%0A%0D%0ABy%20clicking%20on%20https://mycontacts.cloud%20you%20will%20access%20the%20My%20Contacts%20website%20and%20you%20can%20subscribe%20if%20you%20are%20interested.%0D%0A%0D%0ABest%20regards%20";break;case"es-mx":case"es-MX":case"es-cl":case"es-CL":case"es-us":case"es-US":case"es-ar":case"es-AR":case"es-co":case"es-CO":case"es-pe":case"es-PE":case"es-uy":case"es-UY":case"es-ve":case"es-VE":case"es-gt":case"es-GT":case"es-ec":case"es-EC":case"es-bo":case"es-BO":case"es-cu":case"es-CU":case"es-do":case"es-DO":case"es-hn":case"es-HN":case"es-py":case"es-PY":case"es-sv":case"es-SV":case"es-ni":case"es-NI":case"es-pa":case"es-PA":t.href="mailto:?subject=Recomendaci√≥n%20de%20la%20App%20My%20Contacts%20Cloud&body=Hola%2C%0D%0A%0D%0Ate%20recomiendo%20que%20pruebes%20la%20App%20My%20Contacts%20Cloud.%20Es%20gratis%20y%20para%20siempre.%0D%0A%0D%0AAl%20hacer%20clic%20en%20https://mycontacts.cloud%20acceder√°s%20a%20la%20web%20de%20My%20Contacts%20y%20podr√°s%20suscribirte%20si%20te%20interesa.%0D%0A%0D%0ASaludos%20";break;case"en-us":case"en-US":case"en-ca":case"en-CA":case"en-au":case"en-AU":case"en-ie":case"en-IE":case"en-in":case"en-IN":case"en-sg":case"en-SG":case"en-hk":case"en-HK":case"en-my":case"en-MY":case"en-pk":case"en-PK":case"en-ng":case"en-NG":case"en-bd":case"en-BD":case"en-ph":case"en-PH":case"en-tz":case"en-TZ":case"en-za":case"en-ZA":case"en-ke":case"en-KE":case"en-ug":case"en-UG":case"en-gh":case"en-GH":case"en-mw":case"en-MW":case"en-zm":case"en-ZM":case"en-zw":case"en-ZW":case"en-cm":case"en-CM":case"en-lk":case"en-LK":t.href="mailto:?subject=Recommendation%20of%20the%20My%20Contacts%20Cloud%20App&body=Hello%2C%0D%0A%0D%0AI%20recommend%20you%20try%20the%20My%20Contacts%20Cloud%20App.%20It's%20free%20and%20forever.%0D%0A%0D%0ABy%20clicking%20on%20https://mycontacts.cloud%20you%20will%20access%20the%20My%20Contacts%20website%20and%20can%20subscribe%20if%20you%20are%20interested.%0D%0A%0D%0ARegards%20";break;case"it-it":case"it-IT":case"it-ch":case"it-CH":t.href="mailto:?subject=Raccomandazione%20dell'app%20My%20Contacts%20Cloud&body=Ciao%2C%0D%0A%0D%0Aconsiglio%20di%20provare%20l'app%20My%20Contacts%20Cloud.%20√à%20gratuita%20e%20per%20sempre.%0D%0A%0D%0ACliccando%20su%20https://mycontacts.cloud%20potrai%20accedere%20al%20sito%20web%20di%20My%20Contacts%20e%20puoi%20iscriverti%20se%20sei%20interessato.%0D%0A%0D%0ASaluti%20";break;case"pt-pt":case"pt-PT":case"pt-ao":case"pt-AO":case"pt-mz":case"pt-MZ":t.href="mailto:?subject=Recomenda√ß√£o%20da%20App%20My%20Contacts%20Cloud&body=Ol√°%2C%0D%0A%0D%0ARecomendo%20que%20experimente%20a%20App%20My%20Contacts%20Cloud.%20√â%20gratuita%20e%20para%20sempre.%0D%0A%0D%0A Ao%20clicar%20em%20https://mycontacts.cloud%20acessar√°%20o%20website%20do%20My%20Contacts%20e%20poder√°%20subscrever-se%20se%20estiver%20interessado.%0D%0A%0D%0ACumprimentos%20";break;case"pt-br":case"pt-BR":t.href="mailto:?subject=Recomenda√ß√£o%20do%20App%20My%20Contacts%20Cloud&body=Ol√°%2C%0D%0A%0D%0ARecomendo%20que%20experimente%20o%20App%20My%20Contacts%20Cloud.%20√â%20gratuito%20e%20para%20sempre.%0D%0A%0D%0AAo%20clicar%20em%20https://mycontacts.cloud%20acessar√°%20o%20website%20do%20My%20Contacts%20e%20poder√°%20subscrever-se%20se%20estiver%20interessado.%0D%0A%0D%0ACumprimentos%20";break;case"fr-fr":case"fr-FR":case"fr-ca":case"fr-CA":case"fr-be":case"fr-BE":case"fr-ch":case"fr-CH":case"fr-cd":case"fr-CD":case"fr-cm":case"fr-CM":case"fr-mg":case"fr-MG":case"fr-ci":case"fr-CI":case"fr-bf":case"fr-BF":case"fr-ne":case"fr-NE":case"fr-sn":case"fr-SN":case"fr-ml":case"fr-ML":case"fr-bj":case"fr-BJ":case"fr-rw":case"fr-RW":case"fr-td":case"fr-TD":case"fr-gn":case"fr-GN":t.href="mailto:?subject=Recommandation%20de%20l'application%20My%20Contacts%20Cloud&body=Bonjour%2C%0D%0A%0D%0Aje%20vous%20recommande%20d'essayer%20l'application%20My%20Contacts%20Cloud.%20C'est%20gratuit%20et%20pour%20toujours.%0D%0A%0D%0AEn%20cliquant%20sur%20https://mycontacts.cloud%20vous%20acc√©derez%20au%20site%20web%20de%20My%20Contacts%20et%20pourrez%20vous%20abonner%20si%20cela%20vous%20int√©resse.%0D%0A%0D%0ASinc√®res%20salutations%20";break;case"de-de":case"de-DE":case"de-at":case"de-AT":case"de-be":case"de-BE":case"de-ch":case"de-CH":t.href="mailto:?subject=Empfehlung%20der%20My%20Contacts%20Cloud%20App&body=Hallo%2C%0D%0A%0D%0Aich%20empfehle%20Ihnen%2C%20die%20My%20Contacts%20Cloud%20App%20auszuprobieren.%20Sie%20ist%20kostenlos%20und%20f√ºr%20immer.%0D%0A%0D%0AIndem%20Sie%20auf%20https://mycontacts.cloud%20klicken%2C%20gelangen%20Sie%20zur%20My%20Contacts-Website%20und%20k√∂nnen%20sich%20registrieren%2C%20wenn%20Sie%20interessiert%20sind.%0D%0A%0D%0AMit%20freundlichen%20Gr√º√üen%20";break;default:"es"==navigator.language.substring(0,2)?t.href="mailto:?subject=Recomendaci√≥n%20App%20My%20Contacts%20Cloud&body=Hola%2C%0D%0A%0D%0ATe%20recomiendo%20que%20pruebes%20la%20App%20My%20Contacts%20Cloud.%20Es%20gratis%20y%20para%20siempre.%0D%0A%0D%0AAl%20hacer%20clic%20en%20https://mycontacts.cloud%20acceder%C3%A1s%20a%20la%20web%20de%20My%20Contacts%20y%20podr%C3%A1s%20suscribirte%20si%20te%20interesa.%0D%0A%0D%0ASaludos%20":t.href="mailto:?subject=Recommendation%20My%20Contacts%20Cloud%20App&body=Hello%2C%0D%0A%0D%0AI%20recommend%20you%20to%20try%20the%20App%20My%20Contacts%20Cloud.%20It's%20free%20and%20forever.%0D%0A%0D%0ABy%20clicking%20on%20https://mycontacts.cloud%20you%20will%20access%20the%20My%20Contacts%20website%20and%20you%20can%20subscribe%20if%20you%20are%20interested.%0D%0A%0D%0ABest%20regards%20"}}))}function seleccionarIdioma(e,t){var a="",o="";switch(e){case"es-es":case"es-ES":a="es",o=" Espa√±ol (Espa√±a)";break;case"ca-es":case"ca-ES":case"ca":a="es-ct",o=" Catal√°",e="ca-ES";break;case"eu-es":case"eu-ES":a="es-pv",o=" Euskara";break;case"gl-es":case"gl-ES":case"gl-gl":case"gl-GL":a="es-ga",o=" Galego",e="gl-ES";break;case"en-gb":case"en-GB":a="gb",o=" English (Great Britain)";break;case"es-mx":case"es-MX":a="mx",o=" Espa√±ol (M√©xico)";break;case"es-cl":case"es-CL":a="cl",o=" Espa√±ol (Chile)";break;case"es-us":case"es-US":a="us",o=" Espa√±ol (Estados Unidos)";break;case"es-ar":case"es-AR":a="ar",o=" Espa√±ol (Argentina)";break;case"es-co":case"es-CO":a="co",o=" Espa√±ol (Colombia)";break;case"es-pe":case"es-PE":a="pe",o=" Espa√±ol (Per√∫)";break;case"es-uy":case"es-UY":a="uy",o=" Espa√±ol (Uruguay)";break;case"es-ve":case"es-VE":a="ve",o=" Espa√±ol (Venezuela)";break;case"es-gt":case"es-GT":a="gt",o=" Espa√±ol (Guatemala)";break;case"es-ec":case"es-EC":a="ec",o=" Espa√±ol (Ecuador)";break;case"es-bo":case"es-BO":a="bo",o=" Espa√±ol (Bolivia)";break;case"es-cu":case"es-CU":a="cu",o=" Espa√±ol (Cuba)";break;case"es-do":case"es-DO":a="do",o=" Espa√±ol (R. Dominicana)";break;case"es-hn":case"es-HN":a="hn",o=" Espa√±ol (Honduras)";break;case"es-py":case"es-PY":a="py",o=" Espa√±ol (Paraguay)";break;case"es-sv":case"es-SV":a="sv",o=" Espa√±ol (El Salvador)";break;case"es-ni":case"es-NI":a="ni",o=" Espa√±ol (Nicaragua)";break;case"es-pa":case"es-PA":a="pa",o=" Espa√±ol (Panam√°)";break;case"en-us":case"en-US":a="us",o=" English (United States)";break;case"en-ca":case"en-CA":a="ca",o=" English (Canada)";break;case"en-au":case"en-AU":a="au",o=" English (Australia)";break;case"en-nz":case"en-NZ":a="nz",o=" English (New Zealand)";break;case"en-ie":case"en-IE":a="ie",o=" English (Ireland)";break;case"en-in":case"en-IN":a="in",o=" English (India)";break;case"en-sg":case"en-SG":a="sg",o=" English (Singapore)";break;case"en-hk":case"en-HK":a="hk",o=" English (Hong Kong)";break;case"en-my":case"en-MY":a="my",o=" English (Malaysia)";break;case"en-pk":case"en-PK":a="pk",o=" English (Pakistan)";break;case"en-ng":case"en-NG":a="ng",o=" English (Nigeria)";break;case"en-bd":case"en-BD":a="bd",o=" English (Bangladesh)";break;case"en-ph":case"en-PH":a="ph",o=" English (Philippines)";break;case"en-tz":case"en-TZ":a="tz",o=" English (Tanzania)";break;case"en-za":case"en-ZA":a="za",o=" English (South Africa)";break;case"en-ke":case"en-KE":a="ke",o=" English (Kenya)";break;case"en-ug":case"en-UG":a="ug",o=" English (Uganda)";break;case"en-gh":case"en-GH":a="gh",o=" English (Ghana)";break;case"en-mw":case"en-MW":a="mw",o=" English (Malawi)";break;case"en-zm":case"en-ZM":a="zm",o=" English (Zambia)";break;case"en-zw":case"en-ZW":a="zw",o=" English (Zimbabwe)";break;case"en-cm":case"en-CM":a="cm",o=" English (Cameroon)";break;case"en-lk":case"en-LK":a="lk",o=" English (Sri Lanka)";break;case"it-it":case"it-IT":a="it",o=" Italiano (Italia)";break;case"it-ch":case"it-CH":a="ch",o=" Italiano (Svizzera)";break;case"pt-pt":case"pt-PT":a="pt",o=" Portugu√™s (Portugal)";break;case"pt-br":case"pt-BR":a="br",o=" Portugu√™s (Brasil)";break;case"pt-ao":case"pt-AO":a="ao",o=" Portugu√™s (Angola)";break;case"pt-mz":case"pt-MZ":a="mz",o=" Portugu√™s (Mo√ßambique)";break;case"fr-fr":case"fr-FR":a="fr",o=" Fran√ßais (France)";break;case"fr-ca":case"fr-CA":a="ca",o=" Fran√ßais (Canada)";break;case"fr-be":case"fr-BE":a="be",o=" Fran√ßais (Belgique)";break;case"fr-ch":case"fr-CH":a="ch",o=" Fran√ßais (Suisse)";break;case"fr-co":case"fr-CD":a="co",o=" Fran√ßais (R. D. Congo)";break;case"fr-cm":case"fr-CM":a="cm",o=" Fran√ßais (Cameroun)";break;case"fr-mg":case"fr-MG":a="mg",o=" Fran√ßais (Madagascar)";break;case"fr-ci":case"fr-CI":a="ci",o=" Fran√ßais (C√¥te d'Ivoire)";break;case"fr-bf":case"fr-BF":a="bf",o=" Fran√ßais (Burkina Faso)";break;case"fr-ne":case"fr-NE":a="ne",o=" Fran√ßais (Niger)";break;case"fr-sn":case"fr-SN":a="sn",o=" Fran√ßais (S√©n√©gal)";break;case"fr-ml":case"fr-ML":a="ml",o=" Fran√ßais (Mali)";break;case"fr-bj":case"fr-BJ":a="bj",o=" Fran√ßais (B√©nin)";break;case"fr-rw":case"fr-RW":a="rw",o=" Fran√ßais (Rwanda)";break;case"fr-td":case"fr-TD":a="td",o=" Fran√ßais (Tchad)";break;case"fr-gn":case"fr-GN":a="gn",o=" Fran√ßais (Guin√©e)";break;case"de-de":case"de-DE":a="de",o=" Deutsch (Deutschland)";break;case"de-at":case"de-AT":a="at",o=" Deutsch (√ñsterreich)";break;case"de-be":case"de-BE":a="be",o=" Deutsch (Belgien)";break;case"de-ch":case"de-CH":a="ch",o=" Deutsch (Schweiz)";break;default:var n=e.substring(0,2);"it"==n?(a="it",o=" Italiano (Italia)",e="it-IT"):"pt"==n?(a="br",o=" Portugu√™s (Brasil)",e="pt-BR"):"fr"==n?(a="fr",o=" Fran√ßais (France)",e="fr-FR"):"de"==n?(a="de",o=" Deutsch (Deutschland)",e="de-DE"):"es"==n?(a="es",o=" Espa√±ol (Espa√±a)",e="es-ES"):(a="us",o=" English (United States)",e="en-US")}return t&&(document.getElementById("botonIdioma").innerHTML='<svg class="icon"><use xlink:href="#'+a+'"></use></svg> '+o),e}function cambiarPolPri(){var e=0,t=localStorage.getItem("idiomaPais");const a=document.getElementById("modalPoliticaPrivacidad");if(a){a.querySelectorAll("span").forEach((a=>{a.innerHTML=tExpPolPri(e,t),e+=1}))}}function tExpPolPri(e,t){var a=e;if(-1==a)return s;switch(t){case"es-es":case"es-ES":return polPri_es_ES[a];case"ca-es":case"ca-ES":return polPri_ca_ES[a];case"eu-es":case"eu-ES":return polPri_eu_ES[a];case"gl-es":case"gl-ES":return polPri_gl_ES[a];case"en-gb":case"en-GB":return polPri_en_GB[a];case"es-mx":case"es-MX":return polPri_es_MX[a];case"es-cl":case"es-CL":return polPri_es_CL[a];case"es-us":case"es-US":return polPri_es_US[a];case"en-us":case"en-US":default:return polPri_en_US[a];case"en-ca":case"en-CA":return polPri_en_CA[a];case"en-au":case"en-AU":return polPri_en_AU[a];case"it-it":case"it-IT":return polPri_it_IT[a];case"pt-pt":case"pt-PT":return polPri_pt_PT[a];case"pt-br":case"pt-BR":return polPri_pt_BR[a];case"pt-ao":case"pt-AO":return polPri_pt_AO[a];case"pt-mz":case"pt-MZ":return polPri_pt_MZ[a];case"fr-fr":case"fr-FR":return polPri_fr_FR[a];case"fr-ca":case"fr-CA":return polPri_fr_CA[a];case"de-de":case"de-DE":return polPri_de_DE[a];case"es-ar":case"es-AR":return polPri_es_AR[a];case"es-co":case"es-CO":return polPri_es_CO[a];case"es-pe":case"es-PE":return polPri_es_PE[a];case"es-uy":case"es-UY":return polPri_es_UY[a];case"es-ve":case"es-VE":return polPri_es_VE[a];case"es-gt":case"es-GT":return polPri_es_GT[a];case"es-ec":case"es-EC":return polPri_es_EC[a];case"es-bo":case"es-BO":return polPri_es_BO[a];case"es-cu":case"es-CU":return polPri_es_CU[a];case"es-do":case"es-DO":return polPri_es_DO[a];case"es-hn":case"es-HN":return polPri_es_HN[a];case"es-py":case"es-PY":return polPri_es_PY[a];case"es-sv":case"es-SV":return polPri_es_SV[a];case"es-ni":case"es-NI":return polPri_es_NI[a];case"es-pa":case"es-PA":return polPri_es_PA[a];case"en-nz":case"en-NZ":return polPri_en_NZ[a];case"en-ie":case"en-IE":return polPri_en_IE[a];case"en-in":case"en-IN":return polPri_en_IN[a];case"en-sg":case"en-SG":return polPri_en_SG[a];case"en-hk":case"en-HK":return polPri_en_HK[a];case"en-my":case"en-MY":return polPri_en_MY[a];case"en-pk":case"en-PK":return polPri_en_PK[a];case"en-ng":case"en-NG":return polPri_en_NG[a];case"en-bd":case"en-BD":return polPri_en_BD[a];case"en-ph":case"en-PH":return polPri_en_PH[a];case"en-tz":case"en-TZ":return polPri_en_TZ[a];case"en-za":case"en-ZA":return polPri_en_ZA[a];case"en-ke":case"en-KE":return polPri_en_KE[a];case"en-ug":case"en-UG":return polPri_en_UG[a];case"en-gh":case"en-GH":return polPri_en_GH[a];case"en-mw":case"en-MW":return polPri_en_MW[a];case"en-zm":case"en-ZM":return polPri_en_ZM[a];case"en-zw":case"en-ZW":return polPri_en_ZW[a];case"en-cm":case"en-CM":return polPri_en_CM[a];case"en-lk":case"en-LK":return polPri_en_LK[a];case"fr-be":case"fr-BE":case"fr-be":case"fr-BE":return polPri_fr_BE[a];case"fr-ch":case"fr-CH":case"fr-ch":case"fr-CH":return polPri_fr_CH[a];case"fr-cd":case"fr-CD":return polPri_fr_CD[a];case"fr-cm":case"fr-CM":return polPri_fr_CM[a];case"fr-mg":case"fr-MG":return polPri_fr_MG[a];case"fr-ci":case"fr-CI":return polPri_fr_CI[a];case"fr-bf":case"fr-BF":return polPri_fr_BF[a];case"fr-ne":case"fr-NE":return polPri_fr_NE[a];case"fr-sn":case"fr-SN":return polPri_fr_SN[a];case"fr-ml":case"fr-ML":return polPri_fr_ML[a];case"fr-bj":case"fr-BJ":return polPri_fr_BJ[a];case"fr-rw":case"fr-RW":return polPri_fr_RW[a];case"fr-td":case"fr-TD":return polPri_fr_TD[a];case"fr-gn":case"fr-GN":return polPri_fr_GN[a];case"it-ch":case"it-CH":return polPri_it_CH[a];case"de-at":case"de-AT":return polPri_de_AT[a];case"de-be":case"de-BE":return polPri_de_BE[a];case"de-ch":case"de-CH":return polPri_de_CH[a]}}function cambiarTerCon(){var e=localStorage.getItem("idiomaPais"),t=0;const a=document.getElementById("modalCondicionesUso");if(a){a.querySelectorAll("span").forEach((a=>{a.innerHTML=tExpTerCon(t,e),t+=1}))}}function tExpTerCon(e,t){var a=e;if(-1==a)return s;switch(t){case"es-es":case"es-ES":return terCon_es_ES[a];case"ca-es":case"ca-ES":return terCon_ca_ES[a];case"eu-es":case"eu-ES":return terCon_eu_ES[a];case"gl-es":case"gl-ES":return terCon_gl_ES[a];case"en-gb":case"en-GB":return terCon_en_GB[a];case"es-mx":case"es-MX":return terCon_es_MX[a];case"es-cl":case"es-CL":return terCon_es_CL[a];case"es-us":case"es-US":return terCon_es_US[a];case"en-us":case"en-US":default:return terCon_en_US[a];case"en-ca":case"en-CA":return terCon_en_CA[a];case"en-au":case"en-AU":return terCon_en_AU[a];case"it-it":case"it-IT":return terCon_it_IT[a];case"pt-pt":case"pt-PT":return terCon_pt_PT[a];case"pt-br":case"pt-BR":return terCon_pt_BR[a];case"pt-ao":case"pt-AO":return terCon_pt_AO[a];case"pt-mz":case"pt-MZ":return terCon_pt_MZ[a];case"fr-fr":case"fr-FR":return terCon_fr_FR[a];case"fr-ca":case"fr-CA":return terCon_fr_CA[a];case"de-de":case"de-DE":return terCon_de_DE[a];case"es-ar":case"es-AR":return terCon_es_AR[a];case"es-co":case"es-CO":return terCon_es_CO[a];case"es-pe":case"es-PE":return terCon_es_PE[a];case"es-uy":case"es-UY":return terCon_es_UY[a];case"es-ve":case"es-VE":return terCon_es_VE[a];case"es-gt":case"es-GT":return terCon_es_GT[a];case"es-ec":case"es-EC":return terCon_es_EC[a];case"es-bo":case"es-BO":return terCon_es_BO[a];case"es-cu":case"es-CU":return terCon_es_CU[a];case"es-do":case"es-DO":return terCon_es_DO[a];case"es-hn":case"es-HN":return terCon_es_HN[a];case"es-py":case"es-PY":return terCon_es_PY[a];case"es-sv":case"es-SV":return terCon_es_SV[a];case"es-ni":case"es-NI":return terCon_es_NI[a];case"es-pa":case"es-PA":return terCon_es_PA[a];case"en-nz":case"en-NZ":return terCon_en_NZ[a];case"en-ie":case"en-IE":return terCon_en_IE[a];case"en-in":case"en-IN":return terCon_en_IN[a];case"en-sg":case"en-SG":return terCon_en_SG[a];case"en-hk":case"en-HK":return terCon_en_HK[a];case"en-my":case"en-MY":return terCon_en_MY[a];case"en-pk":case"en-PK":return terCon_en_PK[a];case"en-ng":case"en-NG":return terCon_en_NG[a];case"en-bd":case"en-BD":return terCon_en_BD[a];case"en-ph":case"en-PH":return terCon_en_PH[a];case"en-tz":case"en-TZ":return terCon_en_TZ[a];case"en-za":case"en-ZA":return terCon_en_ZA[a];case"en-ke":case"en-KE":return terCon_en_KE[a];case"en-ug":case"en-UG":return terCon_en_UG[a];case"en-gh":case"en-GH":return terCon_en_GH[a];case"en-mw":case"en-MW":return terCon_en_MW[a];case"en-zm":case"en-ZM":return terCon_en_ZM[a];case"en-zw":case"en-ZW":return terCon_en_ZW[a];case"en-cm":case"en-CM":return terCon_en_CM[a];case"en-lk":case"en-LK":return terCon_en_LK[a];case"fr-be":case"fr-BE":case"fr-be":case"fr-BE":return terCon_fr_BE[a];case"fr-ch":case"fr-CH":case"fr-ch":case"fr-CH":return terCon_fr_CH[a];case"fr-cd":case"fr-CD":return terCon_fr_CD[a];case"fr-cm":case"fr-CM":return terCon_fr_CM[a];case"fr-mg":case"fr-MG":return terCon_fr_MG[a];case"fr-ci":case"fr-CI":return terCon_fr_CI[a];case"fr-bf":case"fr-BF":return terCon_fr_BF[a];case"fr-ne":case"fr-NE":return terCon_fr_NE[a];case"fr-sn":case"fr-SN":return terCon_fr_SN[a];case"fr-ml":case"fr-ML":return terCon_fr_ML[a];case"fr-bj":case"fr-BJ":return terCon_fr_BJ[a];case"fr-rw":case"fr-RW":return terCon_fr_RW[a];case"fr-td":case"fr-TD":return terCon_fr_TD[a];case"fr-gn":case"fr-GN":return terCon_fr_GN[a];case"it-ch":case"it-CH":return terCon_it_CH[a];case"de-at":case"de-AT":return terCon_de_AT[a];case"de-be":case"de-BE":return terCon_de_BE[a];case"de-ch":case"de-CH":return terCon_de_CH[a]}}function localeTable(e){switch(e){case"es-es":case"es-ES":case"es-us":case"es-US":case"gl-es":case"gl-ES":return"es-ES";case"ca-es":case"ca-ES":return"ca-ES";case"eu-es":case"eu-ES":return"eu-EU";case"es-mx":case"es-MX":return"es-MX";case"es-cl":case"es-CL":case"es-co":case"es-CO":case"es-pe":case"es-PE":case"es-uy":case"es-UY":case"es-ve":case"es-VE":case"es-gt":case"es-GT":case"es-ec":case"es-EC":case"es-bo":case"es-BO":case"es-cu":case"es-CU":case"es-do":case"es-DO":case"es-hn":case"es-HN":case"es-py":case"es-PY":case"es-sv":case"es-SV":case"es-ni":case"es-NI":case"es-pa":case"es-PA":return"es-CL";case"es-ar":case"es-AR":return"es-AR";case"en-us":case"en-US":case"en-gb":case"en-GB":case"en-ca":case"en-CA":case"en-au":case"en-AU":case"en-nz":case"en-NZ":case"en-ie":case"en-IE":case"en-in":case"en-IN":case"en-sg":case"en-SG":case"en-hk":case"en-HK":case"en-my":case"en-MY":case"en-pk":case"en-PK":case"en-ng":case"en-NG":case"en-bd":case"en-BD":case"en-ph":case"en-PH":case"en-tz":case"en-TZ":case"en-za":case"en-ZA":case"en-ke":case"en-KE":case"en-ug":case"en-UG":case"en-gh":case"en-GH":case"en-mw":case"en-MW":case"en-zm":case"en-ZM":case"en-zw":case"en-ZW":case"en-cm":case"en-CM":case"en-lk":case"en-LK":default:return"en-US";case"it-it":case"it-IT":case"it-ch":case"it-CH":return"it-IT";case"pt-pt":case"pt-PT":return"pt-PT";case"pt-br":case"pt-BR":case"pt-ao":case"pt-AO":case"pt-mz":case"pt-MZ":return"pt-BR";case"fr-fr":case"fr-FR":case"fr-ca":case"fr-CA":case"fr-cd":case"fr-CD":case"fr-cm":case"fr-CM":case"fr-mg":case"fr-MG":case"fr-ci":case"fr-CI":case"fr-bf":case"fr-BF":case"fr-ne":case"fr-NE":case"fr-sn":case"fr-SN":case"fr-ml":case"fr-ML":case"fr-bj":case"fr-BJ":case"fr-rw":case"fr-RW":case"fr-td":case"fr-TD":case"fr-gn":case"fr-GN":return"fr-FR";case"fr-be":case"fr-BE":return"fr-BE";case"fr-ch":case"fr-CH":return"fr-CH";case"de-de":case"de-DE":case"de-at":case"de-AT":case"de-be":case"de-BE":case"de-ch":case"de-CH":return"de-DE"}}function localeEvent(e){switch(e){case"es-es":case"es-ES":case"es-mx":case"es-MX":case"es-cl":case"es-CL":case"es-ar":case"es-AR":case"es-co":case"es-CO":case"es-pe":case"es-PE":case"es-uy":case"es-UY":case"es-ve":case"es-VE":case"es-gt":case"es-GT":case"es-ec":case"es-EC":case"es-bo":case"es-BO":case"es-cu":case"es-CU":case"es-do":case"es-DO":case"es-hn":case"es-HN":case"es-py":case"es-PY":case"es-sv":case"es-SV":case"es-ni":case"es-NI":case"es-pa":case"es-PA":return"es";case"es-us":case"es-US":return"es-us";case"gl-es":case"gl-ES":return"gl";case"ca-es":case"ca-ES":return"ca";case"eu-es":case"eu-ES":return"eu";case"en-us":case"en-US":case"en-gb":case"en-GB":case"en-ca":case"en-CA":case"en-ie":case"en-IE":case"en-in":case"en-IN":case"en-sg":case"en-SG":case"en-hk":case"en-HK":case"en-my":case"en-MY":case"en-pk":case"en-PK":case"en-ng":case"en-NG":case"en-bd":case"en-BD":case"en-ph":case"en-PH":case"en-tz":case"en-TZ":case"en-za":case"en-ZA":case"en-ke":case"en-KE":case"en-ug":case"en-UG":case"en-gh":case"en-GH":case"en-mw":case"en-MW":case"en-zm":case"en-ZM":case"en-zw":case"en-ZW":case"en-cm":case"en-CM":case"en-lk":case"en-LK":default:return"en-gb";case"en-au":case"en-AU":return"en-au";case"en-nz":case"en-NZ":return"en-nz";case"it-it":case"it-IT":case"it-ch":case"it-CH":return"it";case"pt-pt":case"pt-PT":return"pt";case"pt-br":case"pt-BR":case"pt-ao":case"pt-AO":case"pt-mz":case"pt-MZ":return"pt-br";case"fr-fr":case"fr-FR":case"fr-be":case"fr-BE":case"fr-cd":case"fr-CD":case"fr-cm":case"fr-CM":case"fr-mg":case"fr-MG":case"fr-ci":case"fr-CI":case"fr-bf":case"fr-BF":case"fr-ne":case"fr-NE":case"fr-sn":case"fr-SN":case"fr-ml":case"fr-ML":case"fr-bj":case"fr-BJ":case"fr-rw":case"fr-RW":case"fr-td":case"fr-TD":case"fr-gn":case"fr-GN":return"fr";case"fr-ca":case"fr-CA":return"fr-ca";case"fr-ch":case"fr-CH":return"fr-ch";case"de-de":case"de-DE":case"de-be":case"de-BE":case"de-ch":case"de-CH":return"de";case"de-at":case"de-AT":return"de-at"}}function nuevaSesionStripe(e,t){(async function(){var a=new FormData;a.append("corElec",localStorage.getItem("correoElec")),a.append("idiPais",localStorage.getItem("idiomaPais")),a.append("precio",e),a.append("cancelado",t);const o=await fetch("https://"+window.location.host+"/sesionStripe",{method:"POST",body:a});return await o.json()})().then((e=>{e.success?(localStorage.setItem("idSesionStripe",e.data.value1),location.assign(e.data.value2)):alert(e.message)})).catch((e=>{alert(e.message)}))}function cambiarPlanEnStripe(e){(async function(){var t=new FormData;t.append("corElec",localStorage.getItem("correoElec")),t.append("precio",e);const a=await fetch("https://"+window.location.host+"/cambioEnSuscripcionPrueba",{method:"POST",body:t});return await a.json()})().then((e=>{e.success?(localStorage.setItem("usuarios",e.data.value3),localStorage.setItem("plan",e.data.value4),txtPrueba5.innerText="PRO "+e.data.value4,toastMsj(txtPlanCambiado(),msjPlanes,1500,4,1)):alert(e.message)})).catch((e=>{alert(e.message)}))}function nuevaSuscripcionStripe(){(async function(){var e=new FormData;e.append("idSesion",localStorage.getItem("idSesionStripe")),e.append("corElec",localStorage.getItem("correoElec"));const t=await fetch("https://"+window.location.host+"/suscripcionStripe",{method:"POST",body:e});return await t.json()})().then((e=>{e.success?(localStorage.setItem("usuarios",e.data.value3),localStorage.setItem("plan",e.data.value4),localStorage.setItem("estadoSuscripcion",e.data.value5),localStorage.setItem("diasPruebaRestantes",e.data.value6),localStorage.setItem("pruebaCancelada",e.data.value7),libIdioma(localStorage.getItem("idiomaPais"),10)):alert(e.message)})).catch((e=>{alert(e.message)}))}function abrirPortalStripe(){(async function(){var e=new FormData;e.append("corElec",localStorage.getItem("correoElec")),e.append("idiPais",localStorage.getItem("idiomaPais"));const t=await fetch("https://"+window.location.host+"/portalStripe",{method:"POST",body:e});return await t.json()})().then((e=>{e.success?location.assign(e.data.value1):alert(e.message)})).catch((e=>{alert(e.message)}))}function crearEstilo(e,t,a,o){const n=document.createElement("style"),s="\n\t  @media (min-width: 993px) {\n\t    #"+e+":after  { content: '  "+a+"';}\n\t    #"+t+":after { content: '  "+o+"';}\n\t  }\n\t";n.innerHTML=s,document.head.appendChild(n)}function nueContra(){if(confirm(tExp("¬øRecibir nueva contrase√±a por correo electr√≥nico?",""))){(async function(){var e=new FormData;e.append("nom",localStorage.getItem("nombre")),e.append("cor",localStorage.getItem("correoElec")),e.append("prefijo",localStorage.getItem("prefijo")),e.append("idiomaPais",localStorage.getItem("idiomaPais"));const t=await fetch("https://"+window.location.host+"/nuevaContrasena",{method:"POST",body:e});return await t.json()})().then((e=>{e.success?alert(tExp("Nueva contrase√±a enviada. Si se trata de una cuenta Gmail, posiblemente est√© en Promociones. Revisa la carpeta Spam si no encuentra el mensaje.","")):alert(e.message)})).catch((e=>{alert(e.message)}))}}function isValidEmail(e){return/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,9}$/.test(e)}function listaNomParticipantesEvento(){return""}function validarIniSesion(e,t,a,o,n){var s=crypto.randomUUID();let c=new FormData;c.append("tipo",e),c.append("idUs",t),c.append("nomUs",a),c.append("corElecUs",o),c.append("contrasena",n),c.append("uid",s),c.append("idiomaPais",localStorage.getItem("idiomaPais")),async function(){const e=await fetch("https://"+window.location.host+"/iniSesion",{method:"POST",body:c});return await e.json()}().then((a=>{if(a.success){localStorage.setItem("prefijo",a.data.value1),localStorage.setItem("nombre",a.data.value2),localStorage.setItem("usuarios",a.data.value3),localStorage.setItem("idiomaPais",a.data.value4),localStorage.setItem("maxRegFree",a.data.value5),localStorage.setItem("plan",a.data.value6),localStorage.setItem("nomRef1",a.data.nomRef1),localStorage.setItem("nomRef2",a.data.nomRef2),localStorage.setItem("nomRef3",a.data.nomRef3),localStorage.setItem("nomRef4",a.data.nomRef4),localStorage.setItem("titPref1",a.data.titPref1),localStorage.setItem("titPref2",a.data.titPref2),localStorage.setItem("titPref3",a.data.titPref3),localStorage.setItem("titPref4",a.data.titPref4),localStorage.setItem("titPref5",a.data.titPref5),localStorage.setItem("titPref6",a.data.titPref6),localStorage.setItem("nomGrupo1",a.data.nomGrupo1),localStorage.setItem("nomGrupo2",a.data.nomGrupo2),localStorage.setItem("nomGrupo3",a.data.nomGrupo3),localStorage.setItem("weekends",a.data.weekends),localStorage.setItem("slotMinTime",a.data.slotMinTime),localStorage.setItem("slotMaxTime",a.data.slotMaxTime),localStorage.setItem("slotDuration",a.data.slotDuration),localStorage.setItem("totRegContactos",a.data.totRegContactos),localStorage.setItem("usuarioMensaje",a.data.usuarioMensaje);a.data.estado;localStorage.setItem("estadoSuscripcion",a.data.estado),localStorage.setItem("pruebaCancelada",a.data.pruebaCancelada),localStorage.setItem("diasPruebaRestantes",a.data.diasPrueba),localStorage.setItem("correoElec",o),localStorage.setItem("tipoSesion",e),localStorage.setItem("idSesion",t),localStorage.setItem("procValida",!0),localStorage.setItem("permisosGrupo","111111"),localStorage.setItem("uid",s),localStorage.setItem("divAnt",""),localStorage.setItem("divNue","menu"),null===localStorage.getItem("clienteCorreo")&&localStorage.setItem("clienteCorreo",e),location.replace("https://mycontacts.cloud/app/principal.html")}else if("dirCorElecDesconocido"==a.message){new bootstrap.Modal(formNueCor).show()}else"Contrase√±a incorrecta"==a.message?modal1("My Contacts Cloud",txtContrasenaIncorrecta(),msjIndex):modal1("My Contacts Cloud",tExp(a.message,""),msjIndex)})).catch((e=>{modal1("My Contacts Cloud",e.message,msjIndex)}))}function esDispositivoiOS(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}function esIOSoMacSafari(){const e=navigator.platform.toLowerCase(),t=navigator.userAgent.toLowerCase();return(e.includes("mac")||e.includes("ipad")||e.includes("iphone"))&&t.includes("safari")&&!t.includes("chrome")}function pantallaCompletaIOS(){if(/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream){const e=document.documentElement;e.webkitEnterFullscreen&&e.webkitEnterFullscreen()}else document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.webkitRequestFullscreen?document.documentElement.webkitRequestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.msRequestFullscreen&&document.documentElement.msRequestFullscreen()}function mostrarModal(e,t){var a=document.getElementById("confirmModal");a&&a.remove();var o='\n        <div class="modal fade" id="confirmModal" tabindex="-1" aria-labelledby="confirmModalLabel" aria-hidden="true">\n            <div class="modal-dialog">\n                <div class="modal-content">\n                    <div class="modal-header">\n                        <h5 class="modal-title" id="confirmModalLabel">'+tExp("Confirmar","")+`</h5>\n                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                    </div>\n                    <div class="modal-body">\n                        ${e}\n                    </div>\n                    <div class="modal-footer">\n                        <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">`+tExp("No","")+'</button>\n                        <button type="button" class="btn btn-success" data-bs-dismiss="modal" id="modalYesButton">'+tExp("S√≠","")+"</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    ";document.body.insertAdjacentHTML("beforeend",o),document.getElementById("modalYesButton").addEventListener("click",(function(){t()})),new bootstrap.Modal(document.getElementById("confirmModal")).show()}function fecFormato(e,t){return formatoFecha(e)}function corFormato(e,t){return corFormatNew(e)}function webFormato(e,t){return webFormatNew(e)}function telFormato(e,t){return telFormaNew(e)}function mapFormato(e,t){return mapFormat(t.dom,t.cpo,t.pob,t.pro,t.pai)}function comFormato(e,t){return comFormat(t.per,t.te1,t.te2,t.cor,t.www,t.lin,t.tel,t.ins,t.mes,t.xxx,t.dom,t.cpo,t.pob,t.pro,t.pai,t.ccn,1)}function rolFormato(e,t){return tExp(aRol[e-1],"")}function enlaceFormato(e,t){return'<a href="#" class="text-decoration-none" onClick="gesDocContenido('+t.id+')">'+e+"</a>"}function visFormato(e,t){return'<a href="javascript:void(0);" class="text-decoration-none" onclick="visorContenido(event, '+t.id+", '"+t.nom+'\')"><i class="bi bi-tv"></i></a>'}function editDoc(e,t){var a=obtenerExtensionArchivo(t.nom);return"docx"==a||"xlsx"==a||"pptx"==a||"doc"==a||"xls"==a||"ppt"==a||"odt"==a||"ods"==a||"odp"==a?'<a href="#" class="text-decoration-none" onClick="setTimeout(() => regTabla(\'modalDocumento\', \'opcionDocumento\', 2), 500)"><i class="bi bi-pencil"></i></a>':""}function linkedinFormato(e,t){return linkedinFormat(e)}function telegramFormato(e,t){return telegramFormat(e)}function instagramFormato(e,t){return instagramFormat(e)}function messengerFormato(e,t){return messengerFormat(e)}function xFormato(e,t){return xFormat(e)}function elementoGrupoFormato(e,t){return elementoGrupoFormat(e)}function etiFormato(e,t){return etiFormat(t.et1,t.et2,t.et3)}function etiFormatoUno(e,t){let a=dataEtiquetas.find((t=>t.num==e));return a?a.des:""}function fecHorFormato(e,t){return formatoFechaHoraInternacional(e)}function tipoInteraccionFormato(e,t){return tExp(aTipoInteraccion[e-1],"")}function etapaInteraccionFormato(e,t){return tExp(aEtapaInteraccion[e-1],"")}function resultadoInteraccionFormato(e,t){return tExp(aResultadoInteraccion[e-1],"")}function pendienteInteraccionFormato(e,t){return tExp(aAccionInteraccion[e-1],"")}function comFormatoRecordatorio(e,t){return comFormat(t.perr,t.te1r,t.te2r,t.corr,t.wwwr,t.linr,t.telr,t.insr,t.mesr,t.xxxr,t.domr,t.cpor,t.pobr,t.pror,t.pair,t.idcr,2)}function detailFormatterTabContactos(e,t){var a=localStorage.getItem("idiomaPais"),o=[],n=[],s=0,c=" "+mapFormat(t.dom,t.cpo,t.pob,t.pro,t.pai),r=etiFormat(t.et1,t.et2,t.et3);if($.each(t,(function(e,t){if("ccn"!=e&&t&&""!=t){let r="",i="",l="";"cod"==e&&(r=tExp("C√≥digo",a),i=t,l=t),"per"==e&&(r=tExp("Nombre",a),i=t,l=t),"alt"==e&&(r=tExp("Alta",a),i=formatoFecha(t),l=formatoFecha(t)),"dom"==e&&(r=tExp("Direcci√≥n",a),i=t,l=t,0==s&&(i+=c,s=1)),"cpo"==e&&(r=tExp("C. P.",a),i=t,l=t,0==s&&(i+=c,s=1)),"pob"==e&&(r=tExp("Poblaci√≥n",a),i=t,l=t,0==s&&(i+=c,s=1)),"pro"==e&&(r=tExp("Provincia",a),i=t,l=t,0==s&&(i+=c,s=1)),"pai"==e&&(r=tExp("Pa√≠s",a),i=t,l=t,0==s&&(i+=c,s=1)),"te1"==e&&(r=tExp("Telef√≥no 1",a),i=telFormaNew1(t),l=t),"te2"==e&&(r=tExp("Tel√©fono 2",a),i=telFormaNew1(t),l=t),"cor"==e&&(r=tExp("E-mail",a),i=corFormatNew(t),l=t),"www"==e&&(r=tExp("Web",a),i=webFormatNew(t),l=t),"nif"==e&&(r=tExp("NIF",a),i=t,l=t),"car"==e&&(r=tExp("Cargo",a),i=t,l=t),"dep"==e&&(r=tExp("Departamento",a),i=t,l=t),"rol"==e&&(r=tExp("Rol",a),i=tExp(aRol[t-1],a),l=tExp(aRol[t-1],a)),"ani"==e&&(r=tExp("Aniversario",a),i=formatoFecha(t),l=formatoFecha(t)),"nom"==e&&(r=tExp("Empresa",a),i=t,l=t),"sec"==e&&(r=tExp("Sector",a),i=t,l=t),"dun"==e&&(r="DUNS",i=t,l=t),"eg1"==e&&sumEleGrupo1>1&&(r=localStorage.getItem("nomGrupo1"),i=elementoGrupoFormat(t),l=elementoGrupoFormat(t)),"eg2"==e&&sumEleGrupo2>1&&(r=localStorage.getItem("nomGrupo2"),i=elementoGrupoFormat(t),l=elementoGrupoFormat(t)),"eg3"==e&&sumEleGrupo3>1&&(r=localStorage.getItem("nomGrupo3"),i=elementoGrupoFormat(t),l=elementoGrupoFormat(t)),"lin"==e&&(r="LinkedIn",i=linkedinFormat(t),l=t),"tel"==e&&(r="Telegram",i=telegramFormat(t),l=t),"ins"==e&&(r="Instagram",i=instagramFormat(t),l=t),"mes"==e&&(r="Messenger",i=messengerFormat(t),l=t),"xxx"==e&&(r="X",i=xFormat(t),l=t),"rf1"==e&&(r=localStorage.getItem("nomRef1")||tExp("Referencia 1",a),i=t,l=t),"rf2"==e&&(r=localStorage.getItem("nomRef2")||tExp("Referencia 2",a),i=t,l=t),"rf3"==e&&(r=localStorage.getItem("nomRef3")||tExp("Referencia 3",a),i=t,l=t),"rf4"==e&&(r=localStorage.getItem("nomRef4")||tExp("Referencia 4",a),i=t,l=t),"fin"==e&&(r=tExp("Inicio",a),i=formatoFecha(t),l=formatoFecha(t)),"ffi"==e&&(r=tExp("Fin",a),i=formatoFecha(t),l=formatoFecha(t)),"pr1"==e&&(r=localStorage.getItem("titPref1")||tExp("Preferencias 1",a),i=t,l=t),"pr2"==e&&(r=localStorage.getItem("titPref2")||tExp("Preferencias 2",a),i=t,l=t),"pr3"==e&&(r=localStorage.getItem("titPref3")||tExp("Preferencias 3",a),i=t,l=t),"pr4"==e&&(r=localStorage.getItem("titPref4")||tExp("Preferencias 4",a),i=t,l=t),"pr5"==e&&(r=localStorage.getItem("titPref5")||tExp("Preferencias 5",a),i=t,l=t),"pr6"==e&&(r=localStorage.getItem("titPref6")||tExp("Preferencias 6",a),i=t,l=t),"noa"==e&&(r=tExp("Notas",a),i=t,l=t),i&&""!=i&&(o.push("<div><b>"+r+":</b> "+i+"</div>"),n.push("<div><b>"+r+":</b> "+l+"</div>"))}else;})),o.push(r),n.push(r),""==document.getElementById("gesdGrupo_contactos").style.display){let e=btoa(unescape(encodeURIComponent(n.join(""))));o.push("<div><button class=\"btn btn-sm btn-outline-dark mt-1 me-2\" \tonClick=\"selRowTab('tabContactos', 'success', 'idTabContactos', "+t.ccn+"); nombrePersonaContacto = '"+t.per+"'; cambioDiv('contactos', 'interacciones', 1, 0);\"><i class=\"bi bi-journals\"></i><span style=\"font-size: 0.875rem;\"> "+tExp("interacciones","")+"</span></button>"),o.push("<button class=\"btn btn-sm btn-outline-dark mt-1 me-2\" \t\tonClick=\"selRowTab('tabContactos', 'success', 'idTabContactos', "+t.ccn+"); nombrePersonaContacto = '"+t.per+"'; localStorage.setItem('tfGesDoc', 85); localStorage.setItem('numGesDoc', "+t.ccn+'); cambioDiv(\'contactos\', \'documentos\', 1, 0);"><i class="bi bi-folder-symlink"></i><span style="font-size: 0.875rem;"> '+tExp("documentos","")+"</span></button>"),o.push("<button class=\"btn btn-sm btn-outline-dark mt-1 me-4\" \t\tonClick=\"selRowTab('tabContactos', 'success', 'idTabContactos', "+t.ccn+"); nombrePersonaContacto = '"+t.per+"'; localStorage.setItem('vistaIni', 'listYear'); localStorage.setItem('codContactoNlistadoEventos', "+t.ccn+'); setTimeout(function() { cambioDiv(\'contactos\', \'eventos\', 1, 0);  }, 500);"><i class="bi bi-calendar2-check"></i><span style="font-size: 0.875rem;"> '+tExp("eventos","")+"</span></button>"),o.push("<button class=\"btn btn-sm btn-outline-dark mt-1 me-4\" \t\tonClick=\"selRowTab('tabContactos', 'success', 'idTabContactos', "+t.ccn+"); nombrePersonaContacto = '"+t.per+"'; regTabla('modalContacto', 'opcionContacto', 2)\"><i class=\"bi bi-person-lines-fill\"></i><span style=\"font-size: 0.875rem;\"></span></button>"),o.push('<button class="btn btn-sm btn-outline-dark mt-1 me-2" \t\tonClick="generateDOC(\''+e+"',  '"+t.per+"', '"+t.cod+'\')"><i class="bi bi-file-earmark-word"></i><span style="font-size: 0.875rem;"></span></button>'),o.push('<button class="btn btn-sm btn-outline-dark mt-1 me-2" \t\tonClick="generatePDF(\''+e+"',  '"+t.per+"', '"+t.cod+'\')"><i class="bi bi-file-earmark-pdf"></i><span style="font-size: 0.875rem;"></span></button>'),o.push('<button class="btn btn-sm btn-outline-dark mt-1" \t\t\tonClick="printContent(\''+e+"',  '"+t.per+"', '"+t.cod+'\')"><i class="bi bi-printer"></i><span style="font-size: 0.875rem;"></span></button></div>')}return o.join("")}function eliminarContacto(){if(filaNoSeleccionada("tabContactos","success",msjModContacto))return!1;var e=new FormData;return e.append("nform","contactos"),e.append("codnum",window.idTabContactos),e.append("opcionlistado",3),e.append("prefijo",localStorage.getItem("prefijo")),async function(){const t=await fetch("https://"+window.location.host+"/compAntesEditarEliminar",{method:"POST",body:e});return await t.json()}().then((e=>{if(e.success){if(!dEstSuscrip())return!1;new bootstrap.Modal(document.getElementById("formEliminarContacto")).show(),codE_contactos.defaultValue=e.data.codE,nomE_contactos.defaultValue=e.data.nomE}else modMsj("contactos001","My Contacts Cloud",tExp(e.message,""),msjContactos,!0)})).catch((e=>{modMsj("contactos002","My Contacts Cloud",e.message,msjContactos,!0)})),!1}function eliminarInteraccion(){if(filaNoSeleccionada("tabInteracciones","success3",msjModInteraccion))return!1;if(!dEstSuscrip())return!1;var e=new FormData;return e.append("nform","interacciones"),e.append("codnum",window.idTabInteracciones),e.append("opcionlistado",3),e.append("prefijo",localStorage.getItem("prefijo")),async function(){const t=await fetch("https://"+window.location.host+"/compAntesEditarEliminar",{method:"POST",body:e});return await t.json()}().then((e=>{if(e.success){new bootstrap.Modal(document.getElementById("formEliminarInteraccion")).show(),fhiiE_interacciones.defaultValue=e.data.fhiiE,asuiE_interacciones.defaultValue=e.data.asuiE}else modMsj("interacciones001","My Contacts Cloud",tExp(e.message,""),msjInteracciones,!0)})).catch((e=>{modMsj("interacciones002","My Contacts Cloud",e.message,msjInteracciones,!0)})),!1}function cambioDiv(e,t,a,o){if(localStorage.setItem("divAnt",e),localStorage.setItem("divNue",t),""!=e)if("menu"==e)myModalMenu.hide();else if("confcontactos"==e)myModalConfContactos.hide();else if("confeventos"==e)myModalConfEventos.hide();else if("cambiaridioma"==e)myModalIdioma.hide();else if("cambiarcontrasena"==e)myModalContrasena.hide();else if("importarexcel"==e)myModalImportarExcel.hide();else if("politicaprivacidad"==e)myModalPoliticaPrivacidad.hide();else if("condicionesuso"==e)mymodalCondicionesUso.hide();else if("consulta"==e)mymodalConsulta.hide();else if("desuscribirse"==e)mymodalDesuscripcion.hide();else{if(desactivarTooltipsDiv(e),"eventos"==e){let e=bootstrap.Modal.getInstance(modalEvento);e&&e.hide()}document.getElementById(e).style.display="none"}if("menu"==t)myModalMenu||(myModalMenu=new bootstrap.Modal(document.getElementById("modalMenu"))),myModalMenu.show();else if("confcontactos"==t)myModalConfContactos||(myModalConfContactos=new bootstrap.Modal(document.getElementById("modalConfContactos"))),myModalConfContactos.show();else if("confeventos"==t)myModalConfEventos||(myModalConfEventos=new bootstrap.Modal(document.getElementById("modalConfEventos"))),myModalConfEventos.show();else if("cambiaridioma"==t)myModalIdioma||(myModalIdioma=new bootstrap.Modal(document.getElementById("modalIdioma"))),myModalIdioma.show();else if("cambiarcontrasena"==t)myModalContrasena||(myModalContrasena=new bootstrap.Modal(document.getElementById("modalContrasena"))),myModalContrasena.show();else if("importarexcel"==t)myModalImportarExcel||(myModalImportarExcel=new bootstrap.Modal(document.getElementById("modalImportarExcel"))),myModalImportarExcel.show();else if("politicaprivacidad"==t)myModalPoliticaPrivacidad||(myModalPoliticaPrivacidad=new bootstrap.Modal(document.getElementById("modalPoliticaPrivacidad"))),myModalPoliticaPrivacidad.show();else if("condicionesuso"==t)mymodalCondicionesUso||(mymodalCondicionesUso=new bootstrap.Modal(document.getElementById("modalCondicionesUso"))),mymodalCondicionesUso.show();else if("consulta"==t)mymodalConsulta||(mymodalConsulta=new bootstrap.Modal(document.getElementById("modalConsulta"))),mymodalConsulta.show();else if("desuscribirse"==t)mymodalDesuscripcion||(mymodalDesuscripcion=new bootstrap.Modal(document.getElementById("modalDesuscripcion"))),mymodalDesuscripcion.show();else if(1==o){if(document.getElementById(t).style.display="",activarTooltipsDiv(t),"eventos"==t){let e=bootstrap.Modal.getInstance(modalEvento);e&&e.show()}}else"documentos"==t||"interacciones"==t||"importargoogle"==t||"importarms"==t||"importarapple"==t?eliminarYImportarHTML(t):document.body.contains(document.getElementById(t))?(document.getElementById(t).style.display="","contactos"==t&&iniciarContactos(),"documentos"==t&&iniciarDocumentos(),"eventos"==t&&iniciarEventos(),"etiquetascontactos"==t&&iniciarEtiquetasContactos(),"gruposcontactos"==t&&iniciarGrupossContactos(),"recordatorios"==t&&iniciarRecordatorios()):importarHTML(t)}async function eliminarYImportarHTML(e){const t=document.getElementById(e);t&&t.parentNode.removeChild(t),await importHTML(e)}async function importarHTML(e){await importHTML(e)}async function importHTML(e){try{const t=await fetch(`https://mycontactscloud.github.io/app/${e}.html`);if(!t.ok)throw new Error("Network response was not ok");const a=await t.text(),o=document.createElement("div");o.id=e,o.innerHTML=a,o.className="claseDiv",document.body.appendChild(o),"contactos"==e?agregarCodigoContactos()&&iniciarContactos():"documentos"==e?agregarCodigoDocumentos()&&iniciarDocumentos():"interacciones"==e?agregarCodigoInteracciones()&&iniciarInteracciones():"eventos"==e?agregarCodigoEventos()&&iniciarEventos():"gruposcontactos"==e?agregarCodigoGruposContactos()&&iniciarGruposContactos():"etiquetascontactos"==e?iniciarEtiquetasContactos():"recordatorios"==e?iniciarRecordatorios():"importargoogle"==e?iniciarImportarGoogle():"importarms"==e?agregrarCodigoImportarms()&&iniciarImportarMs():"importarapple"==e&&iniciarImportarApple()}catch(e){console.error("Error fetching content:",e)}}function iniciarEtiquetasContactos(){setTimeout((function(){libIdioma(localStorage.getItem("idiomaPais"),3)}),100),loadTagsFromServer()}function agregrarCodigoImportarms(){return btnImportarContactosMs.addEventListener("click",(()=>{importarContactosMicrosoft()})),!0}function agregarCodigoContactos(){function e(){document.querySelectorAll("#tagModal .tag-option").forEach((e=>{const t=e.getAttribute("data-num");etiSeleccionadasTmp.includes(parseInt(t))?e.classList.add("etiSelected"):e.classList.remove("etiSelected")}))}return modalContacto.addEventListener("show.bs.modal",(function(e){if(salirModalContacto)return salirModalContacto=!1,!1;if(selectedTagsFichaContacto.innerHTML="",activarTooltipsDiv("modalContacto"),1===window.opcionContacto&&(cod_contactos.focus(),ccn_contactos.defaultValue=0,alt_contactos.defaultValue=(new Date).toISOString().slice(0,10),cod_contactos.defaultValue="",nom_contactos.defaultValue="",nif_contactos.defaultValue="",dom_contactos.defaultValue="",cpo_contactos.defaultValue="",pob_contactos.defaultValue="",pro_contactos.defaultValue="",pai_contactos.defaultValue="",te1_contactos.defaultValue="",te2_contactos.defaultValue="",cor_contactos.defaultValue="",per_contactos.defaultValue="",car_contactos.defaultValue="",dep_contactos.defaultValue="",www_contactos.defaultValue="",noa_contactos.defaultValue="",seleccionarCombo("rol","1"),lin_contactos.defaultValue="",tel_contactos.defaultValue="",mes_contactos.defaultValue="",xxx_contactos.defaultValue="",ins_contactos.defaultValue="",ani_contactos.defaultValue="",dun_contactos.defaultValue="",sec_contactos.defaultValue="",pr1_contactos.defaultValue="",pr2_contactos.defaultValue="",pr3_contactos.defaultValue="",pr4_contactos.defaultValue="",pr5_contactos.defaultValue="",pr6_contactos.defaultValue="",rf1_contactos.defaultValue="",rf2_contactos.defaultValue="",rf3_contactos.defaultValue="",rf4_contactos.defaultValue="",fin_contactos.defaultValue="",ffi_contactos.defaultValue="",seleccionarCombo("eg1_contactos",predGrupoContactos(1)),seleccionarCombo("eg2_contactos",predGrupoContactos(2)),seleccionarCombo("eg3_contactos",predGrupoContactos(3)),camposSummernote(),cod_contactos.readOnly=!1,alt_contactos.readOnly=!1,nom_contactos.readOnly=!1,nif_contactos.readOnly=!1,dom_contactos.readOnly=!1,cpo_contactos.readOnly=!1,pob_contactos.readOnly=!1,pro_contactos.readOnly=!1,pai_contactos.readOnly=!1,te1_contactos.readOnly=!1,te2_contactos.readOnly=!1,cor_contactos.readOnly=!1,per_contactos.readOnly=!1,car_contactos.readOnly=!1,dep_contactos.readOnly=!1,www_contactos.readOnly=!1,noa_contactos.readOnly=!1,rol_contactos.disabled=!1,lin_contactos.readOnly=!1,tel_contactos.readOnly=!1,mes_contactos.readOnly=!1,xxx_contactos.readOnly=!1,ins_contactos.readOnly=!1,ani_contactos.readOnly=!1,dun_contactos.readOnly=!1,sec_contactos.readOnly=!1,pr1_contactos.readOnly=!1,pr2_contactos.readOnly=!1,pr3_contactos.readOnly=!1,pr4_contactos.readOnly=!1,pr5_contactos.readOnly=!1,pr6_contactos.readOnly=!1,rf1_contactos.readOnly=!1,rf2_contactos.readOnly=!1,rf3_contactos.readOnly=!1,rf4_contactos.readOnly=!1,fin_contactos.readOnly=!1,ffi_contactos.readOnly=!1,eg1_contactos.disabled=!1,eg2_contactos.disabled=!1,eg3_contactos.disabled=!1,aceptar_contactos.hidden=!1,cancelar_contactos.hidden=!1,abrirTagModalDesdeFichaContacto.hidden=!1,document.getElementById("formContacto").reset()),2===window.opcionContacto||4===window.opcionContacto){let e=new FormData;e.append("num",22),e.append("donde",window.idTabContactos),e.append("prefijo",localStorage.getItem("prefijo")),async function(){const t=await fetch("https://"+window.location.host+"/selectSimple",{method:"POST",body:e});return await t.json()}().then((e=>{e.success?(ccn_contactos.defaultValue=window.idTabContactos,alt_contactos.defaultValue=e.data.alt.substring(0,10),cod_contactos.defaultValue=e.data.cod,nom_contactos.defaultValue=e.data.nom,nif_contactos.defaultValue=e.data.nif||"",dom_contactos.defaultValue=e.data.dom||"",cpo_contactos.defaultValue=e.data.cpo||"",pob_contactos.defaultValue=e.data.pob||"",pro_contactos.defaultValue=e.data.pro||"",pai_contactos.defaultValue=e.data.pai||"",te1_contactos.defaultValue=e.data.te1||"",te2_contactos.defaultValue=e.data.te2||"",cor_contactos.defaultValue=e.data.cor||"",per_contactos.defaultValue=e.data.per||"",car_contactos.defaultValue=e.data.car||"",dep_contactos.defaultValue=e.data.dep||"",www_contactos.defaultValue=e.data.www||"",noa_contactos.defaultValue=e.data.noa||"",seleccionarCombo("rol",e.data.rol),lin_contactos.defaultValue=e.data.lin||"",tel_contactos.defaultValue=e.data.tel||"",mes_contactos.defaultValue=e.data.mes||"",xxx_contactos.defaultValue=e.data.xxx||"",ins_contactos.defaultValue=e.data.ins||"",ani_contactos.defaultValue=e.data.ani.substring(0,10)||"",dun_contactos.defaultValue=e.data.dun||"",sec_contactos.defaultValue=e.data.sec||"",pr1_contactos.defaultValue=e.data.pr1||"",pr2_contactos.defaultValue=e.data.pr2||"",pr3_contactos.defaultValue=e.data.pr3||"",pr4_contactos.defaultValue=e.data.pr4||"",pr5_contactos.defaultValue=e.data.pr5||"",pr6_contactos.defaultValue=e.data.pr6||"",rf1_contactos.defaultValue=e.data.rf1||"",rf2_contactos.defaultValue=e.data.rf2||"",rf3_contactos.defaultValue=e.data.rf3||"",rf4_contactos.defaultValue=e.data.rf4||"",fin_contactos.defaultValue=e.data.fin.substring(0,10)||"",ffi_contactos.defaultValue=e.data.ffi.substring(0,10)||"",seleccionarCombo("eg1_contactos",e.data.eg1||""),seleccionarCombo("eg2_contactos",e.data.eg2||""),seleccionarCombo("eg3_contactos",e.data.eg3||""),et1Cancelar=e.data.et1,et2Cancelar=e.data.et2,et3Cancelar=e.data.et3,2===window.opcionContacto&&(cod_contactos.readOnly=!0,alt_contactos.readOnly=!1,nom_contactos.readOnly=!1,nif_contactos.readOnly=!1,dom_contactos.readOnly=!1,cpo_contactos.readOnly=!1,pob_contactos.readOnly=!1,pro_contactos.readOnly=!1,pai_contactos.readOnly=!1,te1_contactos.readOnly=!1,te2_contactos.readOnly=!1,cor_contactos.readOnly=!1,per_contactos.readOnly=!1,car_contactos.readOnly=!1,dep_contactos.readOnly=!1,www_contactos.readOnly=!1,noa_contactos.readOnly=!1,rol_contactos.disabled=!1,lin_contactos.readOnly=!1,tel_contactos.readOnly=!1,mes_contactos.readOnly=!1,xxx_contactos.readOnly=!1,ins_contactos.readOnly=!1,ani_contactos.readOnly=!1,dun_contactos.readOnly=!1,sec_contactos.readOnly=!1,pr1_contactos.readOnly=!1,pr2_contactos.readOnly=!1,pr3_contactos.readOnly=!1,pr4_contactos.readOnly=!1,pr5_contactos.readOnly=!1,pr6_contactos.readOnly=!1,rf1_contactos.readOnly=!1,rf2_contactos.readOnly=!1,rf3_contactos.readOnly=!1,rf4_contactos.readOnly=!1,fin_contactos.readOnly=!1,ffi_contactos.readOnly=!1,eg1_contactos.disabled=!1,eg2_contactos.disabled=!1,eg3_contactos.disabled=!1,camposSummernote(),aceptar_contactos.hidden=!1,cancelar_contactos.hidden=!1,abrirTagModalDesdeFichaContacto.hidden=!1),4===window.opcionContacto&&(cod_contactos.readOnly=!0,alt_contactos.readOnly=!0,nom_contactos.readOnly=!0,nif_contactos.readOnly=!0,dom_contactos.readOnly=!0,cpo_contactos.readOnly=!0,pob_contactos.readOnly=!0,pro_contactos.readOnly=!0,pai_contactos.readOnly=!0,te1_contactos.readOnly=!0,te2_contactos.readOnly=!0,cor_contactos.readOnly=!0,per_contactos.readOnly=!0,car_contactos.readOnly=!0,dep_contactos.readOnly=!0,www_contactos.readOnly=!0,noa_contactos.readOnly=!0,rol_contactos.disabled=!0,lin_contactos.readOnly=!0,tel_contactos.readOnly=!0,mes_contactos.readOnly=!0,xxx_contactos.readOnly=!0,ins_contactos.readOnly=!0,ani_contactos.readOnly=!0,dun_contactos.readOnly=!0,sec_contactos.readOnly=!0,pr1_contactos.readOnly=!0,pr2_contactos.readOnly=!0,pr3_contactos.readOnly=!0,pr4_contactos.readOnly=!0,pr5_contactos.readOnly=!0,pr6_contactos.readOnly=!0,rf1_contactos.readOnly=!0,rf2_contactos.readOnly=!0,rf3_contactos.readOnly=!0,rf4_contactos.readOnly=!0,fin_contactos.readOnly=!0,ffi_contactos.readOnly=!0,eg1_contactos.disabled=!0,eg2_contactos.disabled=!0,eg3_contactos.disabled=!0,aceptar_contactos.hidden=!0,cancelar_contactos.hidden=!0,abrirTagModalDesdeFichaContacto.hidden=!0)):toastSelFila(e.message,msjModContacto),document.getElementById("formContacto").reset()})).catch((e=>{alert(e.message),toastSelFila(e.message,msjModContacto)}))}})),modalContacto.addEventListener("hide.bs.modal",(function(e){return document.getElementById("tagModal").classList.contains("show")?(e.preventDefault(),!1):salirModalContacto?(salirModalContacto=!1,!1):void desactivarTooltipsDiv("modalContacto")})),modalContacto.addEventListener("shown.bs.modal",(function(e){1==window.opcionContacto&&per_contactos.focus(),0==$("#tabContactos").bootstrapTable("getData").length?document.getElementById("pruebaRapida").classList.contains("d-none")&&(document.getElementById("pruebaRapida").classList.remove("d-none"),document.getElementById("pruebaRapidaTexto").innerHTML='<i class="bi bi-info-circle-fill fs-3" style="color: #0D6EFD; font-weight: bold;"></i> '+tExp("Haz una prueba r√°pida tecleando nombre, poblaci√≥n, tel√©fono y correo electr√≥nico. Despu√©s de guardarlo, haz clic sobre el bot√≥n ","")+'<i class="bi bi-wifi" style="color: #0d6efd; font-weight: bold;"></i>'):document.getElementById("pruebaRapida").classList.contains("d-none")||document.getElementById("pruebaRapida").classList.add("d-none"),$(".editor").summernote({toolbar:[["fontsize",["fontname","fontsize","color"]],["style",["bold","italic","underline","strikethrough","superscript","subscript","clear"]],["para",["ul","ol","paragraph","height"]],["insert",["table","hr","link","picture","video"]],["misc",["undo","redo"]]],fontNames:["Arial","Arial Black","Comic Sans MS","Courier New"],lineHeights:["0.2","0.3","0.4","0.5","0.6","0.8","1.0","1.2","1.4","1.5","2.0","3.0"]}),$(".note-toolbar").hide(),4!=window.opcionContacto&&$(".editor").on("summernote.focus",(function(){$(".note-toolbar").hide(),$(this).siblings(".note-editor").find(".note-toolbar").show()}))})),modalContacto.addEventListener("hidden.bs.modal",(function(e){$(".editor").each((function(){$(this).summernote("destroy")}))})),modalFiltroContactos.addEventListener("show.bs.modal",(function(){if(1==primeraVezModalGruposContactos){primeraVezModalGruposContactos=!1,modalFiltroContactosLabel.innerText=tExp("Filtrar por grupos y etiquetas",""),txtFiltrar.innerText=tExp("Filtrar",""),txtQuitarFiltro.innerText=tExp("Quitar filtro",""),new SlimSelect({select:"#eg1_filtroGruposContactos",settings:{allowDeselect:!0,placeholderText:"",showSearch:!1,closeOnSelect:!1,contentLocation:document.getElementById("idSelect1"),contentPosition:"fixed"}}),new SlimSelect({select:"#eg2_filtroGruposContactos",settings:{allowDeselect:!0,placeholderText:"",showSearch:!1,closeOnSelect:!1,contentLocation:document.getElementById("idSelect2"),contentPosition:"fixed"}}),new SlimSelect({select:"#eg3_filtroGruposContactos",settings:{allowDeselect:!0,placeholderText:"",showSearch:!1,closeOnSelect:!1,contentLocation:document.getElementById("idSelect3"),contentPosition:"fixed"}}),ng1_filtroGruposContactos.innerText=localStorage.getItem("nomGrupo1"),ng2_filtroGruposContactos.innerText=localStorage.getItem("nomGrupo2"),ng3_filtroGruposContactos.innerText=localStorage.getItem("nomGrupo3");const e=dataGruposContactos.filter((e=>1===e.numGrupo)),t=dataGruposContactos.filter((e=>2===e.numGrupo)),a=dataGruposContactos.filter((e=>3===e.numGrupo));populateSelect("eg1_filtroGruposContactos",e),populateSelect("eg2_filtroGruposContactos",t),populateSelect("eg3_filtroGruposContactos",a)}activarTooltipsDiv("modalFiltroContactos")})),modalFiltroContactos.addEventListener("hide.bs.modal",(function(e){if(document.getElementById("tagModal").classList.contains("show"))return e.preventDefault(),!1;desactivarTooltipsDiv("modalFiltroContactos")})),applyFiltersBtn.addEventListener("click",(function(){$("#tabContactos").bootstrapTable("filterBy",{});let e=$("#tabContactos").bootstrapTable("getData");etiSeleccionadasFiltro.length>0&&(e.forEach((function(e){e.etiquetasOR=etiSeleccionadasFiltro.some((t=>e.et1===t||e.et2===t||e.et3===t))})),$("#tabContactos").bootstrapTable("load",e));let t={};const a=getSelectedValues("eg1_filtroGruposContactos"),o=getSelectedValues("eg2_filtroGruposContactos"),n=getSelectedValues("eg3_filtroGruposContactos");a.length>0&&(t.eg1=a),o.length>0&&(t.eg2=o),n.length>0&&(t.eg3=n),etiSeleccionadasFiltro.length>0&&(t.etiquetasOR=!0),$("#tabContactos").bootstrapTable("filterBy",t),cambiarIconoBotonFiltrado(1);bootstrap.Modal.getInstance(document.getElementById("modalFiltroContactos")).hide()})),clearFiltersBtn.addEventListener("click",(function(){$("#tabContactos").bootstrapTable("filterBy",{}),cambiarIconoBotonFiltrado(2);bootstrap.Modal.getInstance(document.getElementById("modalFiltroContactos")).hide()})),formContacto.onsubmit=async e=>{if(e.preventDefault(),salidaTelefonos)return salidaTelefonos=!1,!1;if(salidaTagModal)return salidaTagModal=!1,!1;if((1===window.opcionContacto||2===window.opcionContacto)&&0!=cor_contactos.value.length&&!isValidEmail(cor_contactos.value))return modal1("My Contacts Cloud",tExp("Correo electr√≥nico no v√°lido",""),msjModContacto),!1;if(!dEstSuscrip())return!1;const t=document.querySelectorAll("#selectedTagsFichaContacto .tag");for(etiSeleccionadasContacto=[],t.forEach((e=>{const t=e.getAttribute("data-num");etiSeleccionadasContacto.push(parseInt(t))}));etiSeleccionadasContacto.length<3;)etiSeleccionadasContacto.push(0);var a={ccn:ccn_contactos.value,cod:cod_contactos.value,nom:nom_contactos.value,nif:nif_contactos.value,dom:dom_contactos.value,cpo:cpo_contactos.value,pob:pob_contactos.value,pro:pro_contactos.value,pai:pai_contactos.value,per:per_contactos.value,te1:te1_contactos.value,te2:te2_contactos.value,cor:cor_contactos.value,car:car_contactos.value,dep:dep_contactos.value,www:www_contactos.value,alt:alt_contactos.value,rol:rol_contactos.value,lin:lin_contactos.value,tel:tel_contactos.value,mes:mes_contactos.value,xxx:xxx_contactos.value,ins:ins_contactos.value,ani:ani_contactos.value,dun:dun_contactos.value,sec:sec_contactos.value,pr1:pr1_contactos.value,pr2:pr2_contactos.value,pr3:pr3_contactos.value,pr4:pr4_contactos.value,pr5:pr5_contactos.value,pr6:pr6_contactos.value,rf1:rf1_contactos.value,rf2:rf2_contactos.value,rf3:rf3_contactos.value,rf4:rf4_contactos.value,fin:fin_contactos.value,ffi:ffi_contactos.value,noa:noa_contactos.value,eg1:eg1_contactos.value,eg2:eg2_contactos.value,eg3:eg3_contactos.value,et1:etiSeleccionadasContacto[0],et2:etiSeleccionadasContacto[1],et3:etiSeleccionadasContacto[2]};(async function(){let e=new FormData(formContacto);e.append("plan",localStorage.getItem("plan")),e.append("prefijo",localStorage.getItem("prefijo")),e.append("maxRegFree",localStorage.getItem("maxRegFree")),e.append("opcionListado",window.opcionContacto),e.append("eg1",eg1_contactos.value||""),e.append("eg2",eg2_contactos.value||""),e.append("eg3",eg3_contactos.value||""),e.append("et1",etiSeleccionadasContacto[0]),e.append("et2",etiSeleccionadasContacto[1]),e.append("et3",etiSeleccionadasContacto[2]);const t=await fetch("https://"+window.location.host+"/fichaContacto",{method:"POST",body:e});return await t.json()})().then((e=>{e.success?(ocultarModal("modalContacto"),"OK"==e.data.value1&&2===window.opcionContacto?($("#tabContactos").bootstrapTable("updateByUniqueId",{id:window.idTabContactos,row:a,replace:!1}),selRowTab("tabContactos","success","idTabContactos",a.ccn)):1===window.opcionContacto&&(a.ccn=e.data.value2,a.cod=e.data.value1,$("#tabContactos").bootstrapTable("append",a),setTimeout((function(){-1!=(indiceFilaTab=obtenerIndicePorId("tabContactos","ccn",e.data.value2))&&irAPaginaConRegistro("tabContactos",indiceFilaTab,"success","idTabContactos",e.data.value2)}),500))):"K1"==e.message?(salirModalContacto=!0,modMsjFinPruebaToast("contactos003","My Contacts Cloud",txtFinPrueba1(),txtFinPrueba2())):"K2"==e.message?(salirModalContacto=!0,modMsj("contactos004","My Contacts Cloud",tExp("Te recomendamos cambiar a un plan PRO superior para poder a√±adir m√°s contactos","")+'.<br><center><button type="button" class="btn btn-success" data-bs-dismiss="modal" onClick="abrirModal1DesdeFicha(2)">'+tExp("Mi suscripci√≥n","")+"</button></center>",msjModContacto,!1)):"KD1"==e.message?(toastSelFila(tExp("C√≥digo duplicado",""),msjModContacto),cod.focus()):toastSelFila(e.message,msjModContacto)})).catch((e=>{toastSelFila(e.message,msjModContacto)}))},formContacto.onreset=e=>{camposSummernote(),selectedTagsFichaContacto.innerHTML="",1!=window.opcionContacto&&(0!=et1Cancelar&&crearEtiqueta(et1Cancelar,selectedTagsFichaContacto),0!=et2Cancelar&&crearEtiqueta(et2Cancelar,selectedTagsFichaContacto),0!=et3Cancelar&&crearEtiqueta(et3Cancelar,selectedTagsFichaContacto))},cor_contactos.addEventListener("blur",(e=>{0!=cor_contactos.value.length&&(isValidEmail(cor_contactos.value)||modal1("My Contacts Cloud",tExp("Correo electr√≥nico no v√°lido",""),msjModContacto))})),SieliminarContacto.addEventListener("click",(e=>{let t=new FormData;t.append("prefijo",localStorage.getItem("prefijo")),t.append("ccn",window.idTabContactos),t.append("opcionListado",3),async function(){const e=await fetch("https://"+window.location.host+"/fichaContacto",{method:"POST",body:t});return await e.json()}().then((e=>{e.success&&"OK"==e.data.value1&&eliminarReg("tabContactos","idTabContactos","ccn","success")})).catch((e=>{alert(e.message)}))})),opcionesTablaSubmenu_contactos.addEventListener("click",(e=>{e.stopPropagation()})),cont6b_contactos.addEventListener("click",(e=>{e.stopPropagation()})),tagModal.addEventListener("show.bs.modal",(function(t){crearEstilo("guardarEtiquetas","cancelarEtiquetas",tExp("Aceptar",""),tExp("Cancelar","")),activarTooltipsDiv("tagModal"),async function(){const t=document.getElementById("tagOptionsContainer");t.innerHTML="",dataEtiquetas.forEach((a=>{const o=document.createElement("div");o.classList.add("tag-option"),o.setAttribute("data-num",a.num),o.textContent=a.des;const n=aColorFondoEvento[a.col-1]||"#000";o.style.backgroundColor=n,o.style.marginRight="8px",o.style.marginBottom="8px",4===a.col?o.style.color="black":o.style.color="white",o.onclick=function(){!function(t){const a=parseInt(t.getAttribute("data-num")),o=(t.innerText,etiSeleccionadasTmp.indexOf(a));if(-1===o){if(etiSeleccionadasTmp.length>=maxTags)return void(document.getElementById("maxLimitMsg").style.display="block");etiSeleccionadasTmp.push(a)}else etiSeleccionadasTmp.splice(o,1);document.getElementById("maxLimitMsg").style.display="none",e()}(o)},t.appendChild(o)}))}(),etiSeleccionadasTmp="modalContacto"==abrirModalTagsDesde?[...etiSeleccionadasContacto]:[...etiSeleccionadasFiltro],e(),salidaTagModal=!0})),tagModal.addEventListener("hide.bs.modal",(function(e){desactivarTooltipsDiv("tagModal")})),tagModal.addEventListener("hidden.bs.modal",(function(e){document.getElementById(abrirModalTagsDesde).classList.remove("modal-open"),document.body.classList.remove("modal-open");const t=document.querySelector(".modal-backdrop");t&&t.classList.remove("modal-backdrop-superior"),document.getElementById("tagModal").classList.remove("modal-superior")})),guardarEtiquetas.addEventListener("click",(function(){if("modalContacto"==abrirModalTagsDesde){etiSeleccionadasContacto=[...etiSeleccionadasTmp],selectedTagsFichaContacto.innerHTML="";for(let e of etiSeleccionadasContacto)crearEtiqueta(e,selectedTagsFichaContacto)}else if("modalFiltroContactos"==abrirModalTagsDesde){etiSeleccionadasFiltro=[...etiSeleccionadasTmp],selectedTagsFiltro.innerHTML="";for(let e of etiSeleccionadasFiltro)crearEtiqueta(e,selectedTagsFiltro)}var e=bootstrap.Modal.getInstance(document.getElementById("tagModal"));e&&e.hide()})),cancelarEtiquetas.addEventListener("click",(function(){"modalContacto"==abrirModalTagsDesde?etiSeleccionadasTmp=[...etiSeleccionadasContacto]:"modalFiltroContactos"==abrirModalTagsDesde&&(etiSeleccionadasTmp=[...etiSeleccionadasFiltro]),e()})),!0}function agregarCodigoInteracciones(){return opcionesTablaSubmenu_interacciones.addEventListener("click",(e=>{e.stopPropagation()})),modalInteraccion.addEventListener("show.bs.modal",(function(e){if(salirModalInteraccion)return salirModalInteraccion=!1,!1;if(activarTooltipsDiv("modalInteraccion"),1===window.opcionInteraccion){let e=new Date;var t=e.getFullYear()+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+("0"+e.getDate()).slice(-2)+"T"+("0"+e.getHours()).slice(-2)+":"+("0"+e.getMinutes()).slice(-2);fhii_interacciones.defaultValue=t,asui_interacciones.defaultValue="",desi_interacciones.defaultValue="",ncli_interacciones.defaultValue="",reci_interacciones.defaultValue=null,seleccionarCombo("tipi","1"),seleccionarCombo("etai","1"),seleccionarCombo("resi","1"),seleccionarCombo("peni","1"),fhii_interacciones.readOnly=!1,asui_interacciones.readOnly=!1,desi_interacciones.readOnly=!1,ncli_interacciones.readOnly=!1,reci_interacciones.readOnly=!1,tipi_interacciones.disabled=!1,etai_interacciones.disabled=!1,resi_interacciones.disabled=!1,peni_interacciones.disabled=!1,aceptar_interacciones.hidden=!1,cancelar_interacciones.hidden=!1,document.getElementById("formInteraccion").reset()}if(2===window.opcionInteraccion||4===window.opcionInteraccion){let e=new FormData;e.append("num",24),e.append("donde",window.idTabInteracciones),e.append("prefijo",localStorage.getItem("prefijo")),async function(){const t=await fetch("https://"+window.location.host+"/selectSimple",{method:"POST",body:e});return await t.json()}().then((e=>{e.success?(idii_interacciones.defaultValue=window.idTabInteracciones,fhii_interacciones.defaultValue=e.data.fhii.substring(0,16)||"",asui_interacciones.defaultValue=e.data.asui||"",desi_interacciones.defaultValue=e.data.desi||"",ncli_interacciones.defaultValue=e.data.ncli||"",reci_interacciones.defaultValue=e.data.reci.substring(0,16)||"",seleccionarCombo("tipi",e.data.tipi),seleccionarCombo("etai",e.data.etai),seleccionarCombo("resi",e.data.resi),seleccionarCombo("peni",e.data.peni),2===window.opcionInteraccion?(fhii_interacciones.readOnly=!1,asui_interacciones.readOnly=!1,desi_interacciones.readOnly=!1,ncli_interacciones.readOnly=!1,reci_interacciones.readOnly=!1,tipi_interacciones.disabled=!1,etai_interacciones.disabled=!1,resi_interacciones.disabled=!1,peni_interacciones.disabled=!1,aceptar_interacciones.hidden=!1,cancelar_interacciones.hidden=!1):4===window.opcionInteraccion&&(fhii_interacciones.readOnly=!0,asui_interacciones.readOnly=!0,desi_interacciones.readOnly=!0,ncli_interacciones.readOnly=!0,reci_interacciones.readOnly=!0,tipi_interacciones.disabled=!0,etai_interacciones.disabled=!0,resi_interacciones.disabled=!0,peni_interacciones.disabled=!0,aceptar_interacciones.hidden=!0,cancelar_interacciones.hidden=!0),document.getElementById("formInteraccion").reset()):toastSelFila(e.message,msjModInteraccion)})).catch((e=>{toastSelFila(e.message,msjModInteraccion)}))}})),modalInteraccion.addEventListener("hide.bs.modal",(function(e){if(salirModalInteraccion)return salirModalInteraccion=!1,!1;desactivarTooltipsDiv("modalInteraccion")})),formInteraccion.onsubmit=async e=>{if(e.preventDefault(),!dEstSuscrip())return!1;let t={idii:idii_interacciones.value,idci:window.idTabContactos,fhii:fhii_interacciones.value,tipi:tipi_interacciones.value,asui:asui_interacciones.value,desi:desi_interacciones.value,ncli:ncli_interacciones.value,etai:etai_interacciones.value,resi:resi_interacciones.value,peni:peni_interacciones.value,reci:reci_interacciones.value};(async function(){let e=new FormData(formInteraccion);e.append("prefijo",localStorage.getItem("prefijo")),e.append("opcionListado",window.opcionInteraccion),e.append("maxRegFree",localStorage.getItem("maxRegFree")),e.append("plan",localStorage.getItem("plan")),e.append("idci",window.idTabContactos);const t=await fetch("https://"+window.location.host+"/fichaInteraccion",{method:"POST",body:e});return await t.json()})().then((e=>{if(e.success)ocultarModal("modalInteraccion"),""==e.data.value1?(t.idii=e.data.value2,$("#tabInteracciones").bootstrapTable("append",t),setTimeout((function(){selRowTab("tabInteracciones","success3","idTabInteracciones",e.data.value2)}),500)):"OK"==e.data.value1&&($("#tabInteracciones").bootstrapTable("updateByUniqueId",{id:window.idTabInteracciones,row:t,replace:!1}),setTimeout((function(){selRowTab("tabInteracciones","success3","idTabInteracciones",t.idii)}),500));else if("K1"==e.message)salirModalInteraccion=!0,modMsj("interacciones001","My Contacts Cloud",tExp("Te recomendamos adquirir un plan PRO para poder a√±adir m√°s interacciones","")+'.<br><center><button type="button" class="btn btn-success" data-bs-dismiss="modal" onClick="abrirModal1DesdeFicha(1)">'+tExp("Ver planes","")+"</button></center>",msjModInteraccion,!1);else if("K2"==e.message){salirModalInteraccion=!0,modMsj("interacciones002","My Contacts Cloud",tExp("Te recomendamos cambiar a un plan PRO superior para poder a√±adir m√°s interacciones","")+'.<br><center><button type="button" class="btn btn-success" data-bs-dismiss="modal" onClick="abrirModal1DesdeFicha(2)">'+tExp("Mi suscripci√≥n","")+"</button></center>",msjModInteraccion,!1)}else toastSelFila(tExp(e.message,""),msjModInteraccion)})).catch((e=>{toastSelFila(e.message,msjModInteraccion)}))},formEliminarInteraccion.addEventListener("show.bs.modal",(function(e){let t=indice(window.idTabInteracciones,"idii","tabInteracciones");fhiiE_interacciones.value=formatoFechaHora($("#tabInteracciones").bootstrapTable("getData")[t].fhii),asuiE_interacciones.value=$("#tabInteracciones").bootstrapTable("getData")[t].asui})),SieliminarInteraccion.addEventListener("click",(e=>{let t=new FormData;t.append("prefijo",localStorage.getItem("prefijo")),t.append("opcionListado",3),t.append("idii",window.idTabInteracciones),async function(){const e=await fetch("https://"+window.location.host+"/fichaInteraccion",{method:"POST",body:t});return await e.json()}().then((e=>{if(e.success){if("OK"==e.data.value1){if(!dEstSuscrip())return!1;eliminarReg("tabInteracciones","idTabInteracciones","idii","success3")}}else alert(e.message)})).catch((e=>{alert(e.message)}))})),!0}function agregarCodigoDocumentos(){return opcionesTablaSubmenu_documentos.addEventListener("click",(e=>{e.stopPropagation()})),opcionesExportarSubmenu_documentos.addEventListener("click",(e=>{e.stopPropagation()})),fic_documentos.addEventListener("change",(function(e){let t=e.target.files[0];nom_documentos.value=t.name,docEditado=0,nomDocEditadoCompleto=t.name})),modalDocumento.addEventListener("show.bs.modal",(function(e){if(salirModalDocumento)return salirModalDocumento=!1,!1;if(activarTooltipsDiv("modalDocumento"),OneDriveFileId="",OneDriveEditUrl="",docEditado=0,nomDocEditadoCompleto="",1===window.opcionDocumento){let e=(new Date).toISOString().slice(0,10);fec_documentos.defaultValue=e,nom_documentos.defaultValue="",com_documentos.defaultValue="",fec_documentos.readOnly=!1,nom_documentos.readOnly=!1,com_documentos.readOnly=!1,aceptar_documentos.hidden=!1,cancelar_documentos.hidden=!1,examinar_documentos.style.display="",etGrupoBuscarDoc.style.display="",creaNuevoDocumento.style.display="",openDocEdit.style.display="none",document.getElementById("formDocumento").reset()}if(2===window.opcionDocumento||4===window.opcionDocumento){let e=new FormData;e.append("num",23),e.append("donde",window.idTabDocumentos),e.append("prefijo",localStorage.getItem("prefijo")),async function(){const t=await fetch("https://"+window.location.host+"/selectSimple",{method:"POST",body:e});return await t.json()}().then((e=>{if(e.success){if(id_documentos.defaultValue=window.idTabDocumentos,fec_documentos.defaultValue=e.data.fec,nom_documentos.defaultValue=e.data.nom,com_documentos.defaultValue=e.data.com||"",etGrupoBuscarDoc.style.display="none",creaNuevoDocumento.style.display="none",2===window.opcionDocumento){fec_documentos.readOnly=!1,nom_documentos.readOnly=!1,com_documentos.readOnly=!1,aceptar_documentos.hidden=!1,cancelar_documentos.hidden=!1,examinar_documentos.style.display="";const t=obtenerExtensionArchivo(e.data.nom);["docx","xlsx","pptx","doc","xls","ppt","odt","ods","odp"].includes(t)?openDocEdit.style.display="":openDocEdit.style.display="none"}else 4===window.opcionDocumento&&(fec_documentos.readOnly=!0,nom_documentos.readOnly=!0,com_documentos.readOnly=!0,aceptar_documentos.hidden=!0,cancelar_documentos.hidden=!0,examinar_documentos.style.display="none",openDocEdit.style.display="none");document.getElementById("formDocumento").reset()}else toastSelFila(e.message,msjModDocumento)})).catch((e=>{toastSelFila(e.message,msjModDocumento)}))}})),modalDocumento.addEventListener("hide.bs.modal",(function(e){if(salirModalDocumento)return salirModalDocumento=!1,!1;desactivarTooltipsDiv("modalDocumento")})),fileTypeMenu.addEventListener("click",(function(e){e.preventDefault();const t=e.target.closest("[data-value]");if(!t)return;const a=t.getAttribute("data-value");switch(a){case"docx":case"xlsx":case"pptx":crearDocumentoEnOneDrive(a);break;case"odt":case"ods":case"odp":abrirDocumentoEnCollabora(a);break;default:console.error("Extensi√≥n no soportada:",a),toastMsj(tExp("Extensi√≥n no soportada",""),msjModDocumento,1500,5,4)}})),formDocumento.onsubmit=async e=>{if(e.preventDefault(),!dEstSuscrip())return!1;var t=fic_documentos.files.length;if(0==t&&0==docEditado&&1==window.opcionDocumento)return toastSelFila(tExp("Pulsa sobre el bot√≥n de Examinar para seleccionar el fichero",""),msjModDocumento),!1;if(t>1)return toastSelFila(tExp("Selecciona un s√≥lo fichero",""),msjModDocumento),!1;if(1==t&&0==docEditado){if(fic_documentos.files[0].size>5242880)return toastSelFila(tExp("El tama√±o del fichero no debe superar los","")+" 5 Mb",msjModDocumento),!1}let a={id:id_documentos.value,fec:fec_documentos.value,com:com_documentos.value,nom:nom_documentos.value};(async function(){var e="";1==docEditado&&((e=await obtenerTokenMicrosoft(3))||(e=""));let a=new FormData(formDocumento);a.append("prefijo",localStorage.getItem("prefijo")),a.append("opcionListado",window.opcionDocumento),a.append("maxRegFree",localStorage.getItem("maxRegFree")),a.append("plan",localStorage.getItem("plan")),a.append("numFicheros",t),a.append("tfGesDoc",localStorage.getItem("tfGesDoc")),a.append("numGesDoc",localStorage.getItem("numGesDoc")),a.append("docEditado",docEditado),a.append("nomDocEditadoCompleto",nomDocEditadoCompleto),a.append("oneDriveFileId",OneDriveFileId),a.append("accessToken",e);const o=await fetch("https://"+window.location.host+"/fichaDocumento",{method:"POST",body:a});return await o.json()})().then((e=>{if(e.success)ocultarModal("modalDocumento"),"AG"==e.data.value1?(a.id=e.data.value2,$("#tabDocumentos").bootstrapTable("append",a),setTimeout((function(){selRowTab("tabDocumentos","success1","idTabDocumentos",e.data.value2)}),500)):"MO"==e.data.value1&&($("#tabDocumentos").bootstrapTable("updateByUniqueId",{id:window.idTabDocumentos,row:a,replace:!1}),setTimeout((function(){selRowTab("tabDocumentos","success1","idTabDocumentos",window.idTabDocumentos)}),500));else if("K1"==e.message)salirModalDocumento=!0,modMsj("documentos001","My Contacts Cloud",tExp("Te recomendamos adquirir un plan PRO para poder a√±adir m√°s documentos","")+'.<br><center><button type="button" class="btn btn-success" data-bs-dismiss="modal" onClick="abrirModal1DesdeFicha(1)">'+tExp("Ver planes","")+"</button></center>",msjModDocumento,!1);else if("K2"==e.message){salirModalDocumento=!0,modMsj("documentos002","My Contacts Cloud",tExp("Te recomendamos cambiar a un plan PRO superior para poder a√±adir m√°s documentos","")+'.<br><center><button type="button" class="btn btn-success" data-bs-dismiss="modal" onClick="abrirModal1DesdeFicha(2)">'+tExp("Mi suscripci√≥n","")+"</button></center>",msjModDocumento,!1)}else toastSelFila(tExp(e.message,""),msjModDocumento)})).catch((e=>{toastSelFila(e.message,msjModDocumento)}))},formEliminarDocumento.addEventListener("show.bs.modal",(function(e){let t=indice(window.idTabDocumentos,"id","tabDocumentos");fecE.value=formatoFecha($("#tabDocumentos").bootstrapTable("getData")[t].fec),nomE.value=$("#tabDocumentos").bootstrapTable("getData")[t].nom,comE.value=$("#tabDocumentos").bootstrapTable("getData")[t].com})),SiEliminarDocumento.addEventListener("click",(e=>{let t=new FormData;t.append("prefijo",localStorage.getItem("prefijo")),t.append("opcionListado",3),t.append("id",window.idTabDocumentos),async function(){const e=await fetch("https://"+window.location.host+"/fichaDocumento",{method:"POST",body:t});return await e.json()}().then((e=>{if(e.success){if("EL"==e.data.value1){if(!dEstSuscrip())return!1;eliminarReg("tabDocumentos","idTabDocumentos","id","success1")}}else alert(e.message)})).catch((e=>{alert(e.message)}))})),openDocEdit.addEventListener("click",(()=>{OneDriveEditUrl="",OneDriveFileId="";var e=obtenerExtensionArchivo(document.getElementById("nom_documentos").value.trim());"docx"==e||"xlsx"==e||"pptx"==e||"doc"==e||"xls"==e||"ppt"==e?abrirDocumentoEnOneDrive(window.idTabDocumentos,1):"odt"!=e&&"ods"!=e&&"odp"!=e||abrirDocumentoEnCollabora(e)})),!0}function agregarCodigoEventos(){return opcionesTablaSubmenuCl_eventos.addEventListener("click",(e=>{e.stopPropagation()})),opcionesExportarSubmenuCl_eventos.addEventListener("click",(e=>{e.stopPropagation()})),modalEvento.addEventListener("show.bs.modal",(function(e){if(salirModalEvento)return salirModalEvento=!1,!1;if(1==salidaModalEvento)return salidaModalEvento=0,!1;activarTooltipsDiv("modalEvento");if(loadColumnConfig("tabParticipantes"),1===window.opcionEvento){window.idEvento=0,exampleModalLabel_eventos.innerHTML=tExp("Nuevo evento",""),titulo_eventos.defaultValue="",descripcion_eventos.defaultValue="",lugar_eventos.defaultValue="",idReunion_eventos.defaultValue="",passReunion_eventos.defaultValue="",appReunion_eventos.defaultValue=1,www_eventos.defaultValue="",todoeldia_eventos.defaultValue=window.todoElDia,todoeldia_eventos.defaultChecked=window.todoElDia;var t=new Date(window.ini),a=new Date(window.fin);window.todoElDia?(t.getFullYear()+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getDate()).slice(-2)+"T00:00:00",a.getFullYear()+"-"+("0"+(a.getMonth()+1)).slice(-2)+"-"+("0"+a.getDate()).slice(-2)+"T00:00:00"):(t.toISOString().slice(0,-1).substring(0,16),a.toISOString().slice(0,-1).substring(0,16));var o=t.getFullYear()+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getDate()).slice(-2)+"T"+("0"+t.getHours()).slice(-2)+":"+("0"+t.getMinutes()).slice(-2);fechaini_eventos.defaultValue=o;var n=a.getFullYear()+"-"+("0"+(a.getMonth()+1)).slice(-2)+"-"+("0"+a.getDate()).slice(-2)+"T"+("0"+a.getHours()).slice(-2)+":"+("0"+a.getMinutes()).slice(-2);fechafin_eventos.defaultValue=n,seleccionarRadio("color",1),seleccionarCombo("appReunion","1"),bloquesAppReunion(),adjuntar1_eventos.hidden=!0,eliminar_eventos.hidden=!0}else if(2===window.opcionEvento){exampleModalLabel_eventos.innerHTML=tExp("Evento","");let e=new FormData;e.append("num",21),e.append("donde",window.idEvento),e.append("prefijo",localStorage.getItem("prefijo")),async function(){const t=await fetch("https://"+window.location.host+"/selectSimple",{method:"POST",body:e});return await t.json()}().then((e=>{if(e.success){if(titulo_eventos.defaultValue=e.data.titulo,descripcion_eventos.defaultValue=e.data.descripcion||"",lugar_eventos.defaultValue=e.data.lugar||"",idReunion_eventos.defaultValue=e.data.idReunion||"",passReunion_eventos.defaultValue=e.data.passReunion||"",appReunion_eventos.defaultValue=e.data.appReunion,www_eventos.defaultValue=e.data.www||"",todoeldia_eventos.defaultValue=e.data.todoeldia,-1==e.data.todoeldia)var t=e.data.fechaini.substring(0,10)+"T00:00",a=e.data.fechafin.substring(0,10)+"T00:00";else{var o=new Date(e.data.fechaini),n=new Date(e.data.fechafin),s=o.getTimezoneOffset(),c=new Date(o.getTime()-60*s*1e3),r=new Date(n.getTime()-60*s*1e3);t=c.getFullYear()+"-"+("0"+(c.getMonth()+1)).slice(-2)+"-"+("0"+c.getDate()).slice(-2)+"T"+("0"+c.getHours()).slice(-2)+":"+("0"+c.getMinutes()).slice(-2),a=r.getFullYear()+"-"+("0"+(r.getMonth()+1)).slice(-2)+"-"+("0"+r.getDate()).slice(-2)+"T"+("0"+r.getHours()).slice(-2)+":"+("0"+r.getMinutes()).slice(-2)}fechaini_eventos.defaultValue=t,fechafin_eventos.defaultValue=a,seleccionarRadio("color",e.data.color),seleccionarCombo("appReunion",e.data.appReunion),bloquesAppReunion(),0==e.data.todoeldia?todoeldia_eventos.defaultChecked=!1:todoeldia_eventos.defaultChecked=!0}else toastSelFila(e.message,msjModEvento)})).catch((e=>{toastSelFila(e.message,msjModEvento)})),adjuntar1_eventos.hidden=!1,eliminar_eventos.hidden=!1}formEvento.reset()})),modalEvento.addEventListener("hide.bs.modal",(function(e){if(salirModalEvento)return salirModalEvento=!1,!1;desactivarTooltipsDiv("modalEvento")})),formEvento.onsubmit=async e=>{if(e.preventDefault(),salirFormEventoSubmit)return salirFormEventoSubmit=!1,!1;if(salirModalEvento)return!1;if(!dEstSuscrip())return!1;let t=new Date(fechaini_eventos.value),a=new Date(fechafin_eventos.value);if(t>=a)return toastSelFila(tExp("La fecha final debe ser posterior a la inicial",""),msjModEvento),!1;if(todoeldia_eventos.checked){if(new Date(t.getFullYear(),t.getMonth(),t.getDate())==new Date(a.getFullYear(),a.getMonth(),a.getDate()))return toastSelFila(tExp("El d√≠a debe ser distinto",""),msjModEvento),!1}if(todoeldia_eventos.checked)var o=fechaini_eventos.value.substring(0,10)+"T00:00",n=fechafin_eventos.value.substring(0,10)+"T00:00";else o=fechaini_eventos.value,n=fechafin_eventos.value;var s=dValorRadio("color");bdEvento(window.opcionEvento,window.idEvento,titulo_eventos.value,todoeldia_eventos.checked,o,n,s,www_eventos.value,descripcion_eventos.value,lugar_eventos.value,idReunion_eventos.value,passReunion_eventos.value,appReunion_eventos.value)},formEvento.onreset=async e=>{if(indiceFilaTabParticipantes=-1,refrescoTabParticipantes=-1,iPosTabParticipantes=0,1===window.opcionEvento){$("#tabParticipantes").bootstrapTable("removeAll");let e=localStorage.getItem("codContactoNlistadoEventos");if(""!=e){let t=$("#tabContactos").bootstrapTable("getRowByUniqueId",e);if(t){let e={ccn:t.ccn,cod:t.cod,per:t.per,nom:t.nom,te1:t.te1,te2:t.te2,cor:t.cor,www:t.www,car:t.car,dep:t.dep,nif:t.nif,dom:t.dom,cpo:t.cpo,pob:t.pob,pro:t.pro,pai:t.pai,rol:t.rol};$("#tabParticipantes").bootstrapTable("append",e),window.ccnParticipante=fila.ccn,seleccionarFila("tabParticipantes","ccnParticipante","ccn","success2")}}}else 2!==window.opcionEvento&&4!==window.opcionEvento||$("#tabParticipantes").bootstrapTable("refresh",{url:"https://"+window.location.host+"/datosTablaSub?vista=participantes&prefijo="+localStorage.getItem("prefijo")+"&id="+window.idEvento})},todoeldia_eventos.addEventListener("click",(e=>{todoeldia_eventos.checked?todoeldia_eventos.value=-1:todoeldia_eventos.value=0})),appReunion_eventos.addEventListener("change",(e=>{bloquesAppReunion()})),!0}function iniciarContactos(){sumEleGrupo1=0,sumEleGrupo2=0,sumEleGrupo3=0;let e=new FormData;e.append("prefijo",localStorage.getItem("prefijo")),async function(){const t=await fetch("https://"+window.location.host+"/leergrupos",{method:"POST",body:e});return await t.json()}().then((e=>{dataGruposContactos=e,document.getElementById("ng1_contactos").textContent=localStorage.getItem("nomGrupo1"),document.getElementById("eg1_contactos").style.display="block",document.getElementById("eg1_contactos").innerHTML="",document.getElementById("ng2_contactos").textContent=localStorage.getItem("nomGrupo2"),document.getElementById("eg2_contactos").style.display="block",document.getElementById("eg2_contactos").innerHTML="",document.getElementById("ng3_contactos").textContent=localStorage.getItem("nomGrupo3"),document.getElementById("eg3_contactos").style.display="block",document.getElementById("eg3_contactos").innerHTML="",dataGruposContactos.forEach((e=>{const t=parseInt(e.numGrupo),a=document.createElement("option");a.value=e.numElemento,a.textContent=e.desElemento,1===t?(document.getElementById("eg1_contactos").appendChild(a),sumEleGrupo1+=1):2===t?(document.getElementById("eg2_contactos").appendChild(a),sumEleGrupo2+=1):3===t&&(document.getElementById("eg3_contactos").appendChild(a),sumEleGrupo3+=1)})),primeraVezModalGruposContactos=!0,cambiarIconoBotonFiltrado(2)})).catch((e=>{toastMsj(e.message,msjContactos,2e3,6,1)}));let t=new FormData;t.append("prefijo",localStorage.getItem("prefijo")),async function(){const e=await fetch("https://"+window.location.host+"/leeretiquetas",{method:"POST",body:t});return await e.json()}().then((e=>{dataEtiquetas=e})).catch((e=>{toastMsj(e.message,msjContactos,2e3,6,1)})),setTimeout((function(){window.idTabContactos="",salirModalContacto=!1;var e=localStorage.getItem("idiomaPais"),t=localStorage.getItem("nomRef1"),a=localStorage.getItem("nomRef2"),o=localStorage.getItem("nomRef3"),n=localStorage.getItem("nomRef4");rf1_contactos.placeholder=t,rf2_contactos.placeholder=a,rf3_contactos.placeholder=o,rf4_contactos.placeholder=n,rf1_contactos.title=t,rf2_contactos.title=a,rf3_contactos.title=o,rf4_contactos.title=n,lrf1_contactos.textContent=t,lrf2_contactos.textContent=a,lrf3_contactos.textContent=o,lrf4_contactos.textContent=n;var s=localStorage.getItem("titPref1"),c=localStorage.getItem("titPref2"),r=localStorage.getItem("titPref3"),i=localStorage.getItem("titPref4"),l=localStorage.getItem("titPref5"),d=localStorage.getItem("titPref6");pr1_contactos.placeholder=s,pr2_contactos.placeholder=c,pr3_contactos.placeholder=r,pr4_contactos.placeholder=i,pr5_contactos.placeholder=l,pr6_contactos.placeholder=d,pr1_contactos.title=s,pr2_contactos.title=c,pr3_contactos.title=r,pr4_contactos.title=i,pr5_contactos.title=l,pr6_contactos.title=d,lpr1_contactos.textContent=s,lpr2_contactos.textContent=c,lpr3_contactos.textContent=r,lpr4_contactos.textContent=i,lpr5_contactos.textContent=l,lpr6_contactos.textContent=d;var u,p=localStorage.getItem("nomGrupo1"),m=localStorage.getItem("nomGrupo2"),b=localStorage.getItem("nomGrupo3");indiceFilaTab=-1,refrescoTabContactos=-1,iPosTabContactos=0,$("#tabContactos").bootstrapTable({locale:localeTable(e),url:"https://"+window.location.host+"/datosTabla?vista=contactos&prefijo="+localStorage.getItem("prefijo"),onClickRow:function(e,t,a){selRowTab("tabContactos","success","idTabContactos",e.ccn),nombrePersonaContacto=e.per},onDblClickRow:function(e,t,a){if(1==salidaModalEvento){if(null===$("#tabParticipantes").bootstrapTable("getRowByUniqueId",e.ccn)){let t={ccn:e.ccn,cod:e.cod,per:e.per,nom:e.nom,te1:e.te1,te2:e.te2,cor:e.cor,www:e.www,car:e.car,dep:e.dep,nif:e.nif,dom:e.dom,cpo:e.cpo,pob:e.pob,pro:e.pro,pai:e.pai,rol:e.rol};$("#tabParticipantes").bootstrapTable("append",t),setTimeout((function(){selRowTab("tabParticipantes","success2","idTabParticipantes",e.ccn)}),200)}setTimeout((function(){cambioDiv("contactos","eventos",0,1)}),500)}},onSort:function(e,t){setTimeout((function(){saveColumnConfig("tabContactos"),1!=$("#tabContactos").bootstrapTable("getOptions").pageNumber?$("#tabContactos").bootstrapTable("selectPage",1):selRowTab("tabContactos","success","idTabContactos",$("#tabContactos").bootstrapTable("getData")[0].ccn)}),500)},onSearch:function(e){selRowTab("tabContactos","success","idTabContactos",$("#tabContactos").bootstrapTable("getData")[0].ccn)},onPageChange:function(e,t){setTimeout((function(){-1==indiceFilaTab&&(indiceFilaTab=(e-1)*t),selRowTab("tabContactos","success","idTabContactos",$("#tabContactos").bootstrapTable("getData")[indiceFilaTab].ccn)}),500)},onPostBody:function(){var e=$("#tabContactos").bootstrapTable("getOptions").cardView;vistaAntTabContactos!==e&&(vistaAntTabContactos=e,setTimeout((function(){selRowTab("tabContactos","success","idTabContactos",window.idTabContactos)}),200))},onLoadSuccess:function(){selRowTab("tabContactos","success","idTabContactos",$("#tabContactos").bootstrapTable("getData")[0].ccn)},columns:[]});for(var f=0;f<tabContactosCampos.length;f++){if("rf1"==tabContactosCampos[f])u=t;else if("rf2"==tabContactosCampos[f])u=a;else if("rf3"==tabContactosCampos[f])u=o;else if("rf4"==tabContactosCampos[f])u=n;else if("pr1"==tabContactosCampos[f])u=s;else if("pr2"==tabContactosCampos[f])u=c;else if("pr3"==tabContactosCampos[f])u=r;else if("pr4"==tabContactosCampos[f])u=i;else if("pr5"==tabContactosCampos[f])u=l;else if("pr6"==tabContactosCampos[f])u=d;else if("eg1"==tabContactosCampos[f])u=p;else if("eg2"==tabContactosCampos[f])u=m;else if("eg3"==tabContactosCampos[f])u=b;else switch(e){case"es-es":case"es-ES":u=tabContactosTitCol_es_ES[f];break;case"ca-es":case"ca-ES":u=tabContactosTitCol_ca_ES[f];break;case"eu-es":case"eu-ES":u=tabContactosTitCol_eu_ES[f];break;case"gl-es":case"gl-ES":u=tabContactosTitCol_gl_ES[f];break;case"en-gb":case"en-GB":u=tabContactosTitCol_en_GB[f];break;case"es-mx":case"es-MX":u=tabContactosTitCol_es_MX[f];break;case"es-cl":case"es-CL":u=tabContactosTitCol_es_CL[f];break;case"es-us":case"es-US":u=tabContactosTitCol_es_US[f];break;case"en-us":case"en-US":default:u=tabContactosTitCol_en_US[f];break;case"en-ca":case"en-CA":u=tabContactosTitCol_en_CA[f];break;case"en-au":case"en-AU":u=tabContactosTitCol_en_AU[f];break;case"it-it":case"it-IT":u=tabContactosTitCol_it_IT[f];break;case"pt-pt":case"pt-PT":u=tabContactosTitCol_pt_PT[f];break;case"pt-br":case"pt-BR":u=tabContactosTitCol_pt_BR[f];break;case"fr-fr":case"fr-FR":u=tabContactosTitCol_fr_FR[f];break;case"fr-ca":case"fr-CA":u=tabContactosTitCol_fr_CA[f];break;case"de-de":case"de-DE":u=tabContactosTitCol_de_DE[f];break;case"en-nz":case"en-NZ":u=tabContactosTitCol_en_NZ[f];break;case"en-ie":case"en-IE":u=tabContactosTitCol_en_IE[f];break;case"en-in":case"en-IN":u=tabContactosTitCol_en_IN[f];break;case"en-sg":case"en-SG":u=tabContactosTitCol_en_SG[f];break;case"en-hk":case"en-HK":u=tabContactosTitCol_en_HK[f];break;case"en-my":case"en-MY":u=tabContactosTitCol_en_MY[f];break;case"es-ar":case"es-AR":u=tabContactosTitCol_es_AR[f];break;case"es-co":case"es-CO":u=tabContactosTitCol_es_CO[f];break;case"es-pe":case"es-PE":u=tabContactosTitCol_es_PE[f];break;case"es-uy":case"es-UY":u=tabContactosTitCol_es_UY[f];break;case"fr-be":case"fr-BE":case"fr-be":case"fr-BE":u=tabContactosTitCol_fr_BE[f];break;case"fr-ch":case"fr-CH":case"fr-ch":case"fr-CH":u=tabContactosTitCol_fr_CH[f];break;case"it-ch":case"it-CH":u=tabContactosTitCol_it_CH[f];break;case"de-at":case"de-AT":u=tabContactosTitCol_de_AT[f];break;case"de-be":case"de-BE":u=tabContactosTitCol_de_BE[f];break;case"de-ch":case"de-CH":u=tabContactosTitCol_de_CH[f];break;case"es-ve":case"es-VE":u=tabContactosTitCol_es_VE[f];break;case"es-gt":case"es-GT":u=tabContactosTitCol_es_GT[f];break;case"es-ec":case"es-EC":u=tabContactosTitCol_es_EC[f];break;case"es-bo":case"es-BO":u=tabContactosTitCol_es_BO[f];break;case"es-cu":case"es-CU":u=tabContactosTitCol_es_CU[f];break;case"es-do":case"es-DO":u=tabContactosTitCol_es_DO[f];break;case"es-hn":case"es-HN":u=tabContactosTitCol_es_HN[f];break;case"es-py":case"es-PY":u=tabContactosTitCol_es_PY[f];break;case"es-sv":case"es-SV":u=tabContactosTitCol_es_SV[f];break;case"es-ni":case"es-NI":u=tabContactosTitCol_es_NI[f];break;case"es-pa":case"es-PA":u=tabContactosTitCol_es_PA[f];break;case"en-pk":case"en-PK":u=tabContactosTitCol_en_PK[f];break;case"en-ng":case"en-NG":u=tabContactosTitCol_en_NG[f];break;case"en-bd":case"en-BD":u=tabContactosTitCol_en_BD[f];break;case"en-ph":case"en-PH":u=tabContactosTitCol_en_PH[f];break;case"en-tz":case"en-TZ":u=tabContactosTitCol_en_TZ[f];break;case"en-za":case"en-ZA":u=tabContactosTitCol_en_ZA[f];break;case"en-ke":case"en-KE":u=tabContactosTitCol_en_KE[f];break;case"en-ug":case"en-UG":u=tabContactosTitCol_en_UG[f];break;case"en-gh":case"en-GH":u=tabContactosTitCol_en_GH[f];break;case"en-mw":case"en-MW":u=tabContactosTitCol_en_MW[f];break;case"en-zm":case"en-ZM":u=tabContactosTitCol_en_ZM[f];break;case"en-zw":case"en-ZW":u=tabContactosTitCol_en_ZW[f];break;case"en-cm":case"en-CM":u=tabContactosTitCol_en_CM[f];break;case"en-lk":case"en-LK":u=tabContactosTitCol_en_LK[f];break;case"fr-cd":case"fr-CD":u=tabContactosTitCol_fr_CD[f];break;case"fr-cm":case"fr-CM":u=tabContactosTitCol_fr_CM[f];break;case"fr-mg":case"fr-MG":u=tabContactosTitCol_fr_MG[f];break;case"fr-ci":case"fr-CI":u=tabContactosTitCol_fr_CI[f];break;case"fr-bf":case"fr-BF":u=tabContactosTitCol_fr_BF[f];break;case"fr-ne":case"fr-NE":u=tabContactosTitCol_fr_NE[f];break;case"fr-sn":case"fr-SN":u=tabContactosTitCol_fr_SN[f];break;case"fr-ml":case"fr-ML":u=tabContactosTitCol_fr_ML[f];break;case"fr-bj":case"fr-BJ":u=tabContactosTitCol_fr_BJ[f];break;case"fr-rw":case"fr-RW":u=tabContactosTitCol_fr_RW[f];break;case"fr-td":case"fr-TD":u=tabContactosTitCol_fr_TD[f];break;case"fr-gn":case"fr-GN":u=tabContactosTitCol_fr_GN[f];break;case"pt-ao":case"pt-AO":u=tabContactosTitCol_pt_AO[f];break;case"pt-mz":case"pt-MZ":u=tabContactosTitCol_pt_MZ[f]}$("#tabContactos").bootstrapTable("updateColumnTitle",{field:tabContactosCampos[f],title:u})}loadColumnConfig("tabContactos");const g=$("#tabContactos").bootstrapTable("getOptions").columns[0];g.forEach((e=>{formatearColumna(e)})),$("#tabContactos").bootstrapTable("refreshOptions",{columns:g}),crearToastContacto("Nuevo contacto","'modalContacto'","'opcionContacto'","modalContacto"),cambiarTextoIdioma(""),crearEstilo("aceptar_contactos","cancelar_contactos",tExp("Guardar",""),tExp("Cancelar","")),activarTooltipsDiv("contactos"),cambiarAltoTabla("tabContactos",0),barraPaginacion("#tabContactos"),0==cont2_contactos.disabled&&abrirToast("liveToastContacto"),1==salidaModalEvento?(toastMsj(tExp("Doble clic para seleccionar el contacto",""),msjContactos,2e3,6,5),document.getElementById("gesdGrupo_contactos").style.display="none",document.getElementById("separador1Li_contactos").style.display="none",document.getElementById("gesdLi_contactos").style.display="none",document.getElementById("evenLi_contactos").style.display="none",document.getElementById("botonFiltrado").style.display="none"):(document.getElementById("gesdGrupo_contactos").style.display="",document.getElementById("separador1Li_contactos").style.display="list-item",document.getElementById("gesdLi_contactos").style.display="list-item",document.getElementById("evenLi_contactos").style.display="list-item",document.getElementById("botonFiltrado").style.display="");"landscape"==window.screen.orientation.type.slice(0,9)?pCompleta_contactos.style.display="":(pCompleta_contactos.style.display="none",0==salidaModalEvento&&toastMsj(tExp("Gira la pantalla",""),msjContactos,1500,4,6))}),200),$("#tabContactos").bootstrapTable("filterBy",{})}function iniciarDocumentos(){window.idTabDocumentos="",salirModalDocumento=!1;var e=localStorage.getItem("tfGesDoc"),t=localStorage.getItem("numGesDoc"),a=localStorage.getItem("idiomaPais");indiceFilaTabDocumentos=-1,refrescoTabDocumentos=-1,iPosTabDocumentos=0,$("#tabDocumentos").bootstrapTable({locale:localeTable(a),url:"https://"+window.location.host+"/datosTablaGesDoc?prefijo="+localStorage.getItem("prefijo")+"&tfGesDoc="+e+"&numGesDoc="+t,onClickRow:function(e,t,a){selRowTab("tabDocumentos","success1","idTabDocumentos",e.id)},onSort:function(e,t){setTimeout((function(){saveColumnConfig("tabDocumentos"),selRowTab("tabDocumentos","success1","idTabDocumentos",$("#tabDocumentos").bootstrapTable("getData")[0].id)}),500)},onSearch:function(e){selRowTab("tabDocumentos","success1","idTabDocumentos",$("#tabDocumentos").bootstrapTable("getData")[0].id)},onPostBody:function(){var e=$("#tabDocumentos").bootstrapTable("getOptions").cardView;vistaAntTabDocumentos!==e&&(vistaAntTabDocumentos=e,setTimeout((function(){selRowTab("tabDocumentos","success1","idTabDocumentos",window.idTabDocumentos)}),200))},columns:[]});for(var o=0;o<tabDocumentosCampos.length;o++)$("#tabDocumentos").bootstrapTable("updateColumnTitle",{field:tabDocumentosCampos[o],title:dTitColDocumentos(a,o)});loadColumnConfig("tabDocumentos"),$("#tabDocumentos").on("load-success.bs.table",(function(){$("#tabDocumentos").bootstrapTable("check",0),selRowTab("tabDocumentos","success1","idTabDocumentos",$("#tabDocumentos").bootstrapTable("getData")[0].id)})),crearToastDocumento("Nuevo documento","'modalDocumento'","'opcionDocumento'"),cambiarTextoIdioma(""),crearEstilo("aceptar_documentos","cancelar_documentos",tExp("Guardar",""),tExp("Cancelar","")),activarTooltipsDiv("documentos"),cambiarAltoTabla("tabDocumentos",0),barraPaginacion("#tabDocumentos"),abrirToast("liveToastDocumento"),"contactos"==localStorage.getItem("divAnt")&&toastMsj(tExp("Documentos con ","")+nombrePersonaContacto,msjDocumentos,1500,5,7)}function iniciarEventos(){window.salirDeCambioEvento=0,salirModalEvento=!1;var e=localStorage.getItem("codContactoNlistadoEventos");sEvents=""==e?"https://"+window.location.host+"/datosTabla?vista=eventos&prefijo="+localStorage.getItem("prefijo"):"https://"+window.location.host+"/datosTablaEventosContacto?codContactoN="+e+"&prefijo="+localStorage.getItem("prefijo");var t=localeEvent(localStorage.getItem("idiomaPais")),a=primerDiaSemana(),o=!1;1==localStorage.getItem("weekends")&&(o=!0);var n=localStorage.getItem("slotMinTime").toString().padStart(2,"0")+":00:00",s=localStorage.getItem("slotMaxTime").toString().padStart(2,"0")+":00:00",c=localStorage.getItem("slotDuration");if(1==c)var r="01:00";else if(2==c)r="02:00";else r="00:"+c.toString();window.ccnParticipante="";var i=localStorage.getItem("vistaIni"),l=localStorage.getItem("idiomaPais");indiceFilaTabParticipantes=-1,refrescoTabParticipantes=-1,iPosTabParticipantes=0,$("#tabParticipantes").bootstrapTable({locale:localeTable(l),onClickRow:function(e,t,a){selRowTab("tabParticipantes","success2","idTabParticipantes",e.ccn)},onSort:function(e,t){setTimeout((function(){saveColumnConfig("tabParticipantes"),selRowTab("tabParticipantes","success2","idTabParticipantes",$("#tabParticipantes").bootstrapTable("getData")[0].ccn)}),500)},onSearch:function(e){selRowTab("tabParticipantes","success2","idTabParticipantes",$("#tabParticipantes").bootstrapTable("getData")[0].ccn)},onPostBody:function(){var e=$("#tabParticipantes").bootstrapTable("getOptions").cardView;vistaAntTabParticipantes!==e&&(vistaAntTabParticipantes=e,setTimeout((function(){selRowTab("tabParticipantes","success2","idTabParticipantes",window.idTabParticipantes)}),200))},onLoadSuccess:function(){$("#tabParticipantes").bootstrapTable("check",0),selRowTab("tabParticipantes","success2","idTabParticipantes",$("#tabParticipantes").bootstrapTable("getData")[0].ccn)},columns:[]});for(var d=0;d<tabParticipantesCampos.length;d++)$("#tabParticipantes").bootstrapTable("updateColumnTitle",{field:tabParticipantesCampos[d],title:dTitColParticipantes(l,d)});loadColumnConfig("tabParticipantes");const u=$("#tabParticipantes").bootstrapTable("getOptions").columns[0];u.forEach((e=>{formatearColumna(e)})),$("#tabParticipantes").bootstrapTable("refreshOptions",{columns:u}),cambiarTextoIdioma(""),crearEstiloEl(tExp("Eliminar","")),crearEstilo("aceptar_eventos","cancelar_eventos",tExp("Guardar",""),tExp("Cancelar","")),activarTooltipsDiv("eventos"),"contactos"==localStorage.getItem("divAnt")&&toastMsj(tExp("Eventos con ","")+nombrePersonaContacto,msjEventos,1500,5,8);[].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]')).map((function(e){return new bootstrap.Popover(e)}));var p=document.getElementById("calendario_eventos");(calendar=new FullCalendar.Calendar(p,{themeSystem:"bootstrap5",locale:t,timeZone:"local",firstDay:a,weekends:o,slotMinTime:n,slotMaxTime:s,slotDuration:r,views:{dayGridMonth:{dayMaxEventRows:5}},fixedWeekCount:!1,initialView:i,headerToolbar:{left:"dayGridMonth,timeGridWeek,timeGridDay,listWeek",center:"title",right:"ant,sig,today nue,imprimirCal,closeButton"},customButtons:{imprimirCal:{icon:"printer",click:function(){window.print()}},closeButton:{icon:"x-lg",click:function(){salidaModalEvento=0,"contactos"==localStorage.getItem("divAnt")&&""!=localStorage.getItem("codContactoNlistadoEventos")?cambioDiv("eventos","contactos",0,1):cambioDiv("eventos","menu",0,0)}},ant:{icon:"chevron-left",click:function(){calendar.prev()}},sig:{icon:"chevron-right",click:function(){calendar.next()}},nue:{icon:"plus-lg",click:function(){var e=new Date,t=new Date;t.setDate(e.getDate()+1),window.opcionEvento=1,window.idEvento=0,window.ini=new Date(e.getFullYear(),e.getMonth(),e.getDate()),window.fin=new Date(t.getFullYear(),t.getMonth(),t.getDate()),window.todoElDia=!0,new bootstrap.Modal(modalEvento).show()}}},initialDate:new Date,navLinks:!0,selectable:!0,selectMirror:!0,selectLongPressDelay:1e3,eventLongPressDelay:1e3,nowIndicator:!0,contentHeight:"auto",rerenderDelay:null,select:function(e){window.opcionEvento=1,window.idEvento=0,window.ini=e.start,window.fin=e.end,window.todoElDia=e.allDay,new bootstrap.Modal(modalEvento).show(),calendar.unselect()},eventClick:function(e){e.event.url&&e.jsEvent.preventDefault(),window.opcionEvento=2,window.idEvento=e.event.id,window.todoElDia=e.event.allDay,window.ini=e.event.start,window.fin=e.event.end,myModalEvento=new bootstrap.Modal(modalEvento),myModalEvento.show()},eventChange:function(e){if(1==window.salirDeCambioEvento)return!1;var t=new Date(e.event.start),a=new Date(e.event.end);if(e.event.allDay)var o=t.getFullYear()+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getDate()).slice(-2)+"T00:00",n=a.getFullYear()+"-"+("0"+(a.getMonth()+1)).slice(-2)+"-"+("0"+a.getDate()).slice(-2)+"T00:00";else o=t.getFullYear()+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getDate()).slice(-2)+"T"+("0"+t.getHours()).slice(-2)+":"+("0"+t.getMinutes()).slice(-2),n=a.getFullYear()+"-"+("0"+(a.getMonth()+1)).slice(-2)+"-"+("0"+a.getDate()).slice(-2)+"T"+("0"+a.getHours()).slice(-2)+":"+("0"+a.getMinutes()).slice(-2);bdEvento(4,e.event.id,"",e.event.allDay,o,n,"","","","","","","")},eventMouseEnter:function(e){let t="",a=e.event.extendedProps,o=listaNomParticipantesEvento();""!=a.descripcion&&(t='<h6><i class="bi-chat-square"></i>&nbsp;'+a.descripcion+"</h6>"),""!=a.lugar&&(t+='<h6><i class="bi-signpost"></i>&nbsp;'+a.lugar+"</h6>"),""!=o&&(t+='<h6><i class="bi-people"></i>&nbsp;'+o+"</h6>"),t&&(esconderPopover(),(ventanaSobre=new bootstrap.Popover(e.el,{title:'<h5 class="custom-title"><i class="bi-info-circle-fill"></i>&nbsp;'+e.event.title+"</h5>",content:t,html:!0,trigger:"focus"})).show())},eventMouseLeave:function(e){esconderPopover()},datesSet:function(e){},editable:!0,forceEventDuration:!0,lazyFetching:!1,events:function(e,t,a){fetch(sEvents,{method:"GET",headers:{"Cache-Control":"no-cache"}}).then((e=>e.json())).then((e=>{t(e)})).catch((e=>{a(e)}))}})).render()}function nuevoEvento(e,t,a,o,n,s,c,r,i,l,d,u){var p="list-item";a&&(p="block");let m=aColorFondoEvento[s-1];var b="#ffffff";4==s&&(b="#000000"),calendar.addEvent({id:e,allDay:a,start:o,end:n,title:t,url:c,editable:!0,display:p,backgroundColor:m,borderColor:m,textColor:b,descripcion:r,lugar:i,idReunion:l,passReunion:d,appReunion:u})}function modificarEvento(e,t,a,o,n,s,c,r,i,l,d,u){window.salirDeCambioEvento=1;var p="list-item";a&&(p="block");let m=aColorFondoEvento[s-1];var b="#ffffff";4==s&&(b="#000000");let f=calendar.getEventById(e);f.setAllDay(a),f.setStart(o),f.setEnd(n),f.setProp("display",p),f.setProp("title",t),f.setProp("url",c),f.setProp("backgroundColor",m),f.setProp("borderColor",m),f.setProp("textColor",b),f.setExtendedProp("descripcion",r),f.setExtendedProp("lugar",i),f.setExtendedProp("idReunion",l),f.setExtendedProp("passReunion",d),f.setExtendedProp("appReunion",u),window.salirDeCambioEvento=0}function eliminarEvento(e){calendar.getEventById(e).remove()}function confirmacionEliminar(){if(!dEstSuscrip())return!1;bdEvento(3,window.idEvento,"","","","","","","","","","","")}function bdEvento(e,t,a,o,n,s,c,r,i,l,d,u,p){if(3!=e)if(o)var m=n.replace("T"," "),b=s.replace("T"," ");else{var f=new Date(n),g=new Date(s);m=f.toISOString().slice(0,-1).substring(0,16).replace("T"," "),b=g.toISOString().slice(0,-1).substring(0,16).replace("T"," ")}(async function(){let n=new FormData;if(n.append("plan",localStorage.getItem("plan")),n.append("prefijo",localStorage.getItem("prefijo")),n.append("maxRegFree",localStorage.getItem("maxRegFree")),n.append("opcionListado",e),n.append("id",t),n.append("todoeldia",o?-1:0),n.append("fechaini",m),n.append("fechafin",b),1==e||2==e){const e=$("#tabParticipantes").bootstrapTable("getData").map((e=>({ccn:e.ccn})));n.append("titulo",a),n.append("descripcion",i),n.append("lugar",l),n.append("color",c),n.append("www",r),n.append("idReunion",d),n.append("passReunion",u),n.append("appReunion",p),n.append("dataJSON",JSON.stringify(e))}const s=await fetch("https://"+window.location.host+"/fichaEvento",{method:"POST",body:n});return await s.json()})().then((m=>{m.success?(1==e&&nuevoEvento(t=m.data.value2,a,o,n,s,c,r,i,l,d,u,p),2==e&&modificarEvento(t,a,o,n,s,c,r,i,l,d,u,p),3==e&&eliminarEvento(t),(1==e||2==e||3==e)&&bootstrap.Modal.getInstance(modalEvento).hide()):"K1"==m.message?(salirModalEvento=!0,modMsjFinPruebaToast("eventos001","My Contacts Cloud",txtFinPrueba1(),txtFinPrueba2())):"K2"==m.message?(salirModalEvento=!0,modMsj("eventos002","My Contacts Cloud",tExp("Te recomendamos cambiar a un plan PRO superior para poder a√±adir m√°s eventos","")+'.<br><center><button type="button" class="btn btn-success" data-bs-dismiss="modal" onClick="abrirModal1DesdeFicha(2)">'+tExp("Mi suscripci√≥n","")+"</button></center>",msjModEvento,!1)):toastSelFila(m.message,msjModEvento)}))}function esconderPopover(){null!=ventanaSobre&&(ventanaSobre.hide(),ventanaSobre=null)}function crearEstiloEl(e){const t=document.createElement("style"),a="\n\t\t      @media (min-width: 993px) {\n\t\t        #eliminar_eventos:after  { content: '  "+e+"';}\n\t\t      }\n\t\t    ";t.innerHTML=a,document.head.appendChild(t)}function dTitColParticipantes(e,t){switch(e){case"es-es":case"es-ES":return tabParticipantesTitCol_es_ES[t];case"ca-es":case"ca-ES":return tabParticipantesTitCol_ca_ES[t];case"eu-es":case"eu-ES":return tabParticipantesTitCol_eu_ES[t];case"gl-es":case"gl-ES":return tabParticipantesTitCol_gl_ES[t];case"en-gb":case"en-GB":return tabParticipantesTitCol_en_GB[t];case"es-mx":case"es-MX":return tabParticipantesTitCol_es_MX[t];case"es-cl":case"es-CL":return tabParticipantesTitCol_es_CL[t];case"es-us":case"es-US":return tabParticipantesTitCol_es_US[t];case"en-us":case"en-US":default:return tabParticipantesTitCol_en_US[t];case"en-ca":case"en-CA":return tabParticipantesTitCol_en_CA[t];case"en-au":case"en-AU":return tabParticipantesTitCol_en_AU[t];case"it-it":case"it-IT":return tabParticipantesTitCol_it_IT[t];case"pt-pt":case"pt-PT":return tabParticipantesTitCol_pt_PT[t];case"pt-br":case"pt-BR":return tabParticipantesTitCol_pt_BR[t];case"fr-fr":case"fr-FR":return tabParticipantesTitCol_fr_FR[t];case"fr-ca":case"fr-CA":return tabParticipantesTitCol_fr_CA[t];case"de-de":case"de-DE":return tabParticipantesTitCol_de_DE[t];case"en-nz":case"en-NZ":return tabParticipantesTitCol_en_NZ[t];case"en-ie":case"en-IE":return tabParticipantesTitCol_en_IE[t];case"en-in":case"en-IN":return tabParticipantesTitCol_en_IN[t];case"en-sg":case"en-SG":return tabParticipantesTitCol_en_SG[t];case"en-hk":case"en-HK":return tabParticipantesTitCol_en_HK[t];case"en-my":case"en-MY":return tabParticipantesTitCol_en_MY[t];case"es-ar":case"es-AR":return tabParticipantesTitCol_es_AR[t];case"es-co":case"es-CO":return tabParticipantesTitCol_es_CO[t];case"es-pe":case"es-PE":return tabParticipantesTitCol_es_PE[t];case"es-uy":case"es-UY":return tabParticipantesTitCol_es_UY[t];case"fr-be":case"fr-BE":case"fr-be":case"fr-BE":return tabParticipantesTitCol_fr_BE[t];case"fr-ch":case"fr-CH":case"fr-ch":case"fr-CH":return tabParticipantesTitCol_fr_CH[t];case"it-ch":case"it-CH":return tabParticipantesTitCol_it_CH[t];case"de-at":case"de-AT":return tabParticipantesTitCol_de_AT[t];case"de-be":case"de-BE":return tabParticipantesTitCol_de_BE[t];case"de-ch":case"de-CH":return tabParticipantesTitCol_de_CH[t];case"es-ve":case"es-VE":return tabParticipantesTitCol_es_VE[t];case"es-gt":case"es-GT":return tabParticipantesTitCol_es_GT[t];case"es-ec":case"es-EC":return tabParticipantesTitCol_es_EC[t];case"es-bo":case"es-BO":return tabParticipantesTitCol_es_BO[t];case"es-cu":case"es-CU":return tabParticipantesTitCol_es_CU[t];case"es-do":case"es-DO":return tabParticipantesTitCol_es_DO[t];case"es-hn":case"es-HN":return tabParticipantesTitCol_es_HN[t];case"es-py":case"es-PY":return tabParticipantesTitCol_es_PY[t];case"es-sv":case"es-SV":return tabParticipantesTitCol_es_SV[t];case"es-ni":case"es-NI":return tabParticipantesTitCol_es_NI[t];case"es-pa":case"es-PA":return tabParticipantesTitCol_es_PA[t];case"en-pk":case"en-PK":return tabParticipantesTitCol_en_PK[t];case"en-ng":case"en-NG":return tabParticipantesTitCol_en_NG[t];case"en-bd":case"en-BD":return tabParticipantesTitCol_en_BD[t];case"en-ph":case"en-PH":return tabParticipantesTitCol_en_PH[t];case"en-tz":case"en-TZ":return tabParticipantesTitCol_en_TZ[t];case"en-za":case"en-ZA":return tabParticipantesTitCol_en_ZA[t];case"en-ke":case"en-KE":return tabParticipantesTitCol_en_KE[t];case"en-ug":case"en-UG":return tabParticipantesTitCol_en_UG[t];case"en-gh":case"en-GH":return tabParticipantesTitCol_en_GH[t];case"en-mw":case"en-MW":return tabParticipantesTitCol_en_MW[t];case"en-zm":case"en-ZM":return tabParticipantesTitCol_en_ZM[t];case"en-zw":case"en-ZW":return tabParticipantesTitCol_en_ZW[t];case"en-cm":case"en-CM":return tabParticipantesTitCol_en_CM[t];case"en-lk":case"en-LK":return tabParticipantesTitCol_en_LK[t];case"fr-cd":case"fr-CD":return tabParticipantesTitCol_fr_CD[t];case"fr-cm":case"fr-CM":return tabParticipantesTitCol_fr_CM[t];case"fr-mg":case"fr-MG":return tabParticipantesTitCol_fr_MG[t];case"fr-ci":case"fr-CI":return tabParticipantesTitCol_fr_CI[t];case"fr-bf":case"fr-BF":return tabParticipantesTitCol_fr_BF[t];case"fr-ne":case"fr-NE":return tabParticipantesTitCol_fr_NE[t];case"fr-sn":case"fr-SN":return tabParticipantesTitCol_fr_SN[t];case"fr-ml":case"fr-ML":return tabParticipantesTitCol_fr_ML[t];case"fr-bj":case"fr-BJ":return tabParticipantesTitCol_fr_BJ[t];case"fr-rw":case"fr-RW":return tabParticipantesTitCol_fr_RW[t];case"fr-td":case"fr-TD":return tabParticipantesTitCol_fr_TD[t];case"fr-gn":case"fr-GN":return tabParticipantesTitCol_fr_GN[t];case"pt-ao":case"pt-AO":return tabParticipantesTitCol_pt_AO[t];case"pt-mz":case"pt-MZ":return tabParticipantesTitCol_pt_MZ[t]}}function bloquesAppReunion(){if(0==appReunion_eventos.value)idReunionB_eventos.hidden=!0,passReunionB_eventos.hidden=!0;else if(1==appReunion_eventos.value){idReunionB_eventos.hidden=!1,passReunionB_eventos.hidden=!0,idReunion_eventos.placeholder=tExp("C√≥digo o enlace de la reuni√≥n",""),idReunion_eventos.title=tExp("C√≥digo o enlace de la reuni√≥n","");new bootstrap.Tooltip(idReunion_eventos)}else if(2==appReunion_eventos.value){idReunionB_eventos.hidden=!1,passReunionB_eventos.hidden=!1,idReunion_eventos.placeholder=tExp("Id. reuni√≥n",""),idReunion_eventos.title=tExp("Id. reuni√≥n","");let e=new bootstrap.Tooltip(idReunion_eventos);passReunion_eventos.placeholder=tExp("C√≥digo de acceso",""),passReunion_eventos.title=tExp("C√≥digo de acceso a la reuni√≥n",""),e=new bootstrap.Tooltip(passReunion_eventos)}else if(3==appReunion_eventos.value){idReunionB_eventos.hidden=!1,passReunionB_eventos.hidden=!0,idReunion_eventos.placeholder=tExp("ID de reuni√≥n o nombre de enlace personal",""),idReunion_eventos.title=tExp("ID de reuni√≥n o nombre de enlace personal","");new bootstrap.Tooltip(idReunion_eventos)}return!1}function abrirWebReunion(){var e="";1==appReunion_eventos.value?e=enlaceGoogleMeet(idReunion_eventos.value):2==appReunion_eventos.value?e="https://www.microsoft.com/microsoft-teams/join-a-meeting":3==appReunion_eventos.value&&(e=enlaceJoin(idReunion_eventos.value)),""!=e&&abrirVentanaUnica(e)}function enlaceGoogleMeet(e){var t=e.indexOf("meet.google.com/");return-1==t?"https://meet.google.com/"+e:-1==(t=e.indexOf("https://"))?"https://"+e:e}function enlaceJoin(e){var t=e.indexOf("zoom.us/");return-1==t?"https://zoom.us/j/"+e:-1==(t=e.indexOf("https://"))?"https://"+e:e}function detailFormatter1participantes(e,t){var a=[],o=0,n=localStorage.getItem("idiomaPais"),s=" "+mapFormat(t.dom,t.cpo,t.pob,t.pro,t.pai);return $.each(t,(function(e,t){if("ccn"!=e&&t&&""!=t)if(e==!t||""==t);else{let c="",r="";"cod"==e&&(c=tExp("C√≥digo",n),r=t),"per"==e&&(c=tExp("Nombre",n),r=t),"te1"==e&&(c=tExp("Telef√≥no 1",n),r=telFormaNew1(t)),"te2"==e&&(c=tExp("Tel√©fono 2",n),r=telFormaNew1(t)),"cor"==e&&(c=tExp("E-mail",n),r=corFormatNew(t)),"www"==e&&(c=tExp("Web",n),r=webFormatNew(t)),"dom"==e&&(c=tExp("Direcci√≥n",n),r=t,0==o&&(r+=s,o=1)),"cpo"==e&&(c=tExp("C. P.",n),r=t,0==o&&(r+=s,o=1)),"pob"==e&&(c=tExp("Poblaci√≥n",n),r=t,0==o&&(r+=s,o=1)),"pro"==e&&(c=tExp("Provincia",n),r=t,0==o&&(r+=s,o=1)),"pai"==e&&(c=tExp("Pa√≠s",n),r=t,0==o&&(r+=s,o=1)),"nom"==e&&(c=tExp("Empresa",n),r=t),"nif"==e&&(c=tExp("NIF",n),r=t),"dep"==e&&(c=tExp("Departamento",n),r=t),"car"==e&&(c=tExp("Cargo",n),r=t),"rol"==e&&(c=tExp("Rol",n),r=tExp(aRol[t-1],n)),r&&""!=r&&a.push("<div><b>"+c+":</b> "+r+"</div>")}else;})),a.join("")}function eliminarDocumento(){if(!dEstSuscrip())return!1;if(filaNoSeleccionada("tabDocumentos","success1",msjModDocumento))return!1;return new bootstrap.Modal(document.getElementById("formEliminarDocumento")).show(),!1}function dTitColDocumentos(e,t){switch(e){case"es-es":case"es-ES":return tabDocumentosTitCol_es_ES[t];case"ca-es":case"ca-ES":return tabDocumentosTitCol_ca_ES[t];case"eu-es":case"eu-ES":return tabDocumentosTitCol_eu_ES[t];case"gl-es":case"gl-ES":return tabDocumentosTitCol_gl_ES[t];case"en-gb":case"en-GB":return tabDocumentosTitCol_en_GB[t];case"es-mx":case"es-MX":return tabDocumentosTitCol_es_MX[t];case"es-cl":case"es-CL":return tabDocumentosTitCol_es_CL[t];case"es-us":case"es-US":return tabDocumentosTitCol_es_US[t];case"en-us":case"en-US":default:return tabDocumentosTitCol_en_US[t];case"en-ca":case"en-CA":return tabDocumentosTitCol_en_CA[t];case"en-au":case"en-AU":return tabDocumentosTitCol_en_AU[t];case"it-it":case"it-IT":return tabDocumentosTitCol_it_IT[t];case"pt-pt":case"pt-PT":return tabDocumentosTitCol_pt_PT[t];case"pt-br":case"pt-BR":return tabDocumentosTitCol_pt_BR[t];case"fr-fr":case"fr-FR":return tabDocumentosTitCol_fr_FR[t];case"fr-ca":case"fr-CA":return tabDocumentosTitCol_fr_CA[t];case"de-de":case"de-DE":return tabDocumentosTitCol_de_DE[t];case"en-nz":case"en-NZ":return tabDocumentosTitCol_en_NZ[t];case"en-ie":case"en-IE":return tabDocumentosTitCol_en_IE[t];case"en-in":case"en-IN":return tabDocumentosTitCol_en_IN[t];case"en-sg":case"en-SG":return tabDocumentosTitCol_en_SG[t];case"en-hk":case"en-HK":return tabDocumentosTitCol_en_HK[t];case"en-my":case"en-MY":return tabDocumentosTitCol_en_MY[t];case"es-ar":case"es-AR":return tabDocumentosTitCol_es_AR[t];case"es-co":case"es-CO":return tabDocumentosTitCol_es_CO[t];case"es-pe":case"es-PE":return tabDocumentosTitCol_es_PE[t];case"es-uy":case"es-UY":return tabDocumentosTitCol_es_UY[t];case"fr-be":case"fr-BE":case"fr-be":case"fr-BE":return tabDocumentosTitCol_fr_BE[t];case"fr-ch":case"fr-CH":case"fr-ch":case"fr-CH":return tabDocumentosTitCol_fr_CH[t];case"it-ch":case"it-CH":return tabDocumentosTitCol_it_CH[t];case"de-at":case"de-AT":return tabDocumentosTitCol_de_AT[t];case"de-be":case"de-BE":return tabDocumentosTitCol_de_BE[t];case"de-ch":case"de-CH":return tabDocumentosTitCol_de_CH[t];case"es-ve":case"es-VE":return tabDocumentosTitCol_es_VE[t];case"es-gt":case"es-GT":return tabDocumentosTitCol_es_GT[t];case"es-ec":case"es-EC":return tabDocumentosTitCol_es_EC[t];case"es-bo":case"es-BO":return tabDocumentosTitCol_es_BO[t];case"es-cu":case"es-CU":return tabDocumentosTitCol_es_CU[t];case"es-do":case"es-DO":return tabDocumentosTitCol_es_DO[t];case"es-hn":case"es-HN":return tabDocumentosTitCol_es_HN[t];case"es-py":case"es-PY":return tabDocumentosTitCol_es_PY[t];case"es-sv":case"es-SV":return tabDocumentosTitCol_es_SV[t];case"es-ni":case"es-NI":return tabDocumentosTitCol_es_NI[t];case"es-pa":case"es-PA":return tabDocumentosTitCol_es_PA[t];case"en-pk":case"en-PK":return tabDocumentosTitCol_en_PK[t];case"en-ng":case"en-NG":return tabDocumentosTitCol_en_NG[t];case"en-bd":case"en-BD":return tabDocumentosTitCol_en_BD[t];case"en-ph":case"en-PH":return tabDocumentosTitCol_en_PH[t];case"en-tz":case"en-TZ":return tabDocumentosTitCol_en_TZ[t];case"en-za":case"en-ZA":return tabDocumentosTitCol_en_ZA[t];case"en-ke":case"en-KE":return tabDocumentosTitCol_en_KE[t];case"en-ug":case"en-UG":return tabDocumentosTitCol_en_UG[t];case"en-gh":case"en-GH":return tabDocumentosTitCol_en_GH[t];case"en-mw":case"en-MW":return tabDocumentosTitCol_en_MW[t];case"en-zm":case"en-ZM":return tabDocumentosTitCol_en_ZM[t];case"en-zw":case"en-ZW":return tabDocumentosTitCol_en_ZW[t];case"en-cm":case"en-CM":return tabDocumentosTitCol_en_CM[t];case"en-lk":case"en-LK":return tabDocumentosTitCol_en_LK[t];case"fr-cd":case"fr-CD":return tabDocumentosTitCol_fr_CD[t];case"fr-cm":case"fr-CM":return tabDocumentosTitCol_fr_CM[t];case"fr-mg":case"fr-MG":return tabDocumentosTitCol_fr_MG[t];case"fr-ci":case"fr-CI":return tabDocumentosTitCol_fr_CI[t];case"fr-bf":case"fr-BF":return tabDocumentosTitCol_fr_BF[t];case"fr-ne":case"fr-NE":return tabDocumentosTitCol_fr_NE[t];case"fr-sn":case"fr-SN":return tabDocumentosTitCol_fr_SN[t];case"fr-ml":case"fr-ML":return tabDocumentosTitCol_fr_ML[t];case"fr-bj":case"fr-BJ":return tabDocumentosTitCol_fr_BJ[t];case"fr-rw":case"fr-RW":return tabDocumentosTitCol_fr_RW[t];case"fr-td":case"fr-TD":return tabDocumentosTitCol_fr_TD[t];case"fr-gn":case"fr-GN":return tabDocumentosTitCol_fr_GN[t];case"pt-ao":case"pt-AO":return tabDocumentosTitCol_pt_AO[t];case"pt-mz":case"pt-MZ":return tabDocumentosTitCol_pt_MZ[t]}}function libIdioma(e,t){if(libIdioCargado==e)accionesTrasCargaLibIdio(e,t);else{var a="https://cdn.jsdelivr.net/gh/mycontactscloud/app/lib/idio/mcc_"+e+".js",o=document.createElement("script");o.src=a,o.type="text/javascript",o.onload=function(){libIdioCargado=e,accionesTrasCargaLibIdio(e,t)},o.onerror=function(){alert(`Error al cargar ${a}.`)},document.body.appendChild(o)}}function accionesTrasCargaLibIdio(e,t){if(0==t);else if(1==t)document.getElementById("tCambiarIdioma").innerHTML=tExp("Cambiar idioma",e),document.getElementById("tIdiomaAceptar").innerHTML=tExp("Aceptar",e),document.getElementById("tIdiomaCancelar").innerHTML=tExp("Cancelar",e);else if(2==t){cambiarTextoIdioma(e),txtInvitacionInstalar.innerText=translateInstallInvitation(e),txtbtnInstalarApp.innerText=translateInstallApp(e),new bootstrap.Modal(document.getElementById("accesoUsuario")).show()}else if(3==t)cambiarTextoIdioma(e);else if(4==t){var a=localStorage.getItem("estadoSuscripcion");"trialing"==a||"probando"==a?(document.getElementById("promocion").classList.contains("d-none")&&(document.getElementById("promocion").classList.remove("d-none"),txtPromocion1.innerText=fTextPromocion(1),txtPromocion2.innerText=fTextPromocion(2),txtPromocion3.innerText=fTextPromocion(3),txtPromocion4.innerText=fTextPromocion(4)),document.getElementById("filaPruebas").classList.contains("d-none")&&document.getElementById("filaPruebas").classList.remove("d-none"),"0"==localStorage.getItem("pruebaCancelada")?(colPruebas1.innerText=fColPruebas1(),txtSug1()):colPruebas1.innerText=fColPruebas3()):"canceled"==a||"cancelado"==a?(document.getElementById("filaPruebas").classList.contains("d-none")&&document.getElementById("filaPruebas").classList.remove("d-none"),colPruebas1.innerHTML=fColPruebas4(),txtSug1()):(document.getElementById("promocion").classList.contains("d-none")||document.getElementById("promocion").classList.add("d-none"),document.getElementById("filaPruebas").classList.contains("d-none")||document.getElementById("filaPruebas").classList.add("d-none")),cambiarTextoIdiomaDiv(e,"modalMenu"),activarTooltipsDiv("modalMenu")}else if(5==t){cambiarTextoIdioma(e),new bootstrap.Modal(document.getElementById("modalPlanes")).show()}else if(8==t){cambiarPolPri(),new bootstrap.Modal(document.getElementById("modalPoliticaPrivacidad")).show()}else if(9==t){cambiarTerCon(),new bootstrap.Modal(document.getElementById("modalCondicionesUso")).show()}else if(10==t){"trialing"==localStorage.getItem("estadoSuscripcion")||"probando"==localStorage.getItem("estadoSuscripcion")?(document.getElementById("pruebaOK").classList.contains("d-none")&&document.getElementById("pruebaOK").classList.remove("d-none"),document.getElementById("compraOK").classList.contains("d-none")||document.getElementById("compraOK").classList.add("d-none"),document.getElementById("txtPruebaActivada").innerText=txtPruebas5()):(document.getElementById("pruebaOK").classList.contains("d-none")||document.getElementById("pruebaOK").classList.add("d-none"),document.getElementById("compraOK").classList.contains("d-none")&&document.getElementById("compraOK").classList.remove("d-none")),cambiarTextoIdioma(e),activarTooltips(),new bootstrap.Modal(document.getElementById("modalFinCompra")).show()}}function translateInstallApp(e){const t={es:"Instalar app",en:"Install app",fr:"Installer l'application",it:"Installa app",pt:"Instalar app",de:"App installieren",ca:"Instal¬∑lar app",gl:"Instalar aplicaci√≥n"};return t[e.substring(0,2).toLowerCase()]||t.en}function translateInstallInvitation(e){const t={es:"Instala nuestra app y accede m√°s r√°pido a todas sus funciones.",en:"Install our app and access all features faster.",fr:"Installez notre application et acc√©dez plus rapidement √† toutes ses fonctionnalit√©s.",it:"Installa la nostra app e accedi pi√π velocemente a tutte le funzionalit√†.",pt:"Instale nosso app e acesse mais r√°pido todos os recursos.",de:"Installieren Sie unsere App und greifen Sie schneller auf alle Funktionen zu.",ca:"Instal¬∑la la nostra app i accedeix m√©s r√†pidament a totes les funcions.",gl:"Instala a nosa app e accede m√°is r√°pido a todas as funci√≥ns."};return t[e.substring(0,2).toLowerCase()]||t.en}function importSelectedGoogle(){if(!dEstSuscrip())return!1;const e=$("#tabImportGoogle").bootstrapTable("getSelections");let t=new FormData;t.append("prefijo",localStorage.getItem("prefijo")),t.append("plan",localStorage.getItem("plan")),t.append("maxRegFree",localStorage.getItem("maxRegFree")),t.append("contImpor",JSON.stringify(e,null,2)),async function(){const e=await fetch("https://"+window.location.host+"/importms",{method:"POST",body:t});return await e.json()}().then((e=>{if(e.success){var t=e.data.value1;if(0==t)var a=tExp("No se import√≥ nada","");if(1==t)a=tExp("Se import√≥ un registro","");if(t>1)a=t+" "+tExp("registros importados","");modMsj(2,"My Contacts Cloud",a,msjImportGoogle,!1)}else"K1"==e.message?modMsjFinPruebaToast("import001","My Contacts Cloud",txtFinPrueba1(),txtFinPrueba2()):"K2"==e.message?modMsj(2,"My Contacts Cloud",tExp("Te recomendamos cambiar a un plan PRO superior para poder a√±adir m√°s contactos","")+'.<br><center><button type="button" class="btn btn-success" data-bs-dismiss="modal" onClick="abrirModal1DesdeFicha(2)">Mi suscripci√≥n</button></center>',msjImportGoogle,!1):toastSelFila(tExp(e.message,""),msjImportGoogle)})).catch((e=>{toastSelFila(tExp(e.message,""),msjImportGoogle)}))}function importSelectedMs(){if(!dEstSuscrip())return!1;const e=$("#tabImportMs").bootstrapTable("getSelections");let t=new FormData;t.append("prefijo",localStorage.getItem("prefijo")),t.append("plan",localStorage.getItem("plan")),t.append("maxRegFree",localStorage.getItem("maxRegFree")),t.append("contImpor",JSON.stringify(e,null,2)),async function(){const e=await fetch("https://"+window.location.host+"/importms",{method:"POST",body:t});return await e.json()}().then((e=>{if(e.success){var t=e.data.value1;if(0==t)var a=tExp("No se import√≥ nada","");if(1==t)a=tExp("Se import√≥ un registro","");if(t>1)a=t+" "+tExp("registros importados","");modMsj(2,"My Contacts Cloud",a,msjImportMs,!1)}else"K1"==e.message?modMsjFinPruebaToast("import001","My Contacts Cloud",txtFinPrueba1(),txtFinPrueba2()):"K2"==e.message?modMsj(2,"My Contacts Cloud",tExp("Te recomendamos cambiar a un plan PRO superior para poder a√±adir m√°s contactos","")+'.<br><center><button type="button" class="btn btn-success" data-bs-dismiss="modal" onClick="abrirModal1DesdeFicha(2)">Mi suscripci√≥n</button></center>',msjImportGoogle,!1):toastSelFila(tExp(e.message,""),msjImportMs)})).catch((e=>{toastSelFila(tExp(e.message,""),msjImportMs)}))}function importSelectedApple(){if(!dEstSuscrip())return!1;const e=$("#tabImportApple").bootstrapTable("getSelections");let t=new FormData;t.append("prefijo",localStorage.getItem("prefijo")),t.append("plan",localStorage.getItem("plan")),t.append("maxRegFree",localStorage.getItem("maxRegFree")),t.append("contImpor",JSON.stringify(e,null,2)),async function(){const e=await fetch("https://"+window.location.host+"/importms",{method:"POST",body:t});return await e.json()}().then((e=>{if(e.success){var t=e.data.value1;if(0==t)var a=tExp("No se import√≥ nada","");if(1==t)a=tExp("Se import√≥ un registro","");if(t>1)a=t+" "+tExp("registros importados","");modMsj(2,"My Contacts Cloud",a,msjImportApple,!1)}else"K1"==e.message?modMsjFinPruebaToast("import001","My Contacts Cloud",txtFinPrueba1(),txtFinPrueba2()):"K2"==e.message?modMsj(2,"My Contacts Cloud",tExp("Te recomendamos cambiar a un plan PRO superior para poder a√±adir m√°s contactos","")+'.<br><center><button type="button" class="btn btn-success" data-bs-dismiss="modal" onClick="abrirModal1DesdeFicha(2)">Mi suscripci√≥n</button></center>',msjImportApple,!1):toastSelFila(tExp(e.message,""),msjImportApple)})).catch((e=>{toastSelFila(tExp("ID de Apple o contrase√±a incorrecta",""),msjImportApple)}))}function elementoGrupoFormat(e){return dataGruposContactos.find((t=>t.numElemento==e)).desElemento}function populateSelect(e,t){const a=document.getElementById(e);a.innerHTML="",t.forEach((e=>{const t=document.createElement("option");t.textContent=e.desElemento,t.value=e.numElemento,a.appendChild(t)}))}function getSelectedValues(e){const t=document.getElementById(e);return Array.from(t.selectedOptions).map((e=>parseInt(e.value,10)))}function cambiarIconoBotonFiltrado(e){cambiarIconoBotonFiltradoBis(document.getElementById("botonFiltrado"),e),cambiarIconoBotonFiltradoBis(document.getElementById("botonFiltrado1"),e)}function cambiarIconoBotonFiltradoBis(e,t){const a=e.querySelector("i");1==t?a.classList.contains("bi-funnel")&&(a.classList.remove("bi-funnel"),a.classList.add("bi-funnel-fill")):a.classList.contains("bi-funnel-fill")&&(a.classList.remove("bi-funnel-fill"),a.classList.add("bi-funnel"))}function predGrupoContactos(e){const t=dataGruposContactos.find((t=>t.numGrupo===e&&1===t.predeterminado));return t?t.numElemento:null}function titColtabImportGoogle(){Object.entries({name:"Nombre",email:"E-mail",phone1:"Tel√©fono 1",phone2:"Tel√©fono 2",company:"Empresa",notes:"Notas"}).forEach((([e,t])=>{$("#tabImportGoogle").bootstrapTable("updateColumnTitle",{field:e,title:tExp(t,"")})}))}function titColtabImportMs(){Object.entries({name:"Nombre",email:"E-mail",phone1:"Tel√©fono 1",phone2:"Tel√©fono 2",company:"Empresa",notes:"Notas"}).forEach((([e,t])=>{$("#tabImportMs").bootstrapTable("updateColumnTitle",{field:e,title:tExp(t,"")})}))}function titColtabImportApple(){Object.entries({name:"Nombre",email:"E-mail",phone1:"Tel√©fono 1",phone2:"Tel√©fono 2",company:"Empresa",notes:"Notas"}).forEach((([e,t])=>{$("#tabImportApple").bootstrapTable("updateColumnTitle",{field:e,title:tExp(t,"")})}))}function isCssLoaded(e){return Array.from(document.styleSheets).some((t=>t.href===e.url))}function isJsLoaded(e){return Array.from(document.scripts).some((t=>t.src===e.url))}async function cargarLibCss(e){return isCssLoaded(e)?(console.log(`CSS ya cargado: ${e.url}`),!0):new Promise(((t,a)=>{const o=document.createElement("link");o.rel="stylesheet",o.href=e.url,e.integrity&&(o.integrity=e.integrity),e.crossorigin&&(o.crossOrigin=e.crossorigin),o.onload=()=>t(!0),o.onerror=()=>a(`Error cargando CSS: ${e.url}`),document.head.appendChild(o)}))}async function cargarLibJs(e){return isJsLoaded(e)?(console.log(`JS ya cargado: ${e.url}`),!0):new Promise(((t,a)=>{const o=document.createElement("script");o.src=e.url,o.defer=!0,e.integrity&&(o.integrity=e.integrity),e.crossorigin&&(o.crossOrigin=e.crossorigin),o.onload=()=>t(!0),o.onerror=()=>a(`Error cargando JS: ${e.url}`),document.body.appendChild(o)}))}async function libsTablas(){if(libsCargadas)return document.body.classList.remove("loading"),document.getElementById("spinnerPrincipal").style.display="none",!0;try{const e=libCss.map(cargarLibCss);await Promise.all(e);for(const e of libJs)await cargarLibJs(e);for(const e of libResto)await cargarLibJs(e);return libsCargadas=!0,document.body.classList.remove("loading"),document.getElementById("spinnerPrincipal").style.display="none",!0}catch(e){return console.log("Error en la carga de uno o m√°s recursos:",e),!1}}async function opPrincipalNoMenu(e){await libsTablas(),cambioDiv("",e,0,0)}function iniFullalendar(e){localStorage.setItem("vistaIni",e),localStorage.setItem("codContactoNlistadoEventos",""),nombrePersonaContacto="",setTimeout((function(){cambioDiv("menu","eventos",0,0)}),500)}function ocultarModal(e){var t=document.getElementById(e),a=bootstrap.Modal.getInstance(t);a&&a.hide()}function txtFinPrueba1(){switch(localStorage.getItem("idiomaPais").substring(0,2)){case"es":return"Tu productividad merece m√°s";case"fr":return"Votre productivit√© m√©rite plus";case"it":return"La tua produttivit√† merita di pi√π";case"de":return"Ihre Produktivit√§t verdient mehr";case"pt":return"Sua produtividade merece mais";case"ca":return"La teva productivitat mereix m√©s";case"gl":return"A t√∫a produtividade merece m√°is";default:return"Your productivity deserves more"}}function txtFinPrueba2(){switch(localStorage.getItem("idiomaPais").substring(0,2)){case"es":return"Simplifica la gesti√≥n de tus contactos, interacciones, documentos y eventos";case"fr":return"Simplifiez la gestion de vos contacts, interactions, documents et √©v√©nements";case"it":return"Semplifica la gestione dei tuoi contatti, interazioni, documenti ed eventi";case"de":return"Vereinfachen Sie die Verwaltung Ihrer Kontakte, Interaktionen, Dokumente und Veranstaltungen";case"pt":return"Simplifique a gest√£o dos seus contatos, intera√ß√µes, documentos e eventos";case"ca":return"Simplifica la gesti√≥ dels teus contactes, interaccions, documents i esdeveniments";case"gl":return"Simplifica a xesti√≥n dos teus contactos, interacci√≥ns, documentos e eventos";default:return"Simplify the management of your contacts, interactions, documents, and events"}}function fColPruebas1(){let e=localStorage.getItem("idiomaPais"),t=0;if(t="probando"==localStorage.getItem("estadoSuscripcion")?parseInt(localStorage.getItem("diasPruebaRestantes"),10):parseInt(localStorage.getItem("diasPruebaRestantes"),10)+1,t>=1)switch(e.substring(0,2)){case"es":return"En periodo de prueba. D√≠as restantes: "+t;case"fr":return"En p√©riode d'essai. Jours restants : "+t;case"it":return"In periodo di prova. Giorni rimanenti: "+t;case"de":return"Im Testzeitraum. Verbleibende Tage: "+t;case"pt":return"Em per√≠odo de teste. Dias restantes: "+t;case"ca":return"En per√≠ode de prova. Dies restants: "+t;case"gl":return"En per√≠odo de proba. D√≠as restantes: "+t;default:return"In trial period. Days remaining: "+t}}function fColPruebas3(){let e=localStorage.getItem("idiomaPais"),t=parseInt(localStorage.getItem("diasPruebaRestantes"),10)+1;switch(e.substring(0,2)){case"es":return"Prueba cancelada. D√≠as restantes: "+t;case"fr":return"Essai annul√©. Jours restants : "+t;case"it":return"Prova annullata. Giorni rimanenti: "+t;case"de":return"Probe abgebrochen. Verbleibende Tage: "+t;case"pt":return"Prova cancelada. Dias restantes: "+t;case"ca":return"Prova cancel¬∑lada. Dies restants: "+t;case"gl":return"Proba cancelada. D√≠as restantes: "+t;default:return"Trial canceled. Days remaining: "+t}}function fColPruebas4(){switch(localStorage.getItem("idiomaPais").substring(0,2)){case"es":return'Prueba finalizada. <a href="javascript:void(0);" onclick="opPrincipal(10);">Consulta los Planes PRO</a>';case"fr":return'Essai termin√©. <a href="javascript:void(0);" onclick="opPrincipal(10);">Consultez les Plans PRO</a>';case"it":return'Prova terminata. <a href="javascript:void(0);" onclick="opPrincipal(10);">Consulta i Piani PRO</a>';case"de":return'Test abgeschlossen. <a href="javascript:void(0);" onclick="opPrincipal(10);">Schauen Sie sich die PRO-Pl√§ne an</a>';case"pt":return'Teste conclu√≠do. <a href="javascript:void(0);" onclick="opPrincipal(10);">Consulte os Planos PRO</a>';case"ca":return'Prova finalitzada. <a href="javascript:void(0);" onclick="opPrincipal(10);">Consulta els Plans PRO</a>';case"gl":return'Proba finalizada. <a href="javascript:void(0);" onclick="opPrincipal(10);">Consulta os Plans PRO</a>';default:return'Trial completed. <a href="javascript:void(0);" onclick="opPrincipal(10);">Check out the PRO Plans</a>'}}function txtSug1(){let e=localStorage.getItem("idiomaPais");switch(e.substring(0,2)){case"es":sug11.innerText="Sugerencia",sug12.innerText="Importa tus contactos de",sug13.innerText="y",sug14.innerText="haciendo clic sobre",sug15.innerText="Importar";break;case"fr":sug11.innerText="Suggestion",sug12.innerText="Importez vos contacts depuis",sug13.innerText="et",sug14.innerText="en cliquant sur",sug15.innerText="Importer";break;case"it":sug11.innerText="Suggerimento",sug12.innerText="Importa i tuoi contatti da",sug13.innerText="e",sug14.innerText="cliccando su",sug15.innerText="Importa";break;case"de":sug11.innerText="Vorschlag",sug12.innerText="Importiere deine Kontakte aus",sug13.innerText="und",sug14.innerText="indem Sie auf klicken",sug15.innerText="Importieren";break;case"pt":sug11.innerText="Sugest√£o",sug12.innerText="pt-BR"==e||"pt-br"==e?"Importe seus contatos de":"Importe seus contactos de",sug13.innerText="e",sug14.innerText="clicando em",sug15.innerText="Importar";break;case"ca":sug11.innerText="Suggeriment",sug12.innerText="Importa els teus contactes de",sug13.innerText="i",sug14.innerText="fent clic a",sug15.innerText="Importar";break;case"gl":sug11.innerText="Suxesti√≥n",sug12.innerText="Importa os teus contactos de",sug13.innerText="e",sug14.innerText="clicando sobre",sug15.innerText="Importar";break;default:sug11.innerText="Suggestion",sug12.innerText="Import your contacts from",sug13.innerText="and",sug14.innerText="by clicking on",sug15.innerText="Import"}}function txtPruebas5(){switch(localStorage.getItem("idiomaPais").substring(0,2)){case"es":return"Prueba activada";case"fr":return"Essai activ√©";case"it":return"Prova attivata";case"de":return"Probe aktiviert";case"pt":return"Prova ativada";case"ca":return"Prova activada";case"gl":return"Proba activada";default:return"Trial activated"}}function txtPagosPendientes(){switch(localStorage.getItem("idiomaPais").substring(0,2)){case"es":return"Resuelve los pagos pendientes (bot√≥n 'Suscripci√≥n')";case"fr":return"R√©solvez les paiements en attente (bouton 'Abonnement')";case"it":return"Risolvi i pagamenti in sospeso (pulsante 'Abbonamento')";case"de":return"Begleichen Sie ausstehende Zahlungen (Schaltfl√§che 'Abonnement')";case"pt":return"Resolva os pagamentos pendentes (bot√£o 'Assinatura')";case"ca":return"Resol els pagaments pendents (bot√≥ 'Subscripci√≥')";case"gl":return"Resolve os pagos pendentes (bot√≥n 'Subscrici√≥n')";default:return"Resolve pending payments (button 'Subscription')"}}function txtSuscripcionNuevoPlan(){switch(localStorage.getItem("idiomaPais").substring(0,2)){case"es":return"Suscr√≠bete a un nuevo plan (bot√≥n 'Planes PRO')";case"fr":return"Abonnez-vous √† un nouveau plan (bouton 'Plans PRO')";case"it":return"Abbonati a un nuovo piano (pulsante 'Piani PRO')";case"de":return"Abonnieren Sie einen neuen Plan (Schaltfl√§che 'PRO-Pl√§ne')";case"pt":return"Assine um novo plano (bot√£o 'Planos PRO')";case"ca":return"Subscriu-te a un nou pla (bot√≥ 'Plans PRO')";case"gl":return"Subscr√≠bete a un novo plan (bot√≥n 'Plans PRO')";default:return"Subscribe to a new plan (button 'PRO Plans')"}}function txtCambiarPlan(){switch(localStorage.getItem("idiomaPais").substring(0,2)){case"es":case"gl":return"Cambiar";case"fr":return"Changer";case"it":return"Cambiare";case"de":return"√Ñndern";case"pt":return"Mudar";case"ca":return"Canviar";default:return"Change"}}function dEstSuscrip(){let e=localStorage.getItem("estadoSuscripcion"),t=localStorage.getItem("pruebaCancelada");return"trialing"==e&&"0"==t||"probando"==e&&"0"==t||"active"==e||""==e||("canceled"==e||"cancelado"==e)&&(modMsjFinPruebaToast("principal002","My Contacts Cloud",txtFinPrueba1(),txtFinPrueba2()),!1)}function txtPlanCambiado(){switch(localStorage.getItem("idiomaPais").substring(0,2)){case"es":case"gl":return"Plan cambiado";case"fr":return"Plan chang√©";case"it":return"Piano cambiato";case"de":return"Ge√§nderter Plan";case"pt":return"Plano mudado";case"ca":return"Pla canviat";default:return"Changed plan"}}function txtCambiarPlanAhora(){switch(localStorage.getItem("idiomaPais").substring(0,2)){case"es":case"gl":return"Cambiar plan";case"fr":return"Changer de plan";case"it":return"Cambiare piano";case"de":return"Plan √§ndern";case"pt":return"Mudar de plano";case"ca":return"Canviar pla";default:return"Change plan"}}function txtProbarPlanAhora(){switch(localStorage.getItem("idiomaPais").substring(0,2)){case"es":case"gl":return"Probar plan";case"fr":return"Essayer un plan";case"it":return"Provare un piano";case"de":return"Plan ausprobieren";case"pt":return"Experimentar plano";case"ca":return"Provar pla";default:return"Try plan"}}function bPlanStripe(e){let t=localStorage.getItem("estadoSuscripcion");""==t?nuevaSesionStripe(e,0):"canceled"==t||"cancelado"==t||"probando"==t?nuevaSesionStripe(e,1):"trialing"==t?mostrarModal(txtCambiarPlan(),(function(){cambiarPlanEnStripe(e)})):abrirPortalStripe()}function autorizacionContactosGoogleMicrosoft(e){switch(localStorage.getItem("idiomaPais").substring(0,2)){case"es":return"My Contacts Cloud solicita tu permiso para ver y descargar tus contactos de "+e+". Visualizaremos los datos en una tabla para que selecciones los contactos que desees importar.";case"fr":return"My Contacts Cloud vous demande la permission de consulter et t√©l√©charger vos contacts "+e+". Nous afficherons les donn√©es dans un tableau pour que vous puissiez s√©lectionner les contacts que vous souhaitez importer.";case"it":return"My Contacts Cloud richiede il tuo permesso per visualizzare e scaricare i tuoi contatti "+e+". Visualizzeremo i dati in una tabella in modo che tu possa selezionare i contatti che desideri importare.";case"de":return"My Contacts Cloud bittet um Ihre Erlaubnis, Ihre "+e+"-Kontakte einzusehen und herunterzuladen. Wir werden die Daten in einer Tabelle anzeigen, damit Sie die Kontakte ausw√§hlen k√∂nnen, die Sie importieren m√∂chten.";case"pt":return"O My Contacts Cloud solicita sua permiss√£o para ver e baixar seus contatos do "+e+". Exibiremos os dados em uma tabela para que voc√™ possa selecionar os contatos que deseja importar.";case"ca":return"My Contacts Cloud sol¬∑licita el teu perm√≠s per veure i descarregar els teus contactes de "+e+". Mostrarem les dades en una taula perqu√® puguis seleccionar els contactes que vulguis importar.";case"gl":return"My Contacts Cloud solicita o teu permiso para ver e descargar os teus contactos de "+e+". Amosaremos os datos nunha t√°boa para que poidas seleccionar os contactos que desexes importar.";default:return"My Contacts Cloud requests your permission to view and download your "+e+" contacts. We will display the data in a table so you can select the contacts you wish to import."}}function txtContrasenaIncorrecta(){switch(localStorage.getItem("idiomaPais").substring(0,2)){case"es":return"Contrase√±a incorrecta";case"fr":return"Mot de passe incorrect";case"it":return"Password errata";case"de":return"Falsches Passwort";case"pt":return"Senha incorreta";case"ca":return"Contrasenya incorrecta";case"gl":return"Contrasinal incorrecto";default:return"Incorrect password"}}function saveColumnConfig(e){const t=$("#"+e).bootstrapTable("getOptions"),a=$("#"+e).bootstrapTable("getVisibleColumns").map((e=>e.field)),o=t.columns[0].map(((e,t)=>({field:e.field,visible:a.includes(e.field),order:t}))),n={sortName:t.sortName,sortOrder:t.sortOrder};localStorage.setItem("tableColumnConfig_"+e,JSON.stringify(o)),localStorage.setItem("tableSortConfig_"+e,JSON.stringify(n))}function loadColumnConfig(e){const t=localStorage.getItem("tableColumnConfig_"+e),a=localStorage.getItem("tableSortConfig_"+e);if(t&&a){const o=JSON.parse(t),n=JSON.parse(a);o.sort(((e,t)=>e.order-t.order)),o.forEach((t=>{t.visible?$("#"+e).bootstrapTable("showColumn",t.field):$("#"+e).bootstrapTable("hideColumn",t.field)}));const s=o.map((e=>e.field)),c=$("#"+e).bootstrapTable("getOptions").columns[0];$("#"+e).bootstrapTable("refreshOptions",{columns:c.sort(((e,t)=>s.indexOf(e.field)-s.indexOf(t.field))),sortName:n.sortName,sortOrder:n.sortOrder})}}function camposSummernote(){$("#pr1_contactos").summernote("code",pr1_contactos.defaultValue),$("#pr2_contactos").summernote("code",pr2_contactos.defaultValue),$("#pr3_contactos").summernote("code",pr3_contactos.defaultValue),$("#pr4_contactos").summernote("code",pr4_contactos.defaultValue),$("#pr5_contactos").summernote("code",pr5_contactos.defaultValue),$("#pr6_contactos").summernote("code",pr6_contactos.defaultValue),$("#noa_contactos").summernote("code",noa_contactos.defaultValue)}function exportarTabla(e,t,a,o,n){if(!dEstSuscrip())return!1;t=tExp(t,""),a=tExp(a,"");for(var s=$("#"+e),c=[],r=s.bootstrapTable("getOptions").columns[0],i=0;i<r.length;i++)(!r[i].visible||r[i].forceHide||r[i].printIgnore)&&c.push(r[i].field);var l=s.bootstrapTable("getData").map((function(t){var a={...t};return"tabContactos"==e?(void 0!==a.rol&&(a.rol=tExp(aRol[a.rol-1],"")),void 0!==a.eg1&&(a.eg1=elementoGrupoFormat(a.eg1)),void 0!==a.eg2&&(a.eg2=elementoGrupoFormat(a.eg2)),void 0!==a.eg3&&(a.eg3=elementoGrupoFormat(a.eg3)),void 0!==a.alt&&(a.alt=formatoFecha(a.alt)),void 0!==a.ani&&(a.ani=formatoFecha(a.ani)),void 0!==a.fin&&(a.fin=formatoFecha(a.fin)),void 0!==a.ffi&&(a.ffi=formatoFecha(a.ffi)),a.eti=etiFormatPrint(a.et1,a.et2,a.et3)):"tabInteracciones"==e?(void 0!==a.tipi&&(a.tipi=tExp(aTipoInteraccion[a.tipi-1],"")),void 0!==a.etai&&(a.etai=tExp(aEtapaInteraccion[a.etai-1],"")),void 0!==a.resi&&(a.resi=tExp(aResultadoInteraccion[a.resi-1],"")),void 0!==a.peni&&(a.peni=tExp(aAccionInteraccion[a.peni-1],"")),void 0!==a.fhii&&(a.fhii=formatoFechaHoraInternacional(a.fhii)),void 0!==a.reci&&(a.reci=formatoFechaHoraInternacional(a.reci))):"tabRecordatorios"==e&&(void 0!==a.recr&&(a.recr=formatoFechaHoraInternacional(a.recr)),void 0!==a.penr&&(a.penr=tExp(aAccionInteraccion[a.penr-1],""))),void 0!==a.fec&&(a.fec=formatoFecha(a.fec)),a})),d=r.filter((e=>e.visible&&!c.includes(e.field))),u=d.map((e=>e.title));switch(n){case"pdf":exportarTablaPDF(t,a,o,c,d,l);break;case"xlsx":case"csv":case"txt":case"ods":case"xml":exportarConSheetJS(l,d,u,t,n);break;case"json":exportarJson(l,d,u,t);break;case"html":exportarTablaHTML(l,d,u,t);break;case"sql":exportarTablaSQL(l,d,u,t);break;default:console.error("Formato no soportado: "+n)}}function exportarTablaPDF(e,t,a,o,n,s){const{jsPDF:c}=window.jspdf;var r=new c(a,"pt",formatoPapel()),i=formatoFecha(obtenerFechaActual());r.setFontSize(12),r.text(t,40,40),r.text(i,500,40);var l=s.map((e=>n.map((t=>limpiarHtml(e[t.field])))));r.autoTable({head:[n.map((e=>e.title))],body:l,startY:60,margin:{top:50},styles:{fontSize:10,cellPadding:5},theme:"grid",headStyles:{fillColor:[0,123,255],textColor:[255,255,255]},alternateRowStyles:{fillColor:[245,245,245]}});for(var d=r.internal.getNumberOfPages(),u=1;u<=d;u++)r.setPage(u),r.text(`${u} / ${d}`,r.internal.pageSize.getWidth()-60,r.internal.pageSize.getHeight()-10);r.save(e+".pdf")}function exportarConSheetJS(e,t,a,o,n){var s=[a];e.forEach((e=>{var a=t.map((t=>e[t.field]));s.push(a)}));var c=XLSX.utils.book_new(),r=XLSX.utils.aoa_to_sheet(s);XLSX.utils.book_append_sheet(c,r,o),XLSX.writeFile(c,o+"."+n)}function exportarTablaHTML(e,t,a,o){var n="<table><thead><tr>";a.forEach((e=>{n+=`<th>${e}</th>`})),n+="</tr></thead><tbody>",e.forEach((e=>{n+="<tr>",t.forEach((t=>{n+=`<td>${e[t.field]}</td>`})),n+="</tr>"})),n+="</tbody></table>";var s=new Blob([n],{type:"text/html"}),c=document.createElement("a");c.href=URL.createObjectURL(s),c.download=o+".html",c.click()}function exportarTablaSQL(e,t,a,o){var n=`CREATE TABLE ${o} (${a.join(", ")});\n`;e.forEach((e=>{var s=t.map((t=>`'${e[t.field]}'`)).join(", ");n+=`INSERT INTO ${o} (${a.join(", ")}) VALUES (${s});\n`}));var s=new Blob([n],{type:"text/sql"}),c=document.createElement("a");c.href=URL.createObjectURL(s),c.download=o+".sql",c.click()}function exportarJson(e,t,a,o){var n=e.map((function(e){var o={};return t.forEach((function(t,n){o[a[n]]=e[t.field]})),o})),s=JSON.stringify(n,null,2),c=new Blob([s],{type:"application/json"}),r=document.createElement("a");r.href=URL.createObjectURL(c),r.download=o+".json",r.click(),URL.revokeObjectURL(r.href)}function obtenerFechaActual(){var e=new Date;return e.getFullYear()+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+("0"+e.getDate()).slice(-2)}function limpiarHtml(e){var t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""}function formatoPapel(){switch(localStorage.getItem("idiomaPais")){case"en-us":case"en-US":case"es-us":case"es-US":case"en-ca":case"en-CA":case"fr-ca":case"fr-CA":case"es-mx":case"es-MX":case"es-cl":case"es-CL":case"es-co":case"es-CO":case"en-ph":case"en-PH":case"fil-ph":case"fil-PH":case"es-pa":case"es-PA":case"es-do":case"es-DO":case"es-ve":case"es-VE":case"es-cr":case"es-CR":case"es-gt":case"es-GT":case"es-sv":case"es-SV":case"es-ni":case"es-NI":case"es-hn":case"es-HN":case"es-pr":case"es-PR":return"letter";default:return"a4"}}function imprimirTabla(e,t,a){if(!dEstSuscrip())return!1;t=tExp(t,"");for(var o=formatoFecha(obtenerFechaActual()),n=$("#"+e),s=[],c=n.bootstrapTable("getOptions").columns[0],r=0;r<c.length;r++)(!c[r].visible||c[r].forceHide||c[r].printIgnore)&&s.push(c[r].field);var i=n.bootstrapTable("getData").map((function(t){var a={...t};return"tabContactos"==e?(void 0!==a.rol&&(a.rol=tExp(aRol[a.rol-1],"")),void 0!==a.eg1&&(a.eg1=elementoGrupoFormat(a.eg1)),void 0!==a.eg2&&(a.eg2=elementoGrupoFormat(a.eg2)),void 0!==a.eg3&&(a.eg3=elementoGrupoFormat(a.eg3)),void 0!==a.alt&&(a.alt=formatoFecha(a.alt)),void 0!==a.ani&&(a.ani=formatoFecha(a.ani)),void 0!==a.fin&&(a.fin=formatoFecha(a.fin)),void 0!==a.ffi&&(a.ffi=formatoFecha(a.ffi)),a.eti=etiFormatPrint(a.et1,a.et2,a.et3)):"tabInteracciones"==e?(void 0!==a.tipi&&(a.tipi=tExp(aTipoInteraccion[a.tipi-1],"")),void 0!==a.etai&&(a.etai=tExp(aEtapaInteraccion[a.etai-1],"")),void 0!==a.resi&&(a.resi=tExp(aResultadoInteraccion[a.resi-1],"")),void 0!==a.peni&&(a.peni=tExp(aAccionInteraccion[a.peni-1],"")),void 0!==a.fhii&&(a.fhii=formatoFechaHoraInternacional(a.fhii)),void 0!==a.reci&&(a.reci=formatoFechaHoraInternacional(a.reci))):"tabRecordatorios"==e&&(void 0!==a.recr&&(a.recr=formatoFechaHoraInternacional(a.recr)),void 0!==a.penr&&(a.penr=tExp(aAccionInteraccion[a.penr-1],""))),void 0!==a.fec&&(a.fec=formatoFecha(a.fec)),a})),l=c.filter((e=>e.visible&&!s.includes(e.field))),d=`\n    <html>\n    <head>\n        <style>\n            @media print {\n                @page {\n                    size: ${a}; /* portrait o landscape */\n                    margin: 20mm;\n                }\n            }\n            body {\n                font-family: Arial, sans-serif;\n                font-size: 14px; /* Tama√±o de letra general */\n                margin: 20px;\n            }\n            table {\n                border-collapse: collapse;\n                width: 100%;\n                margin-top: 20px;\n                font-size: 12px; /* Tama√±o de letra de la tabla */\n            }\n            table, th, td {\n                border: 1px solid #dddddd;\n            }\n            th, td {\n                padding: 8px;\n                text-align: left;\n            }\n            th {\n                background-color: #f2f2f2;\n                font-weight: bold;\n                text-align: center;\n            }\n            tr:nth-child(even) {\n                background-color: #f9f9f9;\n            }\n            tr:hover {\n                background-color: #f1f1f1;\n            }\n            h2 {\n                text-align: center;\n                font-size: 18px; /* Tama√±o de letra del t√≠tulo */\n            }\n            .header {\n                display: flex;\n                justify-content: space-between;\n                align-items: center;\n                margin-bottom: 20px;\n                font-size: 16px; /* Tama√±o de letra del encabezado */\n            }\n            .header-title {\n                font-weight: bold;\n                text-align: left;\n            }\n            .header-date {\n                text-align: right;\n                font-size: 14px; /* Tama√±o de letra de la fecha */\n                color: gray;\n            }\n        </style>\n    </head>\n    <body>\n        <div class="header">\n            <span class="header-title">${t}</span>\n            <span class="header-date">${o}</span>\n        </div>\n        <table>\n            <thead><tr>`;l.forEach((e=>{d+=`<th>${e.title}</th>`})),d+="</tr></thead><tbody>",i.forEach((e=>{d+="<tr>",l.forEach((t=>{d+=`<td>${e[t.field]}</td>`})),d+="</tr>"})),d+="\n        </tbody>\n        </table>\n    </body>\n    </html>";var u=Math.min(window.innerWidth,1200),p=Math.min(window.innerHeight,800),m=window.open("","",`width=${u},height=${p},resizable=yes`);m.document.write(d),m.document.close(),m.onload=function(){m.focus(),m.print(),m.close()}}function obtenerIndicePorId(e,t,a){return $("#"+e).bootstrapTable("getData").findIndex((function(e){return e[t]===a}))}function irAPaginaConRegistro(e,t,a,o,n){var s=$("#"+e),c=s.bootstrapTable("getOptions"),r=c.pageSize,i=c.pageNumber,l=Math.ceil((t+1)/r);l!==i?s.bootstrapTable("selectPage",l):selRowTab(e,a,o,n)}function selRowTab(e,t,a,o){if(indiceFilaTab=-1,document.querySelectorAll("#"+e+" tbody ."+t).forEach((e=>e.classList.remove(t))),window[a]="",null!=o){let n=document.querySelector("#"+e+' tbody tr[data-uniqueid="'+o+'"]');n&&(window[a]=o,n.classList.add(t))}}function crearEtiqueta(e,t){const a=createTagElement(e);t.appendChild(a)}function createTagElement(e){const t=dataEtiquetas.find((t=>t.num==e)),a=t.des,o=aColorFondoEvento[t.col-1],n=document.createElement("div");n.classList.add("tag"),n.style.backgroundColor=o,n.style.color="#ffc107"===o?"black":"white",n.style.marginRight="10px",n.style.marginBottom="10px",n.setAttribute("data-num",e);const s=document.createElement("span");return s.textContent=a,n.appendChild(s),n}function abrirModalTags(e){"modalContacto"==e?(etiSeleccionadasContacto=[],document.querySelectorAll("#selectedTagsFichaContacto .tag").forEach((e=>{const t=e.getAttribute("data-num");etiSeleccionadasContacto.push(parseInt(t))}))):"modalFiltroContactos"==e&&(etiSeleccionadasFiltro=[],document.querySelectorAll("#selectedTagsFiltro .tag").forEach((e=>{const t=e.getAttribute("data-num");etiSeleccionadasFiltro.push(parseInt(t))}))),abrirModalTagsDesde=e,new bootstrap.Modal(document.getElementById("tagModal"),{backdrop:"false"}).show(),document.getElementById(abrirModalTagsDesde).classList.add("modal-open"),document.body.classList.add("modal-open");const t=document.querySelector(".modal-backdrop");t&&t.classList.add("modal-backdrop-superior"),document.getElementById("tagModal").classList.add("modal-superior")}function contieneAlgunaEtiqueta(e,t,a){const o=etiSeleccionadasFiltro;return[t.et1,t.et2,t.et3].some((e=>o.includes(e)))}function getSelectedColorTag(){const e=document.querySelector('input[name="color"]:checked').value;return colorMapTag[e]}async function loadTagsFromServer(){const e=new FormData;e.append("prefijo",localStorage.getItem("prefijo"));const t=await fetch("https://"+window.location.host+"/leeretiquetas",{method:"POST",body:e}),a=await t.json(),o=document.getElementById("tagContainerEtiquetas");o.innerHTML="",a.forEach((e=>{const t=createTagElementEtiquetas(e.des,colorMapTag[e.col],e.num);o.appendChild(t)}))}async function addTag(){const e=document.getElementById("tagInput"),t=e.value.trim();document.getElementById("tagContainerEtiquetas").children.length>=MAX_TAGS_CREACION?alert("No se pueden a√±adir m√°s de 100 etiquetas."):""!==t&&(e.value="",await sendTagToServer(t,getSelectedColorTag()))}function createTagElementEtiquetas(e,t,a=null){const o=document.createElement("div");o.classList.add("tagEtiquetas"),o.style.backgroundColor=t,o.style.color="#ffc107"===t?"black":"white",a&&o.setAttribute("data-num",a);const n=document.createElement("span");n.textContent=e;const s=document.createElement("button");return s.textContent="x",s.onclick=async function(e){e.stopPropagation(),await deleteTag(a,o)},o.onclick=function(){editTag(e,t,a)},o.appendChild(n),o.appendChild(s),o}async function sendTagToServer(e,t){const a=new FormData;a.append("prefijo",localStorage.getItem("prefijo")),a.append("des",e),a.append("col",Object.keys(colorMapTag).find((e=>colorMapTag[e]===t))),await fetch("https://"+window.location.host+"/nuevaetiqueta",{method:"POST",body:a});checkMaxTags(document.getElementById("tagContainerEtiquetas").children.length),await loadTagsFromServer()}function editTag(e,t,a){document.getElementById("tagInput").value=e;const o=Object.keys(colorMapTag).find((e=>colorMapTag[e]===t));document.getElementById(`color${o}_eventos`).checked=!0,document.getElementById("addButton").classList.add("hiddenEtiquetas"),document.getElementById("saveButton").classList.remove("hiddenEtiquetas"),document.getElementById("cancelButton").classList.remove("hiddenEtiquetas"),editingTagId=a}async function saveTag(){const e=document.getElementById("tagInput").value.trim(),t=getSelectedColorTag();if(editingTagId){const a=new FormData;a.append("prefijo",localStorage.getItem("prefijo")),a.append("num",editingTagId),a.append("des",e),a.append("col",Object.keys(colorMapTag).find((e=>colorMapTag[e]===t))),await fetch("https://"+window.location.host+"/cambiaretiqueta",{method:"POST",body:a})}cancelTag(),await loadTagsFromServer()}function cancelTag(){document.getElementById("tagInput").value="",document.getElementById("addButton").classList.remove("hiddenEtiquetas"),document.getElementById("saveButton").classList.add("hiddenEtiquetas"),document.getElementById("cancelButton").classList.add("hiddenEtiquetas"),editingTagIndex=null,editingTagId=null}function deleteTag(e){if(!e)return void console.error("No se pudo eliminar la etiqueta: Falta el identificador (num).");const t=new FormData;t.append("prefijo",localStorage.getItem("prefijo")),t.append("num",e),async function(){const e=await fetch("https://"+window.location.host+"/eliminaretiqueta",{method:"POST",body:t});return await e.json()}().then((t=>{if(t.success){if("OK"==t.data.value1){const t=document.querySelector(`[data-num="${e}"]`);t&&t.remove()}}else"Etiqueta asignada"==t.message?toastMsj(tExp("Etiqueta asignada a uno o m√°s contactos",""),msjEtiquetasContactos,2e3,6,7):toastMsj(t.message,msjEtiquetasContactos,2e3,6,8)})).catch((e=>{toastMsj(e.message,msjEtiquetasContactos,2e3,6,9)}))}function checkMaxTags(e){const t=document.getElementById("addButton");t.disabled=e>=MAX_TAGS_CREACION}function iniciarInteracciones(){window.idTabInteracciones="",salirModalInteraccion=!1;var e=localStorage.getItem("idiomaPais");indiceFilaTabInteracciones=-1,refrescoTabInteracciones=-1,iPosTabInteracciones=0,$("#tabInteracciones").bootstrapTable({locale:localeTable(e),url:"https://"+window.location.host+"/datosTablaInteraccionesContacto?prefijo="+localStorage.getItem("prefijo")+"&codContactoN="+window.idTabContactos,onClickRow:function(e,t,a){selRowTab("tabInteracciones","success3","idTabInteracciones",e.idii)},onSort:function(e,t){setTimeout((function(){saveColumnConfig("tabInteracciones"),selRowTab("tabInteracciones","success3","idTabInteracciones",$("#tabInteracciones").bootstrapTable("getData")[0].idii)}),500)},onSearch:function(e){selRowTab("tabInteracciones","success3","idTabInteracciones",$("#tabInteracciones").bootstrapTable("getData")[0].idii)},onPostBody:function(){var e=$("#tabInteracciones").bootstrapTable("getOptions").cardView;vistaAntTabInteracciones!==e&&(vistaAntTabInteracciones=e,setTimeout((function(){selRowTab("tabInteracciones","success3","idTabInteracciones",window.idTabInteracciones)}),200))},onLoadSuccess:function(){$("#tabInteracciones").bootstrapTable("check",0),selRowTab("tabInteracciones","success3","idTabInteracciones",$("#tabInteracciones").bootstrapTable("getData")[0].idii)},columns:[]});for(var t=0;t<tabInteraccionesCampos.length;t++)$("#tabInteracciones").bootstrapTable("updateColumnTitle",{field:tabInteraccionesCampos[t],title:dTitColInteracciones(e,t)});loadColumnConfig("tabInteracciones");const a=$("#tabInteracciones").bootstrapTable("getOptions").columns[0];a.forEach((e=>{formatearColumna(e)})),$("#tabInteracciones").bootstrapTable("refreshOptions",{columns:a}),crearToastInteraccion("Nueva interacci√≥n","'modalInteraccion'","'opcionInteraccion'"),cambiarTextoIdioma(""),crearEstilo("aceptar_interacciones","cancelar_interacciones",tExp("Guardar",""),tExp("Cancelar","")),activarTooltipsDiv("interacciones"),cambiarAltoTabla("tabInteracciones",0),barraPaginacion("#tabInteracciones"),abrirToast("liveToastInteraccion"),"contactos"==localStorage.getItem("divAnt")&&toastMsj(tExp("Interacciones con","")+" "+nombrePersonaContacto,msjInteracciones,1500,5,7)}function detailFormatterTabInteracciones(e,t){var a=localStorage.getItem("idiomaPais"),o=[];return $.each(t,(function(e,t){if("idii"!=e&&"idci"!=e&&t&&""!=t){let n="",s="";"fhii"==e&&(n=tExp("Fecha/hora",a),s=formatoFechaHora(t)),"tipi"==e&&(n=tExp("Tipo",a),s=tExp(aTipoInteraccion[t-1],"")),"asui"==e&&(n=tExp("Asunto",a),s=t),"desi"==e&&(n=tExp("Descripci√≥n",a),s=t),"ncli"==e&&(n=tExp("Notas cliente",a),s=t),"etai"==e&&(n=tExp("Etapa",a),s=tExp(aEtapaInteraccion[t-1],"")),"resi"==e&&(n=tExp("Resultado",a),s=tExp(aResultadoInteraccion[t-1],"")),"peni"==e&&(n=tExp("Acci√≥n Pendiente",a),s=tExp(aAccionInteraccion[t-1],"")),"reci"==e&&(n=tExp("Recordatorio",a),s=formatoFechaHora(t)),s&&""!=s&&o.push("<div><b>"+n+":</b> "+s+"</div>")}else;})),o.join("")}function dTitColInteracciones(e,t){switch(e){case"es-es":case"es-ES":return tabInteraccionesTitCol_es_ES[t];case"ca-es":case"ca-ES":return tabInteraccionesTitCol_ca_ES[t];case"eu-es":case"eu-ES":return tabInteraccionesTitCol_eu_ES[t];case"gl-es":case"gl-ES":return tabInteraccionesTitCol_gl_ES[t];case"en-gb":case"en-GB":return tabInteraccionesTitCol_en_GB[t];case"es-mx":case"es-MX":return tabInteraccionesTitCol_es_MX[t];case"es-cl":case"es-CL":return tabInteraccionesTitCol_es_CL[t];case"es-us":case"es-US":return tabInteraccionesTitCol_es_US[t];case"en-us":case"en-US":default:return tabInteraccionesTitCol_en_US[t];case"en-ca":case"en-CA":return tabInteraccionesTitCol_en_CA[t];case"en-au":case"en-AU":return tabInteraccionesTitCol_en_AU[t];case"it-it":case"it-IT":return tabInteraccionesTitCol_it_IT[t];case"pt-pt":case"pt-PT":return tabInteraccionesTitCol_pt_PT[t];case"pt-br":case"pt-BR":return tabInteraccionesTitCol_pt_BR[t];case"fr-fr":case"fr-FR":return tabInteraccionesTitCol_fr_FR[t];case"fr-ca":case"fr-CA":return tabInteraccionesTitCol_fr_CA[t];case"de-de":case"de-DE":return tabInteraccionesTitCol_de_DE[t];case"en-nz":case"en-NZ":return tabInteraccionesTitCol_en_NZ[t];case"en-ie":case"en-IE":return tabInteraccionesTitCol_en_IE[t];case"en-in":case"en-IN":return tabInteraccionesTitCol_en_IN[t];case"en-sg":case"en-SG":return tabInteraccionesTitCol_en_SG[t];case"en-hk":case"en-HK":return tabInteraccionesTitCol_en_HK[t];case"en-my":case"en-MY":return tabInteraccionesTitCol_en_MY[t];case"es-ar":case"es-AR":return tabInteraccionesTitCol_es_AR[t];case"es-co":case"es-CO":return tabInteraccionesTitCol_es_CO[t];case"es-pe":case"es-PE":return tabInteraccionesTitCol_es_PE[t];case"es-uy":case"es-UY":return tabInteraccionesTitCol_es_UY[t];case"fr-be":case"fr-BE":case"fr-be":case"fr-BE":return tabInteraccionesTitCol_fr_BE[t];case"fr-ch":case"fr-CH":case"fr-ch":case"fr-CH":return tabInteraccionesTitCol_fr_CH[t];case"it-ch":case"it-CH":return tabInteraccionesTitCol_it_CH[t];case"de-at":case"de-AT":return tabInteraccionesTitCol_de_AT[t];case"de-be":case"de-BE":return tabInteraccionesTitCol_de_BE[t];case"de-ch":case"de-CH":return tabInteraccionesTitCol_de_CH[t];case"es-ve":case"es-VE":return tabInteraccionesTitCol_es_VE[t];case"es-gt":case"es-GT":return tabInteraccionesTitCol_es_GT[t];case"es-ec":case"es-EC":return tabInteraccionesTitCol_es_EC[t];case"es-bo":case"es-BO":return tabInteraccionesTitCol_es_BO[t];case"es-cu":case"es-CU":return tabInteraccionesTitCol_es_CU[t];case"es-do":case"es-DO":return tabInteraccionesTitCol_es_DO[t];case"es-hn":case"es-HN":return tabInteraccionesTitCol_es_HN[t];case"es-py":case"es-PY":return tabInteraccionesTitCol_es_PY[t];case"es-sv":case"es-SV":return tabInteraccionesTitCol_es_SV[t];case"es-ni":case"es-NI":return tabInteraccionesTitCol_es_NI[t];case"es-pa":case"es-PA":return tabInteraccionesTitCol_es_PA[t];case"en-pk":case"en-PK":return tabInteraccionesTitCol_en_PK[t];case"en-ng":case"en-NG":return tabInteraccionesTitCol_en_NG[t];case"en-bd":case"en-BD":return tabInteraccionesTitCol_en_BD[t];case"en-ph":case"en-PH":return tabInteraccionesTitCol_en_PH[t];case"en-tz":case"en-TZ":return tabInteraccionesTitCol_en_TZ[t];case"en-za":case"en-ZA":return tabInteraccionesTitCol_en_ZA[t];case"en-ke":case"en-KE":return tabInteraccionesTitCol_en_KE[t];case"en-ug":case"en-UG":return tabInteraccionesTitCol_en_UG[t];case"en-gh":case"en-GH":return tabInteraccionesTitCol_en_GH[t];case"en-mw":case"en-MW":return tabInteraccionesTitCol_en_MW[t];case"en-zm":case"en-ZM":return tabInteraccionesTitCol_en_ZM[t];case"en-zw":case"en-ZW":return tabInteraccionesTitCol_en_ZW[t];case"en-cm":case"en-CM":return tabInteraccionesTitCol_en_CM[t];case"en-lk":case"en-LK":return tabInteraccionesTitCol_en_LK[t];case"fr-cd":case"fr-CD":return tabInteraccionesTitCol_fr_CD[t];case"fr-cm":case"fr-CM":return tabInteraccionesTitCol_fr_CM[t];case"fr-mg":case"fr-MG":return tabInteraccionesTitCol_fr_MG[t];case"fr-ci":case"fr-CI":return tabInteraccionesTitCol_fr_CI[t];case"fr-bf":case"fr-BF":return tabInteraccionesTitCol_fr_BF[t];case"fr-ne":case"fr-NE":return tabInteraccionesTitCol_fr_NE[t];case"fr-sn":case"fr-SN":return tabInteraccionesTitCol_fr_SN[t];case"fr-ml":case"fr-ML":return tabInteraccionesTitCol_fr_ML[t];case"fr-bj":case"fr-BJ":return tabInteraccionesTitCol_fr_BJ[t];case"fr-rw":case"fr-RW":return tabInteraccionesTitCol_fr_RW[t];case"fr-td":case"fr-TD":return tabInteraccionesTitCol_fr_TD[t];case"fr-gn":case"fr-GN":return tabInteraccionesTitCol_fr_GN[t];case"pt-ao":case"pt-AO":return tabInteraccionesTitCol_pt_AO[t];case"pt-mz":case"pt-MZ":return tabInteraccionesTitCol_pt_MZ[t]}}function iniciarImportarGoogle(){let e=document.createElement("script");e.src="https://apis.google.com/js/api.js",e.onload=function(){gapi.load("client",l)},document.body.appendChild(e);let t=document.createElement("script");t.src="https://accounts.google.com/gsi/client",t.onload=function(){c=google.accounts.oauth2.initTokenClient({client_id:a,scope:n,callback:""}),i=!0,d()},document.body.appendChild(t);const a="968670907013-pn8b7vp24u7093h9t62tnj05aqi8aqq3.apps.googleusercontent.com",o="AIzaSyBxQkTA-bC4dY1NimJOzPUwSgc0mJeJUo0",n="https://www.googleapis.com/auth/contacts.readonly",s=["https://www.googleapis.com/discovery/v1/apis/people/v1/rest"];let c,r=!1,i=!1;async function l(){await gapi.client.init({apiKey:o,discoveryDocs:s}),r=!0,d()}function d(){r&&i&&(document.getElementById("authorize_button").style.display="block")}document.getElementById("authorize_button").onclick=function(){c.callback=async e=>{if(void 0!==e.error)throw e;document.getElementById("authorize_button").style.display="none",await async function(){let e=[],t=null;do{let a;try{a=await gapi.client.people.people.connections.list({resourceName:"people/me",pageSize:90,personFields:"names,emailAddresses,phoneNumbers,organizations,biographies",pageToken:t})}catch(e){return void console.error("Error fetching contacts: ",e)}const o=a.result.connections;o&&o.length>0&&(e=e.concat(o)),t=a.result.nextPageToken}while(t);if(0===e.length)return void console.log("No connections found.");const a=e.map((e=>({state:!1,name:e.names&&e.names.length>0?e.names[0].displayName:"",email:e.emailAddresses&&e.emailAddresses.length>0?e.emailAddresses[0].value:"",phone1:e.phoneNumbers&&e.phoneNumbers.length>0?e.phoneNumbers[0].value:"",phone2:e.phoneNumbers&&e.phoneNumbers.length>1?e.phoneNumbers[1].value:"",company:e.organizations&&e.organizations.length>0?e.organizations[0].name:"",notes:e.biographies&&e.biographies.length>0?e.biographies[0].value:""})));document.getElementById("filaAutorizacionGoogle").style.display="none",document.getElementById("filaGoogle").classList.remove("d-none"),document.getElementById("filaGoogle").classList.add("d-flex"),document.getElementById("divTablaGoogle").classList.remove("d-none"),document.getElementById("divTablaGoogle").classList.add("d-flex");var o=localeTable(localStorage.getItem("idiomaPais"));$("#tabImportGoogle").bootstrapTable({data:a,locale:o}),titColtabImportGoogle()}(),cambiarAltoTabla("tabImportGoogle",20),barraPaginacion("#tabImportGoogle")},null===gapi.client.getToken()?c.requestAccessToken({prompt:"consent"}):c.requestAccessToken({prompt:""})},txtAutorizacionGoogle.innerText=autorizacionContactosGoogleMicrosoft("Google"),cambiarTextoIdioma("")}function iniciarImportarMs(){cambiarTextoIdioma(localStorage.getItem("idiomaPais")),txtAutorizacionMicrosoft.innerText=autorizacionContactosGoogleMicrosoft("Microsoft")}async function importarContactosMicrosoft(){const e=await obtenerTokenMicrosoft(2);if(e)try{let t=[],a="https://graph.microsoft.com/v1.0/me/contacts";for(;a;){const o=await fetch(a,{headers:{Authorization:`Bearer ${e}`}});if(!o.ok)throw new Error(`Error en la API de Microsoft Graph: ${o.statusText}`);const n=await o.json();t=t.concat(n.value),a=n["@odata.nextLink"]||null}document.getElementById("filaAutorizacionMs").style.display="none",document.getElementById("filaMs").classList.remove("d-none"),document.getElementById("filaMs").classList.add("d-flex"),document.getElementById("divTablaMs").classList.remove("d-none"),document.getElementById("divTablaMs").classList.add("d-flex");const o=t.map((e=>{let t=[];return e.mobilePhone&&t.push(e.mobilePhone),e.businessPhones&&t.push(...e.businessPhones),e.homePhones&&t.push(...e.homePhones),e.otherPhones&&t.push(...e.otherPhones),{name:e.displayName||"",email:e.emailAddresses?.[0]?.address||"",phone1:t[0]||"",phone2:t[1]||"",company:e.companyName||"",notes:e.notes||""}})),n=localeTable(localStorage.getItem("idiomaPais"));$("#tabImportMs").bootstrapTable({data:o,locale:n}),titColtabImportMs(),cambiarAltoTabla("tabImportMs",20),barraPaginacion("#tabImportMs")}catch(e){console.error("‚ùå Error al importar contactos:",e),toastMsj("Error al importar los contactos desde Microsoft",msjModDocumento,1500,5,5)}else alert(tExp("No se pudo obtener acceso a los contactos de Microsoft",""))}function iniciarImportarApple(){cambiarTextoIdioma("")}function startAppleContactsImport(){let e=new FormData;e.append("email",document.getElementById("appleEmail").value.trim()),e.append("appPassword",document.getElementById("appPassword").value.trim()),async function(){const t=await fetch("https://"+window.location.host+"/leerContactosApple",{method:"POST",body:e});return await t.json()}().then((e=>{document.getElementById("filaAutorizacionApple").style.display="none",document.getElementById("filaApple").classList.remove("d-none"),document.getElementById("filaApple").classList.add("d-flex"),document.getElementById("divTablaApple").classList.remove("d-none"),document.getElementById("divTablaApple").classList.add("d-flex");var t=localeTable(localStorage.getItem("idiomaPais"));$("#tabImportApple").bootstrapTable({data:e,locale:t}),titColtabImportApple()})).catch((e=>{toastMsj(tExp("ID de Apple o contrase√±a incorrecta",""),msjImportApple,2e3,6,1)}))}function iniciarRecordatorios(){window.idTabRecordatorios="";var e=localStorage.getItem("idiomaPais");indiceFilaTabRecordatorios=-1,refrescoTabRecordatorios=-1,iPosTabRecordatorios=0,$("#tabRecordatorios").bootstrapTable({locale:localeTable(e),url:"https://"+window.location.host+"/datosTablaRecordatorios?prefijo="+localStorage.getItem("prefijo"),onClickRow:function(e,t,a){selRowTab("tabRecordatorios","success4","idTabRecordatorios",e.idir)},onSort:function(e,t){setTimeout((function(){selRowTab("tabRecordatorios","success4","idTabRecordatorios",$("#tabRecordatorios").bootstrapTable("getData")[0].idir)}),500)},onSearch:function(e){selRowTab("tabRecordatorios","success4","idTabRecordatorios",$("#tabRecordatorios").bootstrapTable("getData")[0].idir)},onPostBody:function(){var e=$("#tabRecordatorios").bootstrapTable("getOptions").cardView;vistaAntTabRecordatorios!==e&&(vistaAntTabRecordatorios=e,setTimeout((function(){selRowTab("tabRecordatorios","success4","idTabRecordatorios",window.idTabRecordatorios)}),200))},onLoadSuccess:function(){$("#tabRecordatorios").bootstrapTable("check",0),selRowTab("tabRecordatorios","success4","idTabRecordatorios",$("#tabRecordatorios").bootstrapTable("getData")[0].idir)},columns:[]});for(var t=0;t<tabRecordatoriosCampos.length;t++)$("#tabRecordatorios").bootstrapTable("updateColumnTitle",{field:tabRecordatoriosCampos[t],title:dTitColRecordatorios(e,t)});cambiarTextoIdioma(""),activarTooltipsDiv("recordatorios"),cambiarAltoTabla("tabRecordatorios",0),barraPaginacion("#tabRecordatorios"),setTimeout((function(){0==$("#tabRecordatorios").bootstrapTable("getData").length&&toastMsj(tExp("A√±ade una interacci√≥n en Contactos",""),msjRecordatorios,2e3,4,6)}),500)}function detailFormatterTabRecordatorios(e,t){var a=localStorage.getItem("idiomaPais"),o=[];return $.each(t,(function(e,t){if("idir"!=e&&"idcr"!=e&&t&&""!=t){let n="",s="";"fhir"==e&&(n=tExp("Fecha/hora",a),s=formatoFechaHora(t)),"tipr"==e&&(n=tExp("Tipo",a),s=tExp(aTipoInteraccion[t-1],"")),"asur"==e&&(n=tExp("Asunto",a),s=t),"desr"==e&&(n=tExp("Descripci√≥n",a),s=t),"nclr"==e&&(n=tExp("Notas cliente",a),s=t),"etar"==e&&(n=tExp("Etapa",a),s=tExp(aEtapaInteraccion[t-1],"")),"resr"==e&&(n=tExp("Resultado",a),s=tExp(aResultadoInteraccion[t-1],"")),s&&""!=s&&o.push("<div><b>"+n+":</b> "+s+"</div>")}else;})),o.join("")}function dTitColRecordatorios(e,t){switch(e){case"es-es":case"es-ES":return tabRecordatoriosTitCol_es_ES[t];case"ca-es":case"ca-ES":return tabRecordatoriosTitCol_ca_ES[t];case"eu-es":case"eu-ES":return tabRecordatoriosTitCol_eu_ES[t];case"gl-es":case"gl-ES":return tabRecordatoriosTitCol_gl_ES[t];case"en-gb":case"en-GB":return tabRecordatoriosTitCol_en_GB[t];case"es-mx":case"es-MX":return tabRecordatoriosTitCol_es_MX[t];case"es-cl":case"es-CL":return tabRecordatoriosTitCol_es_CL[t];case"es-us":case"es-US":return tabRecordatoriosTitCol_es_US[t];case"en-us":case"en-US":default:return tabRecordatoriosTitCol_en_US[t];case"en-ca":case"en-CA":return tabRecordatoriosTitCol_en_CA[t];case"en-au":case"en-AU":return tabRecordatoriosTitCol_en_AU[t];case"it-it":case"it-IT":return tabRecordatoriosTitCol_it_IT[t];case"pt-pt":case"pt-PT":return tabRecordatoriosTitCol_pt_PT[t];case"pt-br":case"pt-BR":return tabRecordatoriosTitCol_pt_BR[t];case"fr-fr":case"fr-FR":return tabRecordatoriosTitCol_fr_FR[t];case"fr-ca":case"fr-CA":return tabRecordatoriosTitCol_fr_CA[t];case"de-de":case"de-DE":return tabRecordatoriosTitCol_de_DE[t];case"en-nz":case"en-NZ":return tabRecordatoriosTitCol_en_NZ[t];case"en-ie":case"en-IE":return tabRecordatoriosTitCol_en_IE[t];case"en-in":case"en-IN":return tabRecordatoriosTitCol_en_IN[t];case"en-sg":case"en-SG":return tabRecordatoriosTitCol_en_SG[t];case"en-hk":case"en-HK":return tabRecordatoriosTitCol_en_HK[t];case"en-my":case"en-MY":return tabRecordatoriosTitCol_en_MY[t];case"es-ar":case"es-AR":return tabRecordatoriosTitCol_es_AR[t];case"es-co":case"es-CO":return tabRecordatoriosTitCol_es_CO[t];case"es-pe":case"es-PE":return tabRecordatoriosTitCol_es_PE[t];case"es-uy":case"es-UY":return tabRecordatoriosTitCol_es_UY[t];case"fr-be":case"fr-BE":case"fr-be":case"fr-BE":return tabRecordatoriosTitCol_fr_BE[t];case"fr-ch":case"fr-CH":case"fr-ch":case"fr-CH":return tabRecordatoriosTitCol_fr_CH[t];case"it-ch":case"it-CH":return tabRecordatoriosTitCol_it_CH[t];case"de-at":case"de-AT":return tabRecordatoriosTitCol_de_AT[t];case"de-be":case"de-BE":return tabRecordatoriosTitCol_de_BE[t];case"de-ch":case"de-CH":return tabRecordatoriosTitCol_de_CH[t];case"es-ve":case"es-VE":return tabRecordatoriosTitCol_es_VE[t];case"es-gt":case"es-GT":return tabRecordatoriosTitCol_es_GT[t];case"es-ec":case"es-EC":return tabRecordatoriosTitCol_es_EC[t];case"es-bo":case"es-BO":return tabRecordatoriosTitCol_es_BO[t];case"es-cu":case"es-CU":return tabRecordatoriosTitCol_es_CU[t];case"es-do":case"es-DO":return tabRecordatoriosTitCol_es_DO[t];case"es-hn":case"es-HN":return tabRecordatoriosTitCol_es_HN[t];case"es-py":case"es-PY":return tabRecordatoriosTitCol_es_PY[t];case"es-sv":case"es-SV":return tabRecordatoriosTitCol_es_SV[t];case"es-ni":case"es-NI":return tabRecordatoriosTitCol_es_NI[t];case"es-pa":case"es-PA":return tabRecordatoriosTitCol_es_PA[t];case"en-pk":case"en-PK":return tabRecordatoriosTitCol_en_PK[t];case"en-ng":case"en-NG":return tabRecordatoriosTitCol_en_NG[t];case"en-bd":case"en-BD":return tabRecordatoriosTitCol_en_BD[t];case"en-ph":case"en-PH":return tabRecordatoriosTitCol_en_PH[t];case"en-tz":case"en-TZ":return tabRecordatoriosTitCol_en_TZ[t];case"en-za":case"en-ZA":return tabRecordatoriosTitCol_en_ZA[t];case"en-ke":case"en-KE":return tabRecordatoriosTitCol_en_KE[t];case"en-ug":case"en-UG":return tabRecordatoriosTitCol_en_UG[t];case"en-gh":case"en-GH":return tabRecordatoriosTitCol_en_GH[t];case"en-mw":case"en-MW":return tabRecordatoriosTitCol_en_MW[t];case"en-zm":case"en-ZM":return tabRecordatoriosTitCol_en_ZM[t];case"en-zw":case"en-ZW":return tabRecordatoriosTitCol_en_ZW[t];case"en-cm":case"en-CM":return tabRecordatoriosTitCol_en_CM[t];case"en-lk":case"en-LK":return tabRecordatoriosTitCol_en_LK[t];case"fr-cd":case"fr-CD":return tabRecordatoriosTitCol_fr_CD[t];case"fr-cm":case"fr-CM":return tabRecordatoriosTitCol_fr_CM[t];case"fr-mg":case"fr-MG":return tabRecordatoriosTitCol_fr_MG[t];case"fr-ci":case"fr-CI":return tabRecordatoriosTitCol_fr_CI[t];case"fr-bf":case"fr-BF":return tabRecordatoriosTitCol_fr_BF[t];case"fr-ne":case"fr-NE":return tabRecordatoriosTitCol_fr_NE[t];case"fr-sn":case"fr-SN":return tabRecordatoriosTitCol_fr_SN[t];case"fr-ml":case"fr-ML":return tabRecordatoriosTitCol_fr_ML[t];case"fr-bj":case"fr-BJ":return tabRecordatoriosTitCol_fr_BJ[t];case"fr-rw":case"fr-RW":return tabRecordatoriosTitCol_fr_RW[t];case"fr-td":case"fr-TD":return tabRecordatoriosTitCol_fr_TD[t];case"fr-gn":case"fr-GN":return tabRecordatoriosTitCol_fr_GN[t];case"pt-ao":case"pt-AO":return tabRecordatoriosTitCol_pt_AO[t];case"pt-mz":case"pt-MZ":return tabRecordatoriosTitCol_pt_MZ[t]}}function generatePDF(e,t,a){const{jsPDF:o}=window.jspdf;var n=new o("portrait","pt",formatoPapel()),s=decodeURIComponent(escape(atob(e)));const c=document.createElement("div");c.innerHTML=s;const r=Array.from(c.querySelectorAll("div")).map((e=>e.innerText||e.textContent)),i=n.internal.pageSize.getWidth(),l=i-40-40;let d=50;const u=formatoFecha(obtenerFechaActual());n.setFontSize(10),n.text(t,40,30),n.text(u,i-40,30,{align:"right"}),n.setFontSize(12),d+=20,r.forEach((e=>{n.splitTextToSize(e,l).forEach((e=>{d+20>n.internal.pageSize.getHeight()-50&&(n.addPage(),d=50),n.text(e,40,d,{align:"left"}),d+=20}))}));const p=`${a}_${t}.pdf`;n.save(p)}function generateDOC(e,t,a){const o=decodeURIComponent(escape(atob(e))),n=document.createElement("div");n.innerHTML=o;let s="";s+=Array.from(n.querySelectorAll("div")).map((e=>e.innerText||e.textContent)).join("\n");const c=new Blob([s],{type:"application/msword"}),r=`${a}_${t}.doc`,i=document.createElement("a");i.href=URL.createObjectURL(c),i.download=r,i.click()}function printContent(e,t,a){const o=decodeURIComponent(escape(atob(e))),n=document.createElement("div");n.innerHTML=o;let s=`<h2>${t} (${a})</h2>`;s+=`<pre style="font-family: Arial, sans-serif; white-space: pre-wrap;">${Array.from(n.querySelectorAll("div")).map((e=>e.innerText||e.textContent)).join("\n")}</pre>`;const c=window.open("","_blank");c?(c.document.open(),c.document.write(`\n            <html>\n                <head>\n                    <style>\n                        @page {\n                            size: portrait; /* Configurar orientaci√≥n vertical */\n                            margin: 20mm;\n                        }\n                        body { \n                            font-family: Arial, sans-serif; \n                            margin: 20px; \n                        }\n                        pre { \n                            white-space: pre-wrap; \n                            word-wrap: break-word; \n                        }\n                        h2 { \n                            text-align: center; \n                        }\n                    </style>\n                </head>\n                <body>\n                    ${s}\n                </body>\n            </html>\n        `),c.document.close(),c.onload=function(){c.print(),c.close()}):alert("No se pudo abrir la ventana de impresi√≥n.")}function fTextPromocion(e){switch(localStorage.getItem("idiomaPais").substring(0,2)){case"es":switch(e){case 1:return"üéÅ Regalo de bienvenida üéÅ";case 2:return"¬°4 meses gratis en planes anuales!";case 3:return"√önicamente disponible durante tu prueba gratuita de 10 d√≠as";case 4:return"¬°No pierdas la oportunidad antes de que termine tu prueba (4 meses gratis en vez de 2 el primer a√±o)!";default:return""}case"fr":switch(e){case 1:return"üéÅ Cadeau de bienvenue üéÅ";case 2:return"4 mois gratuits sur les plans annuels !";case 3:return"Uniquement disponible pendant votre essai gratuit de 10 jours";case 4:return"Ne manquez pas l'opportunit√© avant la fin de votre essai (4 mois gratuits au lieu de 2 la premi√®re ann√©e)!";default:return""}case"it":switch(e){case 1:return"üéÅ Regalo di benvenuto üéÅ";case 2:return"4 mesi gratuiti sui piani annuali!";case 3:return"Disponibile solo durante la tua prova gratuita di 10 giorni";case 4:return"Non perdere l'opportunit√† prima che finisca la tua prova (4 mesi gratis invece di 2 il primo anno)!";default:return""}case"de":switch(e){case 1:return"üéÅ Willkommensgeschenk üéÅ";case 2:return"4 Monate gratis bei Jahrespl√§nen!";case 3:return"Nur verf√ºgbar w√§hrend deiner 10-t√§gigen kostenlosen Testversion";case 4:return"Verpasse nicht die Gelegenheit, bevor deine Testphase endet (4 Monate kostenlos statt 2 im ersten Jahr)!";default:return""}case"pt":switch(e){case 1:return"üéÅ Presente de boas-vindas üéÅ";case 2:return"4 meses gr√°tis em planos anuais!";case 3:return"Dispon√≠vel apenas durante o seu teste gratuito de 10 dias";case 4:return"N√£o perca a oportunidade antes que termine o seu teste (4 meses gr√°tis em vez de 2 no primeiro ano)!";default:return""}case"ca":switch(e){case 1:return"üéÅ Regal de benvinguda üéÅ";case 2:return"4 mesos gratu√Øts en plans anuals!";case 3:return"Nom√©s disponible durant la teva prova gratu√Øta de 10 dies";case 4:return"No perdis l'oportunitat abans que acabi la teva prova (4 mesos gratu√Øts en comptes de 2 el primer any)!";default:return""}case"gl":switch(e){case 1:return"üéÅ Regalo de benvida üéÅ";case 2:return"¬°4 meses gratis en plans anuais!";case 3:return"Unicamente dispo√±ible durante a t√∫a proba gratu√≠ta de 10 d√≠as";case 4:return"Non perdas a oportunidade antes de que termine a t√∫a proba (4 meses gratis en vez de 2 no primeiro ano)!";default:return""}default:switch(e){case 1:return"üéÅ Welcome gift üéÅ";case 2:return"4 months free on annual plans!";case 3:return"Only available during your 10-day free trial";case 4:return"Don't miss the opportunity before your trial ends (4 months free instead of 2 the first year)!";default:return""}}}function agregarCodigoGruposContactos(){return groupModal.addEventListener("shown.bs.modal",(function(e){groupInput.focus()})),elementModal.addEventListener("shown.bs.modal",(function(e){elementInput.focus()})),!0}function iniciarGruposContactos(){setTimeout((function(){libIdioma(localStorage.getItem("idiomaPais"),3)}),100);const e=document.getElementById("groupsContainer"),t=new bootstrap.Modal(document.getElementById("groupModal")),a=document.getElementById("groupInput"),o=document.getElementById("saveGroupBtn"),n=new bootstrap.Modal(document.getElementById("elementModal")),s=document.getElementById("elementInput"),c=document.getElementById("saveElementBtn");let r=null,i=null;d(localStorage.getItem("nomGrupo1"),1),d(localStorage.getItem("nomGrupo2"),2),d(localStorage.getItem("nomGrupo3"),3);let l=new FormData;function d(o,c){const l=document.createElement("div");l.className="col-lg-4 col-md-6 col-sm-12 group-card",l.innerHTML=`\n            <div class="card">\n                <div class="group-header">\n                    <h5 class="card-title group-name">${o}</h5>\n                    <span class="group-number d-none">${c}</span>\n                    <button class="btn btn-outline-primary border-0 btn-sm edit-group-btn">\n                        <i class="bi bi-pencil"></i>\n                    </button>\n                </div>\n                <div class="card-body">\n                    <ul class="list-group element-list"></ul>\n                </div>\n                <div class="card-footer group-footer">\n                    <button class="btn btn-success btn-sm add-element-btn"><span>Nuevo elemento</span></button>\n                </div>\n            </div>\n        `,e.appendChild(l);const d=l.querySelector(".edit-group-btn"),u=l.querySelector(".add-element-btn"),p=l.querySelector(".element-list");d.addEventListener("click",(()=>{r=l,a.value=l.querySelector(".group-name").innerText,t.show()})),u.addEventListener("click",(()=>{r=l,i=null,s.value="",n.show()})),p.addEventListener("click",(e=>{if(e.target.closest(".set-default-btn")){const t=e.target.closest("li").querySelector(".element-number").innerText,a=e.target.closest(".group-card").querySelector(".group-number").innerText;let o=new FormData;o.append("prefijo",localStorage.getItem("prefijo")),o.append("numEle",t),o.append("numGrupo",a),async function(){const e=await fetch("https://"+window.location.host+"/cambiarelementopredeterminadogrupo",{method:"POST",body:o});return await e.json()}().then((t=>{if(t.success){const t=p.querySelector(".default-element");t&&t.classList.remove("default-element");e.target.closest("li").classList.add("default-element")}})).catch((e=>{toastMsj(e.message,msjElementModal,2e3,6,6)}))}else if(e.target.closest(".edit-element-btn")){const t=e.target.closest("li");r=l,i=t,s.value=t.querySelector(".element-name").innerText;t.querySelector(".element-number").innerText;n.show()}else if(e.target.closest(".delete-element-btn")){const t=e.target.closest("li");if(t.classList.contains("default-element"))return void toastMsj(tExp("No se puede eliminar el elemento predeterminado",""),msjGruposContactos,2e3,6,10);mostrarModal(tExp("¬øEliminar elemento?",""),(function(){const e=t.querySelector(".element-number").innerText;let a=new FormData;a.append("prefijo",localStorage.getItem("prefijo")),a.append("numEle",e),async function(){const e=await fetch("https://"+window.location.host+"/eliminarelemento",{method:"POST",body:a});return await e.json()}().then((e=>{e.success?p.removeChild(t):"Elemento asignado"==e.message?toastMsj(tExp("Elemento asignado a uno o m√°s contactos",""),msjGruposContactos,2e3,6,7):toastMsj(e.message,msjGruposContactos,2e3,6,8)})).catch((e=>{toastMsj(e.message,msjGruposContactos,2e3,6,9)}))}))}}))}l.append("prefijo",localStorage.getItem("prefijo")),async function(){const e=await fetch("https://"+window.location.host+"/leergrupos",{method:"POST",body:l});return await e.json()}().then((e=>{const t=document.getElementsByClassName("group-card");e.forEach((e=>{const a=e.numGrupo,o=e.numElemento,n=e.desElemento,s=e.predeterminado,c=document.createElement("li");c.className="list-group-item d-flex justify-content-between align-items-center",c.innerHTML=`\n                <span class="element-number d-none">${o}</span>\n                <span class="element-name">${n}</span>\n                <div class="element-buttons">\n                    <button class="btn btn-sm btn-outline-secondary border-0 set-default-btn">\n                        <i class="bi bi-star"></i>\n                    </button>                        \n                    <button class="btn btn-sm btn-outline-primary border-0 edit-element-btn">\n                        <i class="bi bi-pencil"></i>\n                    </button>\n                    <button class="btn btn-sm btn-outline-secondary border-0 delete-element-btn">\n                        <i class="bi bi-trash2"></i>\n                    </button>\n                </div>\n            `,1==s&&c.classList.add("default-element");t.item(parseInt(a)-1).querySelector(".element-list").appendChild(c)}))})).catch((e=>{toastMsj(e.message,msjElementModal,2e3,6,1)})),o.addEventListener("click",(()=>{const e=a.value.trim().substring(0,50);if(e){const a=r.querySelector(".group-number").innerText;let o=new FormData;o.append("prefijo",localStorage.getItem("prefijo")),o.append("numGrupo",a),o.append("nomGrupo",e),async function(){const e=await fetch("https://"+window.location.host+"/cambiarnombregrupo",{method:"POST",body:o});return await e.json()}().then((t=>{t.success&&(r.querySelector(".group-name").innerText=e,"1"==a?localStorage.setItem("nomGrupo1",e):"2"==a?localStorage.setItem("nomGrupo2",e):"3"==a&&localStorage.setItem("nomGrupo3",e))})).catch((e=>{toastMsj(e.message,msjGroupModal,2e3,6,2)})),t.hide()}})),c.addEventListener("click",(()=>{const e=s.value.trim().substring(0,50);if(e){const a=r.querySelector(".element-list");if(a.querySelectorAll("li").length>=100)return void toastMsj(tExp("El n√∫mero m√°ximo de elementos por grupo es 100",""),msjElementModal,2e3,6,3);if(i){const o=i.querySelector(".element-number").innerText;let c=new FormData;async function t(){const e=await fetch("https://"+window.location.host+"/cambiardeselemento",{method:"POST",body:c});return await e.json()}c.append("prefijo",localStorage.getItem("prefijo")),c.append("numEle",o),c.append("desEle",e),t().then((t=>{t.success&&(i.querySelector(".element-name").innerText=e)})).catch((e=>{toastMsj(e.message,msjElementModal,2e3,6,4)}))}else{const l=r.querySelector(".group-number").innerText;let d=new FormData;async function t(){const e=await fetch("https://"+window.location.host+"/nuevoelementogrupo",{method:"POST",body:d});return await e.json()}d.append("prefijo",localStorage.getItem("prefijo")),d.append("numGrupo",l),d.append("desEle",e),t().then((t=>{if(t.success){const o=t.data.value2,n=document.createElement("li");n.className="list-group-item d-flex justify-content-between align-items-center",n.innerHTML=`\n                            <span class="element-number d-none">${o}</span>\n                            <span class="element-name">${e}</span>\n                            <div class="element-buttons">\n                                <button class="btn btn-sm btn-outline-secondary border-0 set-default-btn">\n                                    <i class="bi bi-star"></i>\n                                </button>\n                                <button class="btn btn-sm btn-outline-primary border-0 edit-element-btn">\n                                    <i class="bi bi-pencil"></i>\n                                </button>\n                                <button class="btn btn-sm btn-outline-secondary border-0 delete-element-btn">\n                                    <i class="bi bi-trash2"></i>\n                                </button>\n                            </div>\n                        `,a.appendChild(n)}})).catch((e=>{toastMsj(e.message,msjElementModal,2e3,6,5)}))}n.hide()}}))}function abrirDocumentoEnCollabora(e){var t=localStorage.getItem("prefijo"),a=0;2==window.opcionDocumento&&(a=Number(window.idTabDocumentos));var o=document.getElementById("nom_documentos").value.trim();if(!o)return fileTypeDropdown.textContent=tExp("O crea un nuevo documento...",""),toastMsj(tExp("Teclea el nombre del documento",""),msjModDocumento,1500,5,4),void document.getElementById("nom_documentos").focus();var n=obtenerExtensionArchivo(o);if(!n||n!==e){var s=n?o.slice(0,-n.length-1):o;document.getElementById("nom_documentos").value=s+"."+e,o=s+"."+e}var c=`${t}_${a}_${o}`;fetch("https://"+window.location.host+"/abrirDocCollabora",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prefijo:t,idDocumento:a,nombreArchivo:o,extension:e})}).then((e=>e.json())).then((e=>{if(e.url){if(e.url){const t="&lang="+localStorage.getItem("idiomaPais").substring(0,2)+"&autosave=1&UIMode=compact;Sidebar=false",a=`${e.url}${t}`;docEditado=2,nomDocEditadoCompleto=c;const o=`${encodeURIComponent(a)}`;return openDocEdit.style.display="none",abrirVentanaUnica(o),!1}toastMsj(tExp("Error al abrir el documento en Collabora",""),msjModDocumento,1500,5,5)}else toastMsj(tExp("Error al crear el documento en Collabora",""),msjModDocumento,1500,5,4)})).catch((e=>{toastMsj(tExp("Hubo un problema al comunicarse con el servidor",""),msjModDocumento,1500,5,5)}))}function visorDocEnCollabora(e,t,a){var o=localStorage.getItem("prefijo");fetch("https://"+window.location.host+"/abrirDocCollabora",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prefijo:o,idDocumento:e,nombreArchivo:t,extension:a})}).then((e=>e.json())).then((e=>{if(e.url){if(e.url){const t="&lang="+localStorage.getItem("idiomaPais").substring(0,2)+"&autosave=1&UIMode=compact;Sidebar=false",a=`${e.url}${t}`;return abrirVentanaUnica(`${encodeURIComponent(a)}`),!1}toastMsj(tExp("Error al crear el documento en Collabora",""),msjDocumentos,1500,7,5)}else toastMsj(tExp("Error al abrir el documento en Collabora",""),msjModDocumento,1500,5,4)})).catch((e=>{console.error("Error en la solicitud:",e),toastMsj(tExp("Hubo un problema al comunicarse con el servidor",""),msjDocumentos,1500,8,5)}))}function obtenerExtensionArchivo(e){const t=e.split(".");return t.length>1?t.pop().toLowerCase():""}async function obtenerTokenMicrosoft(e=1){const t={auth:{clientId:"94d22a88-045e-4fac-9861-9e49f234b4e1",authority:"https://login.microsoftonline.com/common",redirectUri:"https://"+window.location.host+"/app/principal.html",postLogoutRedirectUri:"https://"+window.location.host+"/#install"},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0},telemetry:{application:{appName:"My Contacts Cloud",appVersion:"1.0.0.2"}}},a=new msal.PublicClientApplication(t);if("logout"===e){try{await a.logoutRedirect({postLogoutRedirectUri:t.auth.postLogoutRedirectUri})}catch(e){console.error("Error al cerrar sesi√≥n de Microsoft:",e)}return null}const o={1:["User.Read","openid","profile","email","offline_access"],2:["User.Read","Contacts.Read","offline_access"],3:["User.Read","Files.ReadWrite","Sites.ReadWrite.All","offline_access"],4:["User.Read","Mail.Send","offline_access"]}[e];if(!o)return console.error("Tipo de permiso no v√°lido:",e),null;try{let e=a.getAllAccounts()[0];if(!e){console.warn("No hay sesiones activas. Iniciando login...");e=(await a.loginPopup({scopes:o})).account}return(await a.acquireTokenSilent({scopes:o,account:e})).accessToken}catch(e){console.warn("No se pudo obtener el token en silencio. Usando popup...",e);try{return(await a.acquireTokenPopup({scopes:o})).accessToken}catch(e){return console.error("Error al obtener token con popup:",e),null}}}async function iniciarSesionMicrosoft(){const e=await obtenerTokenMicrosoft(1);if(e)try{const t=await fetch("https://graph.microsoft.com/v1.0/me",{headers:{Authorization:`Bearer ${e}`}});if(!t.ok)throw new Error("Error al obtener la informaci√≥n del usuario.");const a=await t.json();validarIniSesion(2,a.id,a.displayName,a.mail||a.userPrincipalName,"")}catch(e){console.error("Error al obtener datos del usuario:",e)}else alert(tExp("No se pudo iniciar sesi√≥n con Microsoft",""))}async function getOutlookComposeLink(e){return`https://outlook.office.com/mail/deeplink/compose?to=${encodeURIComponent(e)}`}async function openOutlookCompose(e){if(!await obtenerTokenMicrosoft(4))return void alert(tExp("No se pudo autenticar con Microsoft",""));const t=encodeURIComponent(e);if(/Android/i.test(navigator.userAgent)){try{await navigator.clipboard.writeText(e)}catch(e){console.error("Error al copiar al portapapeles:",e)}return`https://outlook.live.com/mail/0/inbox/compose/new?to=${t}`}return`https://outlook.live.com/mail/0/deeplink/compose/?to=${t}`}async function crearDocumentoEnOneDrive(e){var t=document.getElementById("nom_documentos").value.trim();if(!t)return fileTypeDropdown.textContent=tExp("O crea un nuevo documento...",""),toastMsj(tExp("Teclea el nombre del documento",""),msjModDocumento,1500,5,4),void document.getElementById("nom_documentos").focus();var a=obtenerExtensionArchivo(t);if(!a||a!==e){var o=a?t.slice(0,-a.length-1):t;document.getElementById("nom_documentos").value=o+"."+e,t=o+"."+e}document.getElementById("nom_documentos").value=t;try{const e=await obtenerTokenMicrosoft(3);if(!e)return void alert(tExp("No se pudo obtener el token de acceso",""));const a=await fetch("https://graph.microsoft.com/v1.0/me/drive/root/children",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({name:t,file:{}})});if(!a.ok){const e=await a.json().catch((()=>({})));if("nameAlreadyExists"===e.error?.code)return void toastMsj(tExp("Ya existe un documento con ese nombre",""),msjModDocumento,1500,5,5);throw console.error("‚ùå Otro error al crear el archivo:",e),new Error(`Error al crear el archivo: ${a.status} ${e.error?.message||a.statusText}`)}const o=await a.json();OneDriveFileId=o.id,OneDriveEditUrl=`https://onedrive.live.com/edit.aspx?resid=${OneDriveFileId}`,docEditado=1,nomDocEditadoCompleto="",openDocEdit.style.display="none";abrirVentanaUnica(`${encodeURIComponent(OneDriveEditUrl)}`)}catch(e){toastMsj(tExp("Error al crear el documento en OneDrive",""),msjModDocumento,1500,5,5)}}async function abrirDocumentoEnOneDrive(e,t){var a=localStorage.getItem("prefijo"),o=localStorage.getItem("idiomaPais").toLowerCase(),n=new FormData;n.append("prefijo",a),n.append("id",e),n.append("idioma",o),n.append("editar",t);const s=await obtenerTokenMicrosoft(3);if(!s)return console.error("No se pudo obtener el token de acceso de Microsoft."),null;try{const e=await fetch("https://"+window.location.host+"/editarDocOffice",{method:"POST",headers:{Authorization:`Bearer ${s}`},body:n}),t=e.headers.get("content-type");if(!e.ok){const t=await e.text();throw new Error(`Error del servidor: ${e.status} - ${t}`)}if(!t||!t.includes("application/json"))throw new Error("El servidor no devolvi√≥ un JSON v√°lido.");const a=await e.json();if(!a.success)throw new Error(a.message||"Error obteniendo enlace de edici√≥n.");if(OneDriveEditUrl=a.editUrl,OneDriveFileId=a.oneDriveFileID,docEditado=1,nomDocEditadoCompleto="",openDocEdit.style.display="none",""==OneDriveEditUrl)throw new Error("No se recibi√≥ una URL de edici√≥n.");abrirVentanaUnica(`${encodeURIComponent(OneDriveEditUrl)}`)}catch(e){toastMsj(tExp(e.message,""),msjModDocumento,1500,4,3)}}window.icons={detailOpen:"bi-caret-down-fill",detailClose:"bi-caret-up-fill"};